var jr=t=>{throw TypeError(t)};var Ut=(t,e,r)=>e.has(t)||jr("Cannot "+r);var T=(t,e,r)=>(Ut(t,e,"read from private field"),r?r.call(t):e.get(t)),z=(t,e,r)=>e.has(t)?jr("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),P=(t,e,r,s)=>(Ut(t,e,"write to private field"),s?s.call(t,r):e.set(t,r),r),Nt=(t,e,r)=>(Ut(t,e,"access private method"),r);import"../chunks/BnI-gD3q.js";import{t as mt,A as Ge,B as Jt,ag as Xt,aZ as En,J as bt,at as Cn,aG as Tn,a_ as An,a$ as $n,D as Rr,a1 as Zt,C as On,K as lt,z as Pn,G as Dt,b0 as Ir,b1 as ct,b2 as Lr,d as Ur,e as jn,I as Nr,ao as Rn,a4 as In,aY as vr,a0 as Ln,b3 as Un,F as Nn,b4 as Dn,b5 as Mn,f as te,a as F,c as I,r as O,p as wr,b as yr,ak as $s,a6 as Ot,H as qn,a7 as U,s as Yt,N as j,u as Bn,b6 as Fn,aq as Me,S as D,w as Dr}from"../chunks/SQ1KIAQH.js";import{e as Hn,b as Kn,r as Wn,M as zn}from"../chunks/DnFfqgl8.js";import{s as Gn}from"../chunks/-Ri42iu2.js";import{s as Vn,r as Jn}from"../chunks/B7icvM9x.js";import{I as Xn,b as Zn}from"../chunks/UUY1sAkl.js";import{i as Mt}from"../chunks/CNPfJViQ.js";import{_ as nt}from"../chunks/Dp1pzeXC.js";function Yn(t,e,r=!1,s=!1,n=!1){var i=t,o="";mt(()=>{var a=Xt;if(o===(o=e()??"")){Ge&&Jt();return}if(a.nodes_start!==null&&(En(a.nodes_start,a.nodes_end),a.nodes_start=a.nodes_end=null),o!==""){if(Ge){bt.data;for(var l=Jt(),c=l;l!==null&&(l.nodeType!==Cn||l.data!=="");)c=l,l=Tn(l);if(l===null)throw An(),$n;Rr(bt,c),i=Zt(l);return}var u=o+"";r?u=`<svg>${u}</svg>`:s&&(u=`<math>${u}</math>`);var h=On(u);if((r||s)&&(h=lt(h)),Rr(lt(h),h.lastChild),r||s)for(;lt(h);)i.before(lt(h));else i.before(h)}})}var Qn=Nn|Dn|Mn;function ei(t,e,r){new ti(t,e,r)}var oe,tt,Ie,rt,ae,le,G,ge,st,Qt;class ti{constructor(e,r,s){z(this,st);z(this,oe);z(this,tt);z(this,Ie);z(this,rt);z(this,ae);z(this,le,null);z(this,G,null);z(this,ge,!1);P(this,oe,e),P(this,Ie,r),P(this,rt,s),P(this,tt,bt),P(this,ae,Pn(()=>{Xt.b=this,Ge&&Jt();try{P(this,le,Dt(()=>s(T(this,oe))))}catch(n){this.error(n)}},Qn)),Ge&&P(this,oe,bt)}error(e){var r=T(this,Ie).onerror;let s=T(this,Ie).failed;const n=()=>{T(this,G)!==null&&In(T(this,G),()=>{P(this,G,null)}),P(this,le,Nt(this,st,Qt).call(this,()=>(P(this,ge,!1),Dt(()=>T(this,rt).call(this,T(this,oe))))))};if(T(this,ge)||!r&&!s)throw e;var i=Ur;try{ct(null),r==null||r(e,n)}finally{ct(i)}T(this,le)&&(Nr(T(this,le)),P(this,le,null)),T(this,G)&&(Nr(T(this,G)),P(this,G,null)),Ge&&(Zt(T(this,tt)),vr(),Zt(Ln())),s&&Rn(()=>{P(this,G,Nt(this,st,Qt).call(this,()=>{P(this,ge,!0);try{return Dt(()=>{s(T(this,oe),()=>e,()=>n)})}catch(o){return Un(o,T(this,ae).parent),null}finally{P(this,ge,!1)}}))})}}oe=new WeakMap,tt=new WeakMap,Ie=new WeakMap,rt=new WeakMap,ae=new WeakMap,le=new WeakMap,G=new WeakMap,ge=new WeakMap,st=new WeakSet,Qt=function(e){var r=Xt,s=Ur,n=jn;Ir(T(this,ae)),ct(T(this,ae)),Lr(T(this,ae).ctx);try{return e()}finally{Ir(r),ct(s),Lr(n)}};const ri=`<svg width="111" height="147" viewBox="0 0 111 147" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M93.4955 101.5C94.9955 89 107.104 92.5174 105.995 100.548C103.495 118.653 103.495 118.653 100.495 142" stroke="black" stroke-width="8" stroke-linecap="round"/>
<path d="M93.4955 101.5C94.9955 89 107.104 92.5174 105.995 100.548C103.495 118.653 103.495 118.653 100.495 142" stroke="#B3774D" stroke-width="4" stroke-linecap="round"/>
<path d="M47.4385 47.2939C51.2935 59.3736 52.1658 67.2028 46.0258 67.9447C36.7817 77.368 36.6603 70.2979 28.7891 56.7132C20.2989 40.0275 23.4288 30.8565 29.4877 28.9229C35.5467 26.9893 43.5836 35.2143 47.4385 47.2939Z" fill="#B3E6DD"/>
<path d="M50.7396 66.5201C49.9572 58.0234 46.1976 39.2432 37.4186 32.0955C26.4448 23.161 22.9231 36.3505 22.9661 38.8501C23.0875 45.9201 25.9488 51.0871 27.5496 54.5422C29.5325 58.8221 35.793 67.8376 38.2716 73.5235" stroke="black" stroke-width="2"/>
<path d="M46.736 66.7989C44.7955 59.5008 39.8606 43.6639 35.6453 38.7009" stroke="black" stroke-linecap="round"/>
<path d="M28.1882 44.6328C37.1299 53.6229 41.4783 60.1917 36.3532 63.6534C32.4269 76.2563 29.093 70.0205 15.8907 61.5235C0.722637 50.5495 -0.676574 40.9607 3.83277 36.4757C8.3421 31.9906 19.2464 35.6427 28.1882 44.6328Z" fill="#B3E6DD"/>
<path d="M39.8978 60.2349C35.3249 53.0312 23.4107 38.035 12.3375 35.6803C-1.50393 32.7368 1.38017 46.0802 2.55885 48.2849C5.89267 54.5207 10.7963 57.8131 13.7972 60.1572C17.5145 63.0609 27.1987 68.2269 31.9985 72.1555" stroke="black" stroke-width="2"/>
<path d="M36.1822 63.1835C31.1256 57.5748 19.5085 45.7339 13.4931 43.241" stroke="black" stroke-linecap="round"/>
<path d="M94.9362 88.187C93.9085 85.1964 91.2111 82.2213 87.8706 77.852L89.7169 72.0347C94.062 76.8948 98.8157 87.96 98.8157 87.96C98.8157 87.96 104.54 88.6428 102.273 92.2397C100.006 95.8366 95.5221 89.8919 94.9362 88.187Z" fill="black" stroke="black" stroke-width="2"/>
<mask id="path-10-outside-1_59_36" maskUnits="userSpaceOnUse" x="14.9955" y="110.5" width="20" height="20" fill="black">
<rect fill="white" x="14.9955" y="110.5" width="20" height="20"/>
<path d="M16.9955 128C21.4955 123 22.4955 121 23.9955 114.5L31.9955 122C31.2915 122.657 25.9955 127.5 16.9955 128Z"/>
</mask>
<path d="M16.9955 128C21.4955 123 22.4955 121 23.9955 114.5L31.9955 122C31.2915 122.657 25.9955 127.5 16.9955 128Z" fill="black"/>
<path d="M23.9955 114.5L25.3634 113.041L22.8282 110.664L22.0467 114.05L23.9955 114.5ZM16.9955 128L15.5089 126.662C14.9671 127.264 14.8419 128.134 15.1918 128.864C15.5417 129.595 16.2977 130.042 17.1065 129.997L16.9955 128ZM31.9955 122L33.3601 123.462L34.9232 122.003L33.3634 120.541L31.9955 122ZM23.9955 114.5L22.0467 114.05C21.3031 117.273 20.7222 119.192 19.8433 120.895C18.9656 122.596 17.7338 124.19 15.5089 126.662L16.9955 128L18.4821 129.338C20.7573 126.81 22.2754 124.904 23.3978 122.73C24.5188 120.558 25.1879 118.227 25.9443 114.95L23.9955 114.5ZM16.9955 128L17.1065 129.997C26.7916 129.459 32.5167 124.249 33.3601 123.462L31.9955 122L30.6309 120.538C30.0663 121.065 25.1995 125.541 16.8846 126.003L16.9955 128ZM31.9955 122L33.3634 120.541L25.3634 113.041L23.9955 114.5L22.6276 115.959L30.6276 123.459L31.9955 122Z" fill="black" mask="url(#path-10-outside-1_59_36)"/>
<path d="M41.0105 142C42.0105 139 46.5109 131 46.5109 125.5L52.0109 125C52.0109 131 49.5105 137.5 49.5105 137.5C49.5105 137.5 58.0109 138.5 57.0105 144C56.3117 147.842 40.4404 143.71 41.0105 142Z" fill="black" stroke="black" stroke-width="2"/>
<path d="M59.2179 134.941C59.8207 131.836 63.2464 123.321 62.5337 117.867L67.9225 116.658C68.7001 122.608 67.063 129.377 67.063 129.377C67.063 129.377 75.6214 129.267 75.3421 134.85C75.1471 138.75 58.8742 136.71 59.2179 134.941Z" fill="black" stroke="black" stroke-width="2"/>
<path d="M80.4713 56.8718C86.9758 62.1833 90.1081 70.4771 89.8197 79.6912C89.5311 88.9068 85.8145 98.985 78.693 107.706C71.5716 116.428 62.44 122.084 53.4682 124.21C44.4978 126.335 35.7452 124.924 29.2405 119.613C22.7357 114.301 19.6028 106.007 19.8913 96.7927C20.1799 87.5771 23.8965 77.4989 31.0179 68.7775C38.1394 60.056 47.271 54.3994 56.2428 52.2741C65.2134 50.1492 73.9665 51.5604 80.4713 56.8718Z" fill="#F5C73D" stroke="black" stroke-width="2"/>
<mask id="mask0_59_36" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="18" y="50" width="73" height="77">
<path d="M80.4713 56.8718C86.9758 62.1833 90.1081 70.4771 89.8197 79.6912C89.5311 88.9068 85.8145 98.985 78.693 107.706C71.5716 116.428 62.44 122.084 53.4682 124.21C44.4978 126.335 35.7452 124.924 29.2405 119.613C22.7357 114.301 19.6028 106.007 19.8913 96.7927C20.1799 87.5771 23.8965 77.4989 31.0179 68.7775C38.1394 60.056 47.271 54.3994 56.2428 52.2741C65.2134 50.1492 73.9665 51.5604 80.4713 56.8718Z" fill="#F5C73D" stroke="black" stroke-width="2"/>
</mask>
<g mask="url(#mask0_59_36)">
<path d="M78.9955 114.787C48.7975 117.49 24.6391 93.839 17.9955 81" stroke="black" stroke-width="9"/>
<path d="M87.9955 92.8119C58.2925 95.1968 34.5302 74.3285 27.9955 63" stroke="black" stroke-width="9"/>
<path d="M90.9955 71.8863C66.1723 73.2282 51.9566 58.3739 46.4955 52" stroke="black" stroke-width="9"/>
</g>
<rect x="54.1974" y="74.5697" width="18.1563" height="23.7027" transform="rotate(25.1377 54.1974 74.5697)" fill="#40BFAA"/>
<path d="M70 81.5L73.9955 81.5L62.9955 103L59.4955 103.5L70 81.5Z" fill="#40BFAA"/>
<path d="M54.3596 74.2242L69.9955 81.5L74.9955 80L55.6892 71.3907L54.3596 74.2242Z" fill="white"/>
<path d="M75.4955 80C75.9955 80 55.4955 70.5 55.4955 70.5L52.9955 73.5C56.4955 75 68.9955 81 69.9955 81.5C70.9955 82 74.9955 80 75.4955 80Z" stroke="black" stroke-width="2"/>
<path d="M75.4955 80L63.9955 103C63.4955 103.5 61.4954 104 59.9955 103.886C59.3294 103.835 48.9955 98.1739 43.9955 95.5584L45.4955 92.5" stroke="black" stroke-width="2" stroke-linecap="round"/>
<path d="M69.4955 82L58.9955 104" stroke="black"/>
<circle cx="75.9955" cy="47" r="23" fill="#F5C73D" stroke="black" stroke-width="2"/>
<ellipse cx="75.4955" cy="45.5" rx="2.5" ry="3.5" fill="black"/>
<ellipse cx="93.4955" cy="44.5" rx="2.5" ry="3.5" fill="black"/>
<path d="M74.9955 36C79.3635 36 82.9955 39.7539 82.9955 44.5C82.9955 49.2461 79.3635 53 74.9955 53C70.6275 53 66.9955 49.2461 66.9955 44.5C66.9955 39.7539 70.6275 36 74.9955 36Z" stroke="black" stroke-width="2"/>
<path d="M95.4955 35C99.536 35 102.996 38.6981 102.996 43.5C102.996 48.3019 99.536 52 95.4955 52C91.4551 52 87.9955 48.3019 87.9955 43.5C87.9955 38.6981 91.4551 35 95.4955 35Z" stroke="black" stroke-width="2"/>
<path d="M83.4955 44C85.1349 43.2375 86.104 43.1334 87.9955 44" stroke="black" stroke-width="2"/>
<line x1="66.8299" y1="43.4908" x2="57.8299" y2="42.4908" stroke="black" stroke-width="3"/>
<path d="M78.9955 56.5C82.4955 60 87.9955 61 91.4955 55.5" stroke="black" stroke-width="2"/>
<path d="M59.4955 1C66.4729 1 71.9955 6.2198 71.9955 12.5C71.9955 18.7802 66.4729 24 59.4955 24C52.5181 24 46.9955 18.7802 46.9955 12.5C46.9955 6.2198 52.5181 1 59.4955 1Z" fill="#F0E9DB" stroke="black" stroke-width="2"/>
<path d="M61.4955 18C61.9955 14.5 61.4955 10 57.4955 8" stroke="black" stroke-linecap="round"/>
<path d="M66.4955 17C67.9955 14 67.9955 9.5 63.9955 7.5M57.4955 19.5C56.1622 18.6667 53.2955 16.2 52.4955 13" stroke="black" stroke-linecap="round"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M62.9955 35.5C61.4955 38 60.707 39 58.6245 41.7551C57.3056 43.5 55.4955 45 52.4955 48C49.9955 48 43.0115 37.5405 52.4955 24.5C56.4955 19 65.4955 16 72.9955 17.5C76.4535 18.1916 77.8059 19.2911 78.9392 20.2126C79.5808 20.7342 80.1521 21.1988 80.9955 21.5C91.9955 19.5 96.9955 22.5 95.9955 34.5C94.4955 34.5 89.4955 33 86.9955 31.5C84.4955 30 80.968 25.8128 80.4955 26.5C74.9955 34.5 63.5955 34.5 62.9955 35.5Z" fill="#F0E9DB" stroke="black" stroke-width="2"/>
<path d="M75.9955 26C74.1622 28 68.7955 31.6 61.9955 30" stroke="black" stroke-linecap="round"/>
<path d="M59.8362 98.5997C57.3837 96.5147 48.8751 93.6018 43.6783 91.8008C40.123 87.4647 45.1612 81.4074 45.8252 77.9343C47.1505 74.8098 51.604 65.5639 54.4955 64.5C57.387 63.4361 59.4133 65.6107 59.8362 67.5C58.0708 69.1182 52.671 77.0136 51.3462 79.3738C50.0213 81.7339 49.4019 85.3752 48.4655 86.972C54.7982 88.5491 63.1225 95.7619 63.1225 95.7619C63.1225 95.7619 68.4992 92.5212 68.3751 97.4006C68.2511 102.28 61.2343 99.7883 59.8362 98.5997Z" fill="black" stroke="black" stroke-width="2"/>
</svg>
`;var si=te('<div class="c svelte-1w8koxw"><div class="logo svelte-1w8koxw"><!></div> <h1 class="svelte-1w8koxw">Opening Line Database</h1> <p class="svelte-1w8koxw">A searchable database of <strong>10,912</strong> opening lines from fiction</p></div>');function ni(t){var e=si(),r=I(e),s=I(r);Yn(s,()=>ri),O(r),vr(4),O(e),F(t,e)}function ii(t,e){wr(e,!0);/**
 * @license @lucide/svelte v0.525.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */let r=Jn(e,["$$slots","$$events","$$legacy"]);const s=[["circle",{cx:"6",cy:"15",r:"4"}],["circle",{cx:"18",cy:"15",r:"4"}],["path",{d:"M14 15a2 2 0 0 0-2-2 2 2 0 0 0-2 2"}],["path",{d:"M2.5 13 5 7c.7-1.3 1.4-2 3-2"}],["path",{d:"M21.5 13 19 7c-.7-1.3-1.5-2-3-2"}]];Xn(t,Vn({name:"glasses"},()=>r,{get iconNode(){return s},children:(n,i)=>{var o=$s(),a=Ot(o);Gn(a,()=>e.children??qn),F(n,o)},$$slots:{default:!0}})),yr()}var oi=te('<div id="lotd" class="c svelte-fd8jiv"><p class="overline svelte-fd8jiv"><span>Line of the Day from <strong>1984 by George Orwell</strong></span> <button><span><!></span></button></p> <blockquote class="svelte-fd8jiv">“It was a bright cold day in April, and the clocks were striking thirteen.”</blockquote> <p><a href="#">see more details</a></p></div>');function ai(t){var e=oi(),r=I(e),s=U(I(r),2),n=I(s),i=I(n);ii(i,{}),O(n),O(s),O(r),vr(4),O(e),F(t,e)}const li=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>nt(async()=>{const{default:s}=await Promise.resolve().then(()=>De);return{default:s}},void 0,import.meta.url).then(({default:s})=>s(...r)):e=fetch,(...r)=>e(...r)};class mr extends Error{constructor(e,r="FunctionsError",s){super(e),this.name=r,this.context=s}}class ci extends mr{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Mr extends mr{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class qr extends mr{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var er;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(er||(er={}));var ui=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};class hi{constructor(e,{headers:r={},customFetch:s,region:n=er.Any}={}){this.url=e,this.headers=r,this.region=n,this.fetch=li(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,r={}){var s;return ui(this,void 0,void 0,function*(){try{const{headers:n,method:i,body:o}=r;let a={},{region:l}=r;l||(l=this.region);const c=new URL(`${this.url}/${e}`);l&&l!=="any"&&(a["x-region"]=l,c.searchParams.set("forceFunctionRegion",l));let u;o&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(a["Content-Type"]="text/plain",u=o):typeof FormData<"u"&&o instanceof FormData?u=o:(a["Content-Type"]="application/json",u=JSON.stringify(o)));const h=yield this.fetch(c.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),n),body:u}).catch(v=>{throw new ci(v)}),d=h.headers.get("x-relay-error");if(d&&d==="true")throw new Mr(h);if(!h.ok)throw new qr(h);let f=((s=h.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),p;return f==="application/json"?p=yield h.json():f==="application/octet-stream"?p=yield h.blob():f==="text/event-stream"?p=h:f==="multipart/form-data"?p=yield h.formData():p=yield h.text(),{data:p,error:null,response:h}}catch(n){return{data:null,error:n,response:n instanceof qr||n instanceof Mr?n.context:void 0}}})}}function di(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function fi(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var r=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var n=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(r,s,n.get?n:{enumerable:!0,get:function(){return t[s]}})}),r}var A={},be={},ke={},xe={},Se={},Ee={},pi=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Le=pi();const gi=Le.fetch,Os=Le.fetch.bind(Le),Ps=Le.Headers,_i=Le.Request,vi=Le.Response,De=Object.freeze(Object.defineProperty({__proto__:null,Headers:Ps,Request:_i,Response:vi,default:Os,fetch:gi},Symbol.toStringTag,{value:"Module"})),wi=fi(De);var ut={},Br;function js(){if(Br)return ut;Br=1,Object.defineProperty(ut,"__esModule",{value:!0});class t extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return ut.default=t,ut}var Fr;function Rs(){if(Fr)return Ee;Fr=1;var t=Ee&&Ee.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ee,"__esModule",{value:!0});const e=t(wi),r=t(js());class s{constructor(i){this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=i.headers,this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=i.shouldThrowOnError,this.signal=i.signal,this.isMaybeSingle=i.isMaybeSingle,i.fetch?this.fetch=i.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,o){return this.headers=Object.assign({},this.headers),this.headers[i]=o,this}then(i,o){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const a=this.fetch;let l=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var u,h,d;let f=null,p=null,v=null,g=c.status,b=c.statusText;if(c.ok){if(this.method!=="HEAD"){const k=await c.text();k===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?p=k:p=JSON.parse(k))}const _=(u=this.headers.Prefer)===null||u===void 0?void 0:u.match(/count=(exact|planned|estimated)/),y=(h=c.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");_&&y&&y.length>1&&(v=parseInt(y[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(p)&&(p.length>1?(f={code:"PGRST116",details:`Results contain ${p.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},p=null,v=null,g=406,b="Not Acceptable"):p.length===1?p=p[0]:p=null)}else{const _=await c.text();try{f=JSON.parse(_),Array.isArray(f)&&c.status===404&&(p=[],f=null,g=200,b="OK")}catch{c.status===404&&_===""?(g=204,b="No Content"):f={message:_}}if(f&&this.isMaybeSingle&&(!((d=f==null?void 0:f.details)===null||d===void 0)&&d.includes("0 rows"))&&(f=null,g=200,b="OK"),f&&this.shouldThrowOnError)throw new r.default(f)}return{error:f,data:p,count:v,status:g,statusText:b}});return this.shouldThrowOnError||(l=l.catch(c=>{var u,h,d;return{error:{message:`${(u=c==null?void 0:c.name)!==null&&u!==void 0?u:"FetchError"}: ${c==null?void 0:c.message}`,details:`${(h=c==null?void 0:c.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(d=c==null?void 0:c.code)!==null&&d!==void 0?d:""}`},data:null,count:null,status:0,statusText:""}})),l.then(i,o)}returns(){return this}overrideTypes(){return this}}return Ee.default=s,Ee}var Hr;function Is(){if(Hr)return Se;Hr=1;var t=Se&&Se.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Se,"__esModule",{value:!0});const e=t(Rs());class r extends e.default{select(n){let i=!1;const o=(n??"*").split("").map(a=>/\s/.test(a)&&!i?"":(a==='"'&&(i=!i),a)).join("");return this.url.searchParams.set("select",o),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(n,{ascending:i=!0,nullsFirst:o,foreignTable:a,referencedTable:l=a}={}){const c=l?`${l}.order`:"order",u=this.url.searchParams.get(c);return this.url.searchParams.set(c,`${u?`${u},`:""}${n}.${i?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:i,referencedTable:o=i}={}){const a=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(a,`${n}`),this}range(n,i,{foreignTable:o,referencedTable:a=o}={}){const l=typeof a>"u"?"offset":`${a}.offset`,c=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(l,`${n}`),this.url.searchParams.set(c,`${i-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:n=!1,verbose:i=!1,settings:o=!1,buffers:a=!1,wal:l=!1,format:c="text"}={}){var u;const h=[n?"analyze":null,i?"verbose":null,o?"settings":null,a?"buffers":null,l?"wal":null].filter(Boolean).join("|"),d=(u=this.headers.Accept)!==null&&u!==void 0?u:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${c}; for="${d}"; options=${h};`,c==="json"?this:this}rollback(){var n;return((n=this.headers.Prefer)!==null&&n!==void 0?n:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return Se.default=r,Se}var Kr;function br(){if(Kr)return xe;Kr=1;var t=xe&&xe.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(xe,"__esModule",{value:!0});const e=t(Is());class r extends e.default{eq(n,i){return this.url.searchParams.append(n,`eq.${i}`),this}neq(n,i){return this.url.searchParams.append(n,`neq.${i}`),this}gt(n,i){return this.url.searchParams.append(n,`gt.${i}`),this}gte(n,i){return this.url.searchParams.append(n,`gte.${i}`),this}lt(n,i){return this.url.searchParams.append(n,`lt.${i}`),this}lte(n,i){return this.url.searchParams.append(n,`lte.${i}`),this}like(n,i){return this.url.searchParams.append(n,`like.${i}`),this}likeAllOf(n,i){return this.url.searchParams.append(n,`like(all).{${i.join(",")}}`),this}likeAnyOf(n,i){return this.url.searchParams.append(n,`like(any).{${i.join(",")}}`),this}ilike(n,i){return this.url.searchParams.append(n,`ilike.${i}`),this}ilikeAllOf(n,i){return this.url.searchParams.append(n,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(n,i){return this.url.searchParams.append(n,`ilike(any).{${i.join(",")}}`),this}is(n,i){return this.url.searchParams.append(n,`is.${i}`),this}in(n,i){const o=Array.from(new Set(i)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(n,`in.(${o})`),this}contains(n,i){return typeof i=="string"?this.url.searchParams.append(n,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(n,`cs.{${i.join(",")}}`):this.url.searchParams.append(n,`cs.${JSON.stringify(i)}`),this}containedBy(n,i){return typeof i=="string"?this.url.searchParams.append(n,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(n,`cd.{${i.join(",")}}`):this.url.searchParams.append(n,`cd.${JSON.stringify(i)}`),this}rangeGt(n,i){return this.url.searchParams.append(n,`sr.${i}`),this}rangeGte(n,i){return this.url.searchParams.append(n,`nxl.${i}`),this}rangeLt(n,i){return this.url.searchParams.append(n,`sl.${i}`),this}rangeLte(n,i){return this.url.searchParams.append(n,`nxr.${i}`),this}rangeAdjacent(n,i){return this.url.searchParams.append(n,`adj.${i}`),this}overlaps(n,i){return typeof i=="string"?this.url.searchParams.append(n,`ov.${i}`):this.url.searchParams.append(n,`ov.{${i.join(",")}}`),this}textSearch(n,i,{config:o,type:a}={}){let l="";a==="plain"?l="pl":a==="phrase"?l="ph":a==="websearch"&&(l="w");const c=o===void 0?"":`(${o})`;return this.url.searchParams.append(n,`${l}fts${c}.${i}`),this}match(n){return Object.entries(n).forEach(([i,o])=>{this.url.searchParams.append(i,`eq.${o}`)}),this}not(n,i,o){return this.url.searchParams.append(n,`not.${i}.${o}`),this}or(n,{foreignTable:i,referencedTable:o=i}={}){const a=o?`${o}.or`:"or";return this.url.searchParams.append(a,`(${n})`),this}filter(n,i,o){return this.url.searchParams.append(n,`${i}.${o}`),this}}return xe.default=r,xe}var Wr;function Ls(){if(Wr)return ke;Wr=1;var t=ke&&ke.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(ke,"__esModule",{value:!0});const e=t(br());class r{constructor(n,{headers:i={},schema:o,fetch:a}){this.url=n,this.headers=i,this.schema=o,this.fetch=a}select(n,{head:i=!1,count:o}={}){const a=i?"HEAD":"GET";let l=!1;const c=(n??"*").split("").map(u=>/\s/.test(u)&&!l?"":(u==='"'&&(l=!l),u)).join("");return this.url.searchParams.set("select",c),o&&(this.headers.Prefer=`count=${o}`),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(n,{count:i,defaultToNull:o=!0}={}){const a="POST",l=[];if(this.headers.Prefer&&l.push(this.headers.Prefer),i&&l.push(`count=${i}`),o||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(n)){const c=n.reduce((u,h)=>u.concat(Object.keys(h)),[]);if(c.length>0){const u=[...new Set(c)].map(h=>`"${h}"`);this.url.searchParams.set("columns",u.join(","))}}return new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}upsert(n,{onConflict:i,ignoreDuplicates:o=!1,count:a,defaultToNull:l=!0}={}){const c="POST",u=[`resolution=${o?"ignore":"merge"}-duplicates`];if(i!==void 0&&this.url.searchParams.set("on_conflict",i),this.headers.Prefer&&u.push(this.headers.Prefer),a&&u.push(`count=${a}`),l||u.push("missing=default"),this.headers.Prefer=u.join(","),Array.isArray(n)){const h=n.reduce((d,f)=>d.concat(Object.keys(f)),[]);if(h.length>0){const d=[...new Set(h)].map(f=>`"${f}"`);this.url.searchParams.set("columns",d.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}update(n,{count:i}={}){const o="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),i&&a.push(`count=${i}`),this.headers.Prefer=a.join(","),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}delete({count:n}={}){const i="DELETE",o=[];return n&&o.push(`count=${n}`),this.headers.Prefer&&o.unshift(this.headers.Prefer),this.headers.Prefer=o.join(","),new e.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return ke.default=r,ke}var qe={},Be={},zr;function yi(){return zr||(zr=1,Object.defineProperty(Be,"__esModule",{value:!0}),Be.version=void 0,Be.version="0.0.0-automated"),Be}var Gr;function mi(){if(Gr)return qe;Gr=1,Object.defineProperty(qe,"__esModule",{value:!0}),qe.DEFAULT_HEADERS=void 0;const t=yi();return qe.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${t.version}`},qe}var Vr;function bi(){if(Vr)return be;Vr=1;var t=be&&be.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(be,"__esModule",{value:!0});const e=t(Ls()),r=t(br()),s=mi();class n{constructor(o,{headers:a={},schema:l,fetch:c}={}){this.url=o,this.headers=Object.assign(Object.assign({},s.DEFAULT_HEADERS),a),this.schemaName=l,this.fetch=c}from(o){const a=new URL(`${this.url}/${o}`);return new e.default(a,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(o){return new n(this.url,{headers:this.headers,schema:o,fetch:this.fetch})}rpc(o,a={},{head:l=!1,get:c=!1,count:u}={}){let h;const d=new URL(`${this.url}/rpc/${o}`);let f;l||c?(h=l?"HEAD":"GET",Object.entries(a).filter(([v,g])=>g!==void 0).map(([v,g])=>[v,Array.isArray(g)?`{${g.join(",")}}`:`${g}`]).forEach(([v,g])=>{d.searchParams.append(v,g)})):(h="POST",f=a);const p=Object.assign({},this.headers);return u&&(p.Prefer=`count=${u}`),new r.default({method:h,url:d,headers:p,schema:this.schemaName,body:f,fetch:this.fetch,allowEmpty:!1})}}return be.default=n,be}var Jr;function ki(){if(Jr)return A;Jr=1;var t=A&&A.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(A,"__esModule",{value:!0}),A.PostgrestError=A.PostgrestBuilder=A.PostgrestTransformBuilder=A.PostgrestFilterBuilder=A.PostgrestQueryBuilder=A.PostgrestClient=void 0;const e=t(bi());A.PostgrestClient=e.default;const r=t(Ls());A.PostgrestQueryBuilder=r.default;const s=t(br());A.PostgrestFilterBuilder=s.default;const n=t(Is());A.PostgrestTransformBuilder=n.default;const i=t(Rs());A.PostgrestBuilder=i.default;const o=t(js());return A.PostgrestError=o.default,A.default={PostgrestClient:e.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:s.default,PostgrestTransformBuilder:n.default,PostgrestBuilder:i.default,PostgrestError:o.default},A}var xi=ki();const Si=di(xi),{PostgrestClient:Ei,PostgrestQueryBuilder:Ju,PostgrestFilterBuilder:Xu,PostgrestTransformBuilder:Zu,PostgrestBuilder:Yu,PostgrestError:Qu}=Si;function Ci(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const Ti=Ci(),Ai="2.11.15",$i=`realtime-js/${Ai}`,Oi="1.0.0",Us=1e4,Pi=1e3;var Ve;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Ve||(Ve={}));var R;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(R||(R={}));var q;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(q||(q={}));var tr;(function(t){t.websocket="websocket"})(tr||(tr={}));var fe;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(fe||(fe={}));class ji{constructor(){this.HEADER_LENGTH=1}decode(e,r){return e.constructor===ArrayBuffer?r(this._binaryDecode(e)):r(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const r=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,r,s)}_decodeBroadcast(e,r,s){const n=r.getUint8(1),i=r.getUint8(2);let o=this.HEADER_LENGTH+2;const a=s.decode(e.slice(o,o+n));o=o+n;const l=s.decode(e.slice(o,o+i));o=o+i;const c=JSON.parse(s.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:l,payload:c}}}let Ns=class{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}};var S;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(S||(S={}));const Xr=(t,e,r={})=>{var s;const n=(s=r.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(e).reduce((i,o)=>(i[o]=Ri(o,t,e,n),i),{})},Ri=(t,e,r,s)=>{const n=e.find(a=>a.name===t),i=n==null?void 0:n.type,o=r[t];return i&&!s.includes(i)?Ds(i,o):rr(o)},Ds=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return Ni(e,r)}switch(t){case S.bool:return Ii(e);case S.float4:case S.float8:case S.int2:case S.int4:case S.int8:case S.numeric:case S.oid:return Li(e);case S.json:case S.jsonb:return Ui(e);case S.timestamp:return Di(e);case S.abstime:case S.date:case S.daterange:case S.int4range:case S.int8range:case S.money:case S.reltime:case S.text:case S.time:case S.timestamptz:case S.timetz:case S.tsrange:case S.tstzrange:return rr(e);default:return rr(e)}},rr=t=>t,Ii=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},Li=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},Ui=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},Ni=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,s=t[r];if(t[0]==="{"&&s==="}"){let i;const o=t.slice(1,r);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(a=>Ds(e,a))}return t},Di=t=>typeof t=="string"?t.replace(" ","T"):t,Ms=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class qt{constructor(e,r,s={},n=Us){this.channel=e,this.event=r,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var s;return this._hasReceived(e)&&r((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Zr;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Zr||(Zr={}));class Je{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},n=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Je.syncState(this.state,n,i,o),this.pendingDiffs.forEach(l=>{this.state=Je.syncDiff(this.state,l,i,o)}),this.pendingDiffs=[],a()}),this.channel._on(s.diff,{},n=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=Je.syncDiff(this.state,n,i,o),a())}),this.onJoin((n,i,o)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:i,newPresences:o})}),this.onLeave((n,i,o)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,s,n){const i=this.cloneDeep(e),o=this.transformState(r),a={},l={};return this.map(i,(c,u)=>{o[c]||(l[c]=u)}),this.map(o,(c,u)=>{const h=i[c];if(h){const d=u.map(g=>g.presence_ref),f=h.map(g=>g.presence_ref),p=u.filter(g=>f.indexOf(g.presence_ref)<0),v=h.filter(g=>d.indexOf(g.presence_ref)<0);p.length>0&&(a[c]=p),v.length>0&&(l[c]=v)}else a[c]=u}),this.syncDiff(i,{joins:a,leaves:l},s,n)}static syncDiff(e,r,s,n){const{joins:i,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(i,(a,l)=>{var c;const u=(c=e[a])!==null&&c!==void 0?c:[];if(e[a]=this.cloneDeep(l),u.length>0){const h=e[a].map(f=>f.presence_ref),d=u.filter(f=>h.indexOf(f.presence_ref)<0);e[a].unshift(...d)}s(a,u,l)}),this.map(o,(a,l)=>{let c=e[a];if(!c)return;const u=l.map(h=>h.presence_ref);c=c.filter(h=>u.indexOf(h.presence_ref)<0),e[a]=c,n(a,c,l),c.length===0&&delete e[a]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(s=>r(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,s)=>{const n=e[s];return"metas"in n?r[s]=n.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[s]=n,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Yr;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Yr||(Yr={}));var Qr;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Qr||(Qr={}));var Y;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Y||(Y={}));class kr{constructor(e,r={config:{}},s){this.topic=e,this.params=r,this.socket=s,this.bindings={},this.state=R.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new qt(this,q.join,this.params,this.timeout),this.rejoinTimer=new Ns(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=R.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=R.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=R.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=R.errored,this.rejoinTimer.scheduleTimeout())}),this._on(q.reply,{},(n,i)=>{this._trigger(this._replyEventName(i),n)}),this.presence=new Je(this),this.broadcastEndpointURL=Ms(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,r=this.timeout){var s,n;if(this.socket.isConnected()||this.socket.connect(),this.state==R.closed){const{config:{broadcast:i,presence:o,private:a}}=this.params;this._onError(u=>e==null?void 0:e(Y.CHANNEL_ERROR,u)),this._onClose(()=>e==null?void 0:e(Y.CLOSED));const l={},c={broadcast:i,presence:o,postgres_changes:(n=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(u=>u.filter))!==null&&n!==void 0?n:[],private:a};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:u})=>{var h;if(this.socket.setAuth(),u===void 0){e==null||e(Y.SUBSCRIBED);return}else{const d=this.bindings.postgres_changes,f=(h=d==null?void 0:d.length)!==null&&h!==void 0?h:0,p=[];for(let v=0;v<f;v++){const g=d[v],{filter:{event:b,schema:E,table:_,filter:y}}=g,k=u&&u[v];if(k&&k.event===b&&k.schema===E&&k.table===_&&k.filter===y)p.push(Object.assign(Object.assign({},g),{id:k.id}));else{this.unsubscribe(),this.state=R.errored,e==null||e(Y.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=p,e&&e(Y.SUBSCRIBED);return}}).receive("error",u=>{this.state=R.errored,e==null||e(Y.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Y.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,s){return this._on(e,r,s)}async send(e,r={}){var s,n;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);return await((n=c.body)===null||n===void 0?void 0:n.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,a,l;const c=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=R.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(q.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(n=>{s=new qt(this,q.leave,{},e),s.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,r,s){const n=new AbortController,i=setTimeout(()=>n.abort(),s),o=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:n.signal}));return clearTimeout(i),o}_push(e,r,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new qt(this,e,r,s);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(e,r,s){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,s){var n,i;const o=e.toLocaleLowerCase(),{close:a,error:l,leave:c,join:u}=q;if(s&&[a,l,c,u].indexOf(o)>=0&&s!==this._joinRef())return;let d=this._onMessage(o,r,s);if(r&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(f=>{var p,v,g;return((p=f.filter)===null||p===void 0?void 0:p.event)==="*"||((g=(v=f.filter)===null||v===void 0?void 0:v.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===o}).map(f=>f.callback(d,s)):(i=this.bindings[o])===null||i===void 0||i.filter(f=>{var p,v,g,b,E,_;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){const y=f.id,k=(p=f.filter)===null||p===void 0?void 0:p.event;return y&&((v=r.ids)===null||v===void 0?void 0:v.includes(y))&&(k==="*"||(k==null?void 0:k.toLocaleLowerCase())===((g=r.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const y=(E=(b=f==null?void 0:f.filter)===null||b===void 0?void 0:b.event)===null||E===void 0?void 0:E.toLocaleLowerCase();return y==="*"||y===((_=r==null?void 0:r.event)===null||_===void 0?void 0:_.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof d=="object"&&"ids"in d){const p=d.data,{schema:v,table:g,commit_timestamp:b,type:E,errors:_}=p;d=Object.assign(Object.assign({},{schema:v,table:g,commit_timestamp:b,eventType:E,new:{},old:{},errors:_}),this._getPayloadRecords(p))}f.callback(d,s)})}_isClosed(){return this.state===R.closed}_isJoined(){return this.state===R.joined}_isJoining(){return this.state===R.joining}_isLeaving(){return this.state===R.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,s){const n=e.toLocaleLowerCase(),i={type:n,filter:r,callback:s};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(e,r){const s=e.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter(n=>{var i;return!(((i=n.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&kr.isEqual(n.filter,r))}),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const s in e)if(e[s]!==r[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(q.close,{},e)}_onError(e){this._on(q.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=R.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=Xr(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=Xr(e.columns,e.old_record)),r}}const es=()=>{},Mi=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class qi{constructor(e,r){var s;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Us,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=es,this.ref=0,this.logger=es,this.conn=null,this.sendBuffer=[],this.serializer=new ji,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...a)=>nt(async()=>{const{default:l}=await Promise.resolve().then(()=>De);return{default:l}},void 0,import.meta.url).then(({default:l})=>l(...a)):o=fetch,(...a)=>o(...a)},this.endPoint=`${e}/${tr.websocket}`,this.httpEndpoint=Ms(e),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),(r!=null&&r.logLevel||r!=null&&r.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const n=(s=r==null?void 0:r.params)===null||s===void 0?void 0:s.apikey;if(n&&(this.accessTokenValue=n,this.apiKey=n),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(i,o)=>o(JSON.stringify(i)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Ns(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=Ti),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Oi}))}disconnect(e,r){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(s=>s.teardown()))}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,s){this.logger(e,r,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Ve.connecting:return fe.Connecting;case Ve.open:return fe.Open;case Ve.closing:return fe.Closing;default:return fe.Closed}}isConnected(){return this.connectionState()===fe.Open}channel(e,r={config:{}}){const s=`realtime:${e}`,n=this.getChannels().find(i=>i.topic===s);if(n)return n;{const i=new kr(`realtime:${e}`,r,this);return this.channels.push(i),i}}push(e){const{topic:r,event:s,payload:n,ref:i}=e,o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${r} ${s} (${i})`,n),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){let r=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(s=>{const n={access_token:r,version:$i};r&&s.updateJoinPayload(n),s.joinedOnce&&s._isJoined()&&s._push(q.access_token,{access_token:r})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(Pi,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,r=>{let{topic:s,event:n,payload:i,ref:o}=r;s==="phoenix"&&n==="phx_reply"&&this.heartbeatCallback(r.payload.status=="ok"?"ok":"error"),o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${s} ${n} ${o&&"("+o+")"||""}`,i),Array.from(this.channels).filter(a=>a._isMember(s)).forEach(a=>a._trigger(n,i,o)),this.stateChangeCallbacks.message.forEach(a=>a(r))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(q.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const s=e.match(/\?/)?"&":"?",n=new URLSearchParams(r);return`${e}${s}${n}`}_workerObjectUrl(e){let r;if(e)r=e;else{const s=new Blob([Mi],{type:"application/javascript"});r=URL.createObjectURL(s)}return r}}class xr extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function $(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class Bi extends xr{constructor(e,r,s){super(e),this.name="StorageApiError",this.status=r,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class sr extends xr{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}var Fi=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};const qs=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>nt(async()=>{const{default:s}=await Promise.resolve().then(()=>De);return{default:s}},void 0,import.meta.url).then(({default:s})=>s(...r)):e=fetch,(...r)=>e(...r)},Hi=()=>Fi(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield nt(()=>Promise.resolve().then(()=>De),void 0,import.meta.url)).Response:Response}),nr=t=>{if(Array.isArray(t))return t.map(r=>nr(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,s])=>{const n=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[n]=nr(s)}),e},Ki=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var we=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};const Bt=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Wi=(t,e,r)=>we(void 0,void 0,void 0,function*(){const s=yield Hi();t instanceof s&&!(r!=null&&r.noResolveJson)?t.json().then(n=>{const i=t.status||500,o=(n==null?void 0:n.statusCode)||i+"";e(new Bi(Bt(n),i,o))}).catch(n=>{e(new sr(Bt(n),n))}):e(new sr(Bt(t),t))}),zi=(t,e,r,s)=>{const n={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!s?n:(Ki(s)?(n.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),n.body=JSON.stringify(s)):n.body=s,Object.assign(Object.assign({},n),r))};function it(t,e,r,s,n,i){return we(this,void 0,void 0,function*(){return new Promise((o,a)=>{t(r,zi(e,s,n,i)).then(l=>{if(!l.ok)throw l;return s!=null&&s.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>Wi(l,a,s))})})}function kt(t,e,r,s){return we(this,void 0,void 0,function*(){return it(t,"GET",e,r,s)})}function Q(t,e,r,s,n){return we(this,void 0,void 0,function*(){return it(t,"POST",e,s,n,r)})}function ir(t,e,r,s,n){return we(this,void 0,void 0,function*(){return it(t,"PUT",e,s,n,r)})}function Gi(t,e,r,s){return we(this,void 0,void 0,function*(){return it(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),s)})}function Bs(t,e,r,s,n){return we(this,void 0,void 0,function*(){return it(t,"DELETE",e,s,n,r)})}var L=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};const Vi={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ts={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Ji{constructor(e,r={},s,n){this.url=e,this.headers=r,this.bucketId=s,this.fetch=qs(n)}uploadOrUpdate(e,r,s,n){return L(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},ts),n);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&s instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",s)):typeof FormData<"u"&&s instanceof FormData?(i=s,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=s,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),n!=null&&n.headers&&(a=Object.assign(Object.assign({},a),n.headers));const c=this._removeEmptyFolders(r),u=this._getFinalPath(c),h=yield(e=="PUT"?ir:Q)(this.fetch,`${this.url}/object/${u}`,i,Object.assign({headers:a},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:c,id:h.Id,fullPath:h.Key},error:null}}catch(i){if($(i))return{data:null,error:i};throw i}})}upload(e,r,s){return L(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,s)})}uploadToSignedUrl(e,r,s,n){return L(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",r);try{let l;const c=Object.assign({upsert:ts.upsert},n),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&s instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",s)):typeof FormData<"u"&&s instanceof FormData?(l=s,l.append("cacheControl",c.cacheControl)):(l=s,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const h=yield ir(this.fetch,a.toString(),l,{headers:u});return{data:{path:i,fullPath:h.Key},error:null}}catch(l){if($(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,r){return L(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const n=Object.assign({},this.headers);r!=null&&r.upsert&&(n["x-upsert"]="true");const i=yield Q(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:n}),o=new URL(this.url+i.url),a=o.searchParams.get("token");if(!a)throw new xr("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:a},error:null}}catch(s){if($(s))return{data:null,error:s};throw s}})}update(e,r,s){return L(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,s)})}move(e,r,s){return L(this,void 0,void 0,function*(){try{return{data:yield Q(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(n){if($(n))return{data:null,error:n};throw n}})}copy(e,r,s){return L(this,void 0,void 0,function*(){try{return{data:{path:(yield Q(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if($(n))return{data:null,error:n};throw n}})}createSignedUrl(e,r,s){return L(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),i=yield Q(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:r},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const o=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(n){if($(n))return{data:null,error:n};throw n}})}createSignedUrls(e,r,s){return L(this,void 0,void 0,function*(){try{const n=yield Q(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),i=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:n.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(n){if($(n))return{data:null,error:n};throw n}})}download(e,r){return L(this,void 0,void 0,function*(){const n=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),o=i?`?${i}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield kt(this.fetch,`${this.url}/${n}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if($(a))return{data:null,error:a};throw a}})}info(e){return L(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const s=yield kt(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:nr(s),error:null}}catch(s){if($(s))return{data:null,error:s};throw s}})}exists(e){return L(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield Gi(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if($(s)&&s instanceof sr){const n=s.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,r){const s=this._getFinalPath(e),n=[],i=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&n.push(i);const a=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});l!==""&&n.push(l);let c=n.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${s}${c}`)}}}remove(e){return L(this,void 0,void 0,function*(){try{return{data:yield Bs(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if($(r))return{data:null,error:r};throw r}})}list(e,r,s){return L(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},Vi),r),{prefix:e||""});return{data:yield Q(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},s),error:null}}catch(n){if($(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const Xi="2.10.4",Zi={"X-Client-Info":`storage-js/${Xi}`};var Ce=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};class Yi{constructor(e,r={},s,n){const i=new URL(e);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href,this.headers=Object.assign(Object.assign({},Zi),r),this.fetch=qs(s)}listBuckets(){return Ce(this,void 0,void 0,function*(){try{return{data:yield kt(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if($(e))return{data:null,error:e};throw e}})}getBucket(e){return Ce(this,void 0,void 0,function*(){try{return{data:yield kt(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if($(r))return{data:null,error:r};throw r}})}createBucket(e,r={public:!1}){return Ce(this,void 0,void 0,function*(){try{return{data:yield Q(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if($(s))return{data:null,error:s};throw s}})}updateBucket(e,r){return Ce(this,void 0,void 0,function*(){try{return{data:yield ir(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if($(s))return{data:null,error:s};throw s}})}emptyBucket(e){return Ce(this,void 0,void 0,function*(){try{return{data:yield Q(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if($(r))return{data:null,error:r};throw r}})}deleteBucket(e){return Ce(this,void 0,void 0,function*(){try{return{data:yield Bs(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if($(r))return{data:null,error:r};throw r}})}}class Qi extends Yi{constructor(e,r={},s,n){super(e,r,s,n)}from(e){return new Ji(this.url,this.headers,e,this.fetch)}}const eo="2.53.0";let He="";typeof Deno<"u"?He="deno":typeof document<"u"?He="web":typeof navigator<"u"&&navigator.product==="ReactNative"?He="react-native":He="node";const to={"X-Client-Info":`supabase-js-${He}/${eo}`},ro={headers:to},so={schema:"public"},no={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},io={};var oo=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};const ao=t=>{let e;return t?e=t:typeof fetch>"u"?e=Os:e=fetch,(...r)=>e(...r)},lo=()=>typeof Headers>"u"?Ps:Headers,co=(t,e,r)=>{const s=ao(r),n=lo();return(i,o)=>oo(void 0,void 0,void 0,function*(){var a;const l=(a=yield e())!==null&&a!==void 0?a:t;let c=new n(o==null?void 0:o.headers);return c.has("apikey")||c.set("apikey",t),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),s(i,Object.assign(Object.assign({},o),{headers:c}))})};var uo=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};function ho(t){return t.endsWith("/")?t:t+"/"}function fo(t,e){var r,s;const{db:n,auth:i,realtime:o,global:a}=t,{db:l,auth:c,realtime:u,global:h}=e,d={db:Object.assign(Object.assign({},l),n),auth:Object.assign(Object.assign({},c),i),realtime:Object.assign(Object.assign({},u),o),storage:{},global:Object.assign(Object.assign(Object.assign({},h),a),{headers:Object.assign(Object.assign({},(r=h==null?void 0:h.headers)!==null&&r!==void 0?r:{}),(s=a==null?void 0:a.headers)!==null&&s!==void 0?s:{})}),accessToken:()=>uo(this,void 0,void 0,function*(){return""})};return t.accessToken?d.accessToken=t.accessToken:delete d.accessToken,d}const Fs="2.71.1",Pe=30*1e3,or=3,Ft=or*Pe,po="http://localhost:9999",go="supabase.auth.token",_o={"X-Client-Info":`gotrue-js/${Fs}`},ar="X-Supabase-Api-Version",Hs={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},vo=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,wo=600*1e3;class Sr extends Error{constructor(e,r,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=s}}function w(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class yo extends Sr{constructor(e,r,s){super(e,r,s),this.name="AuthApiError",this.status=r,this.code=s}}function mo(t){return w(t)&&t.name==="AuthApiError"}class Ks extends Sr{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class ce extends Sr{constructor(e,r,s,n){super(e,s,n),this.name=r,this.status=s}}class se extends ce{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function bo(t){return w(t)&&t.name==="AuthSessionMissingError"}class ht extends ce{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class dt extends ce{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class ft extends ce{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function ko(t){return w(t)&&t.name==="AuthImplicitGrantRedirectError"}class rs extends ce{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class lr extends ce{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function Ht(t){return w(t)&&t.name==="AuthRetryableFetchError"}class ss extends ce{constructor(e,r,s){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=s}}class cr extends ce{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const xt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),ns=` 	
\r=`.split(""),xo=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<ns.length;e+=1)t[ns[e].charCodeAt(0)]=-2;for(let e=0;e<xt.length;e+=1)t[xt[e].charCodeAt(0)]=e;return t})();function is(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;r(xt[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;r(xt[s]),e.queuedBits-=6}}function Ws(t,e,r){const s=xo[t];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function os(t){const e=[],r=o=>{e.push(String.fromCodePoint(o))},s={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},i=o=>{Co(o,s,r)};for(let o=0;o<t.length;o+=1)Ws(t.charCodeAt(o),n,i);return e.join("")}function So(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function Eo(t,e){for(let r=0;r<t.length;r+=1){let s=t.charCodeAt(r);if(s>55295&&s<=56319){const n=(s-55296)*1024&65535;s=(t.charCodeAt(r+1)-56320&65535|n)+65536,r+=1}So(s,e)}}function Co(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let s=1;s<6;s+=1)if((t>>7-s&1)===0){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function To(t){const e=[],r={queue:0,queuedBits:0},s=n=>{e.push(n)};for(let n=0;n<t.length;n+=1)Ws(t.charCodeAt(n),r,s);return new Uint8Array(e)}function Ao(t){const e=[];return Eo(t,r=>e.push(r)),new Uint8Array(e)}function $o(t){const e=[],r={queue:0,queuedBits:0},s=n=>{e.push(n)};return t.forEach(n=>is(n,r,s)),is(null,r,s),e.join("")}function Oo(t){return Math.round(Date.now()/1e3)+t}function Po(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const M=()=>typeof window<"u"&&typeof document<"u",ue={tested:!1,writable:!1},zs=()=>{if(!M())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ue.tested)return ue.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),ue.tested=!0,ue.writable=!0}catch{ue.tested=!0,ue.writable=!1}return ue.writable};function jo(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((n,i)=>{e[i]=n})}catch{}return r.searchParams.forEach((s,n)=>{e[n]=s}),e}const Gs=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>nt(async()=>{const{default:s}=await Promise.resolve().then(()=>De);return{default:s}},void 0,import.meta.url).then(({default:s})=>s(...r)):e=fetch,(...r)=>e(...r)},Ro=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",je=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},he=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},re=async(t,e)=>{await t.removeItem(e)};class Pt{constructor(){this.promise=new Pt.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}Pt.promiseConstructor=Promise;function Kt(t){const e=t.split(".");if(e.length!==3)throw new cr("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!vo.test(e[s]))throw new cr("JWT not in base64url format");return{header:JSON.parse(os(e[0])),payload:JSON.parse(os(e[1])),signature:To(e[2]),raw:{header:e[0],payload:e[1]}}}async function Io(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function Lo(t,e){return new Promise((s,n)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await t(i);if(!e(i,null,o)){s(o);return}}catch(o){if(!e(i,o)){n(o);return}}})()})}function Uo(t){return("0"+t.toString(16)).substr(-2)}function No(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=r.length;let n="";for(let i=0;i<56;i++)n+=r.charAt(Math.floor(Math.random()*s));return n}return crypto.getRandomValues(e),Array.from(e,Uo).join("")}async function Do(t){const r=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",r),n=new Uint8Array(s);return Array.from(n).map(i=>String.fromCharCode(i)).join("")}async function Mo(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await Do(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Te(t,e,r=!1){const s=No();let n=s;r&&(n+="/PASSWORD_RECOVERY"),await je(t,`${e}-code-verifier`,n);const i=await Mo(s);return[i,s===i?"plain":"s256"]}const qo=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Bo(t){const e=t.headers.get(ar);if(!e||!e.match(qo))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Fo(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function Ho(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Ko=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ae(t){if(!Ko.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Wt(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const s=r.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function as(t){return JSON.parse(JSON.stringify(t))}var Wo=function(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(r[s[n]]=t[s[n]]);return r};const de=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),zo=[502,503,504];async function ls(t){var e;if(!Ro(t))throw new lr(de(t),0);if(zo.includes(t.status))throw new lr(de(t),t.status);let r;try{r=await t.json()}catch(i){throw new Ks(de(i),i)}let s;const n=Bo(t);if(n&&n.getTime()>=Hs["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?s=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(s=r.error_code),s){if(s==="weak_password")throw new ss(de(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new se}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new ss(de(r),t.status,r.weak_password.reasons);throw new yo(de(r),t.status||500,s)}const Go=(t,e,r,s)=>{const n={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),r))};async function m(t,e,r,s){var n;const i=Object.assign({},s==null?void 0:s.headers);i[ar]||(i[ar]=Hs["2024-01-01"].name),s!=null&&s.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const o=(n=s==null?void 0:s.query)!==null&&n!==void 0?n:{};s!=null&&s.redirectTo&&(o.redirect_to=s.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await Vo(t,e,r+a,{headers:i,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(l):{data:Object.assign({},l),error:null}}async function Vo(t,e,r,s,n,i){const o=Go(e,s,n,i);let a;try{a=await t(r,Object.assign({},o))}catch(l){throw console.error(l),new lr(de(l),0)}if(a.ok||await ls(a),s!=null&&s.noResolveJson)return a;try{return await a.json()}catch(l){await ls(l)}}function Z(t){var e;let r=null;Yo(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=Oo(t.expires_in)));const s=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:s},error:null}}function cs(t){const e=Z(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,s)=>r&&typeof s=="string",!0)&&(e.data.weak_password=t.weak_password),e}function ie(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function Jo(t){return{data:t,error:null}}function Xo(t){const{action_link:e,email_otp:r,hashed_token:s,redirect_to:n,verification_type:i}=t,o=Wo(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:r,hashed_token:s,redirect_to:n,verification_type:i},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function Zo(t){return t}function Yo(t){return t.access_token&&t.refresh_token&&t.expires_in}const zt=["global","local","others"];var Qo=function(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(r[s[n]]=t[s[n]]);return r};class ea{constructor({url:e="",headers:r={},fetch:s}){this.url=e,this.headers=r,this.fetch=Gs(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,r=zt[0]){if(zt.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${zt.join(", ")}`);try{return await m(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(w(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,r={}){try{return await m(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:ie})}catch(s){if(w(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:r}=e,s=Qo(e,["options"]),n=Object.assign(Object.assign({},s),r);return"newEmail"in s&&(n.new_email=s==null?void 0:s.newEmail,delete n.newEmail),await m(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:Xo,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(w(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await m(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:ie})}catch(r){if(w(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,s,n,i,o,a,l;try{const c={nextPage:null,lastPage:0,total:0},u=await m(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(i=(n=e==null?void 0:e.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:Zo});if(u.error)throw u.error;const h=await u.json(),d=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(p=>{const v=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(p.split(";")[1].split("=")[1]);c[`${g}Page`]=v}),c.total=parseInt(d)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(w(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){Ae(e);try{return await m(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:ie})}catch(r){if(w(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){Ae(e);try{return await m(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:ie})}catch(s){if(w(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,r=!1){Ae(e);try{return await m(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:ie})}catch(s){if(w(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){Ae(e.userId);try{const{data:r,error:s}=await m(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:r,error:s}}catch(r){if(w(r))return{data:null,error:r};throw r}}async _deleteFactor(e){Ae(e.userId),Ae(e.id);try{return{data:await m(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(w(r))return{data:null,error:r};throw r}}}function us(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}function ta(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const $e={debug:!!(globalThis&&zs()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Vs extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class ra extends Vs{}async function sa(t,e,r){$e.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),$e.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async n=>{if(n){$e.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,n.name);try{return await r()}finally{$e.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,n.name)}}else{if(e===0)throw $e.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new ra(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if($e.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}ta();const na={url:po,storageKey:go,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:_o,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function hs(t,e,r){return await r()}const Oe={};class Xe{constructor(e){var r,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Xe.nextInstanceID,Xe.nextInstanceID+=1,this.instanceID>0&&M()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},na),e);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new ea({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=Gs(n.fetch),this.lock=n.lock||hs,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:M()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=sa:this.lock=hs,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(n.storage?this.storage=n.storage:zs()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=us(this.memoryStorage)),n.userStorage&&(this.userStorage=n.userStorage)):(this.memoryStorage={},this.storage=us(this.memoryStorage)),M()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var e,r;return(r=(e=Oe[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){Oe[this.storageKey]=Object.assign(Object.assign({},Oe[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=Oe[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Oe[this.storageKey]=Object.assign(Object.assign({},Oe[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Fs}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const r=jo(window.location.href);let s="none";if(this._isImplicitGrantCallback(r)?s="implicit":await this._isPKCECallback(r)&&(s="pkce"),M()&&this.detectSessionInUrl&&s!=="none"){const{data:n,error:i}=await this._getSessionFromURL(r,s);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),ko(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:a}=n;return this._debug("#_initialize()","detected session in URL",o,"redirect type",a),await this._saveSession(o),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return w(r)?{error:r}:{error:new Ks("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,s,n;try{const i=await m(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.captchaToken}},xform:Z}),{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(w(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var r,s,n;try{let i;if("email"in e){const{email:u,password:h,options:d}=e;let f=null,p=null;this.flowType==="pkce"&&([f,p]=await Te(this.storage,this.storageKey)),i=await m(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d==null?void 0:d.emailRedirectTo,body:{email:u,password:h,data:(r=d==null?void 0:d.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:f,code_challenge_method:p},xform:Z})}else if("phone"in e){const{phone:u,password:h,options:d}=e;i=await m(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(s=d==null?void 0:d.data)!==null&&s!==void 0?s:{},channel:(n=d==null?void 0:d.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:Z})}else throw new dt("You must provide either an email or phone number and a password");const{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(w(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let r;if("email"in e){const{email:i,password:o,options:a}=e;r=await m(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:cs})}else if("phone"in e){const{phone:i,password:o,options:a}=e;r=await m(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:cs})}else throw new dt("You must provide either an email or phone number and a password");const{data:s,error:n}=r;return n?{data:{user:null,session:null},error:n}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new ht}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(r){if(w(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(e){var r,s,n,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;if(r==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(e){var r,s,n,i,o,a,l,c,u,h,d,f;let p,v;if("message"in e)p=e.message,v=e.signature;else{const{chain:g,wallet:b,statement:E,options:_}=e;let y;if(M())if(typeof b=="object")y=b;else{const C=window;if("solana"in C&&typeof C.solana=="object"&&("signIn"in C.solana&&typeof C.solana.signIn=="function"||"signMessage"in C.solana&&typeof C.solana.signMessage=="function"))y=C.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof b!="object"||!(_!=null&&_.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");y=b}const k=new URL((r=_==null?void 0:_.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in y&&y.signIn){const C=await y.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},_==null?void 0:_.signInWithSolana),{version:"1",domain:k.host,uri:k.href}),E?{statement:E}:null));let x;if(Array.isArray(C)&&C[0]&&typeof C[0]=="object")x=C[0];else if(C&&typeof C=="object"&&"signedMessage"in C&&"signature"in C)x=C;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in x&&"signature"in x&&(typeof x.signedMessage=="string"||x.signedMessage instanceof Uint8Array)&&x.signature instanceof Uint8Array)p=typeof x.signedMessage=="string"?x.signedMessage:new TextDecoder().decode(x.signedMessage),v=x.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in y)||typeof y.signMessage!="function"||!("publicKey"in y)||typeof y!="object"||!y.publicKey||!("toBase58"in y.publicKey)||typeof y.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${k.host} wants you to sign in with your Solana account:`,y.publicKey.toBase58(),...E?["",E,""]:[""],"Version: 1",`URI: ${k.href}`,`Issued At: ${(n=(s=_==null?void 0:_.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((i=_==null?void 0:_.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${_.signInWithSolana.notBefore}`]:[],...!((o=_==null?void 0:_.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${_.signInWithSolana.expirationTime}`]:[],...!((a=_==null?void 0:_.signInWithSolana)===null||a===void 0)&&a.chainId?[`Chain ID: ${_.signInWithSolana.chainId}`]:[],...!((l=_==null?void 0:_.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${_.signInWithSolana.nonce}`]:[],...!((c=_==null?void 0:_.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${_.signInWithSolana.requestId}`]:[],...!((h=(u=_==null?void 0:_.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",..._.signInWithSolana.resources.map(x=>`- ${x}`)]:[]].join(`
`);const C=await y.signMessage(new TextEncoder().encode(p),"utf8");if(!C||!(C instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");v=C}}try{const{data:g,error:b}=await m(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:$o(v)},!((d=e.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:Z});if(b)throw b;return!g||!g.session||!g.user?{data:{user:null,session:null},error:new ht}:(g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),{data:Object.assign({},g),error:b})}catch(g){if(w(g))return{data:{user:null,session:null},error:g};throw g}}async _exchangeCodeForSession(e){const r=await he(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(r??"").split("/");try{const{data:i,error:o}=await m(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:Z});if(await re(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new ht}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:n??null}),error:o})}catch(i){if(w(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:r,provider:s,token:n,access_token:i,nonce:o}=e,a=await m(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Z}),{data:l,error:c}=a;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new ht}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(r){if(w(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(e){var r,s,n,i,o;try{if("email"in e){const{email:a,options:l}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await Te(this.storage,this.storageKey));const{error:h}=await m(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:a,options:l}=e,{data:c,error:u}=await m(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(n=l==null?void 0:l.data)!==null&&n!==void 0?n:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(o=l==null?void 0:l.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new dt("You must provide either an email or phone number.")}catch(a){if(w(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var r,s;try{let n,i;"options"in e&&(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo,i=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:o,error:a}=await m(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:Z});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,c=o.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(n){if(w(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var r,s,n;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await Te(this.storage,this.storageKey)),await m(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=e==null?void 0:e.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:Jo})}catch(i){if(w(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:s}=e;if(s)throw s;if(!r)throw new se;const{error:n}=await m(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(w(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:s,type:n,options:i}=e,{error:o}=await m(this.fetch,"POST",r,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:s,type:n,options:i}=e,{data:o,error:a}=await m(this.fetch,"POST",r,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:a}}throw new dt("You must provide either an email or phone number and a type")}catch(r){if(w(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await s,await r()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=r();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await he(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<Ft:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const o=await he(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=Wt()}if(this.storage.isServer&&e.user){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,c,u)=>(!o&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:e},error:null}}const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await m(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:ie}):await this._useSession(async r=>{var s,n,i;const{data:o,error:a}=r;if(a)throw a;return!(!((s=o.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new se}:await m(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0,xform:ie})})}catch(r){if(w(r))return bo(r)&&(await this._removeSession(),await re(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async s=>{const{data:n,error:i}=s;if(i)throw i;if(!n.session)throw new se;const o=n.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await Te(this.storage,this.storageKey));const{data:c,error:u}=await m(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:o.access_token,xform:ie});if(u)throw u;return o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(s){if(w(s))return{data:{user:null},error:s};throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new se;const r=Date.now()/1e3;let s=r,n=!0,i=null;const{payload:o}=Kt(e.access_token);if(o.exp&&(s=o.exp,n=s<=r),n){const{session:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!a)return{data:{user:null,session:null},error:null};i=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:s-r,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(w(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var s;if(!e){const{data:o,error:a}=r;if(a)throw a;e=(s=o.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new se;const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(w(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(e,r){try{if(!M())throw new ft("No browser detected.");if(e.error||e.error_description||e.error_code)throw new ft(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new rs("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ft("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new rs("No code detected.");const{data:E,error:_}=await this._exchangeCodeForSession(e.code);if(_)throw _;const y=new URL(window.location.href);return y.searchParams.delete("code"),window.history.replaceState(window.history.state,"",y.toString()),{data:{session:E.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:n,access_token:i,refresh_token:o,expires_in:a,expires_at:l,token_type:c}=e;if(!i||!a||!o||!c)throw new ft("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(a);let d=u+h;l&&(d=parseInt(l));const f=d-u;f*1e3<=Pe&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${h}s`);const p=d-h;u-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,d,u):u-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,d,u);const{data:v,error:g}=await this._getUser(i);if(g)throw g;const b={provider_token:s,provider_refresh_token:n,access_token:i,expires_in:h,expires_at:d,refresh_token:o,token_type:c,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:b,redirectType:e.type},error:null}}catch(s){if(w(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await he(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var s;const{data:n,error:i}=r;if(i)return{error:i};const o=(s=n.session)===null||s===void 0?void 0:s.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(mo(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await re(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const r=Po(),s={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async r=>{var s,n;try{const{data:{session:i},error:o}=r;if(o)throw o;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,r={}){let s=null,n=null;this.flowType==="pkce"&&([s,n]=await Te(this.storage,this.storageKey,!0));try{return await m(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(w(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:r,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(r){if(w(r))return{data:null,error:r};throw r}}async linkIdentity(e){var r;try{const{data:s,error:n}=await this._useSession(async i=>{var o,a,l,c,u;const{data:h,error:d}=i;if(d)throw d;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await m(this.fetch,"GET",f,{headers:this.headers,jwt:(u=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(n)throw n;return M()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),{data:{provider:e.provider,url:s==null?void 0:s.url},error:null}}catch(s){if(w(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async r=>{var s,n;const{data:i,error:o}=r;if(o)throw o;return await m(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})})}catch(r){if(w(r))return{data:null,error:r};throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const s=Date.now();return await Lo(async n=>(n>0&&await Io(200*Math.pow(2,n-1)),this._debug(r,"refreshing attempt",n),await m(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Z})),(n,i)=>{const o=200*Math.pow(2,n);return i&&Ht(i)&&Date.now()+o-s<Pe})}catch(s){if(this._debug(r,"error",s),w(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",s),M()&&!r.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,r;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const n=await he(this.storage,this.storageKey);if(n&&this.userStorage){let o=await he(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:n.user},await je(this.userStorage,this.storageKey+"-user",o)),n.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:Wt()}else if(n&&!n.user&&!n.user){const o=await he(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(n.user=o.user,await re(this.storage,this.storageKey+"-user"),await je(this.storage,this.storageKey,n)):n.user=Wt()}if(this._debug(s,"session from storage",n),!this._isValidSession(n)){this._debug(s,"session is not valid"),n!==null&&await this._removeSession();return}const i=((r=n.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Ft;if(this._debug(s,`session has${i?"":" not"} expired with margin of ${Ft}s`),i){if(this.autoRefreshToken&&n.refresh_token){const{error:o}=await this._callRefreshToken(n.refresh_token);o&&(console.error(o),Ht(o)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:a}=await this._getUser(n.access_token);!a&&(o!=null&&o.user)?(n.user=o.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(s,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(s,"error",n),console.error(n);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var r,s;if(!e)throw new se;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new Pt;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new se;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const a={session:i.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(i){if(this._debug(n,"error",i),w(i)){const o={session:null,error:i};return Ht(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,r,s=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",r,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:r});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,r)}catch(l){i.push(l)}});if(await Promise.all(o),i.length>0){for(let a=0;a<i.length;a+=1)console.error(i[a]);throw i[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),s=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&r.user&&await je(this.userStorage,this.storageKey+"-user",{user:r.user});const n=Object.assign({},r);delete n.user;const i=as(n);await je(this.storage,this.storageKey,i)}else{const n=as(r);await je(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),await re(this.storage,this.storageKey),await re(this.storage,this.storageKey+"-code-verifier"),await re(this.storage,this.storageKey+"-user"),this.userStorage&&await re(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&M()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Pe);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:s}}=r;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((s.expires_at*1e3-e)/Pe);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${Pe}ms, refresh threshold is ${or} ticks`),n<=or&&await this._callRefreshToken(s.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Vs)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!M()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,s){const n=[`provider=${encodeURIComponent(r)}`];if(s!=null&&s.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[i,o]=await Te(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});n.push(a.toString())}if(s!=null&&s.queryParams){const i=new URLSearchParams(s.queryParams);n.push(i.toString())}return s!=null&&s.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var s;const{data:n,error:i}=r;return i?{data:null,error:i}:await m(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(w(r))return{data:null,error:r};throw r}}async _enroll(e){try{return await this._useSession(async r=>{var s,n;const{data:i,error:o}=r;if(o)return{data:null,error:o};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:c}=await m(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((n=l==null?void 0:l.totp)===null||n===void 0)&&n.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(w(r))return{data:null,error:r};throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:i}=r;if(i)return{data:null,error:i};const{data:o,error:a}=await m(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:a})})}catch(r){if(w(r))return{data:null,error:r};throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:i}=r;return i?{data:null,error:i}:await m(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(w(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(e){const{data:r,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){const{data:{user:e},error:r}=await this.getUser();if(r)return{data:null,error:r};const s=(e==null?void 0:e.factors)||[],n=s.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=s.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:s,totp:n,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var r,s;const{data:{session:n},error:i}=e;if(i)return{data:null,error:i};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Kt(n.access_token);let a=null;o.aal&&(a=o.aal);let l=a;((s=(r=n.user.factors)===null||r===void 0?void 0:r.filter(h=>h.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(l="aal2");const u=o.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(e,r={keys:[]}){let s=r.keys.find(a=>a.kid===e);if(s)return s;const n=Date.now();if(s=this.jwks.keys.find(a=>a.kid===e),s&&this.jwks_cached_at+wo>n)return s;const{data:i,error:o}=await m(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=n,s=i.keys.find(a=>a.kid===e),!s)?null:s}async getClaims(e,r={}){try{let s=e;if(!s){const{data:f,error:p}=await this.getSession();if(p||!f.session)return{data:null,error:p};s=f.session.access_token}const{header:n,payload:i,signature:o,raw:{header:a,payload:l}}=Kt(s);r!=null&&r.allowExpired||Fo(i.exp);const c=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!c){const{error:f}=await this.getUser(s);if(f)throw f;return{data:{claims:i,header:n,signature:o},error:null}}const u=Ho(n.alg),h=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,o,Ao(`${a}.${l}`)))throw new cr("Invalid JWT signature");return{data:{claims:i,header:n,signature:o},error:null}}catch(s){if(w(s))return{data:null,error:s};throw s}}}Xe.nextInstanceID=0;const ia=Xe;class oa extends ia{constructor(e){super(e)}}var aa=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};class la{constructor(e,r,s){var n,i,o;if(this.supabaseUrl=e,this.supabaseKey=r,!e)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const a=ho(e),l=new URL(a);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:so,realtime:io,auth:Object.assign(Object.assign({},no),{storageKey:c}),global:ro},h=fo(s??{},u);this.storageKey=(n=h.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(i=h.global.headers)!==null&&i!==void 0?i:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(d,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=co(r,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new Ei(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new Qi(this.storageUrl.href,this.headers,this.fetch,s==null?void 0:s.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new hi(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},s={}){return this.rest.rpc(e,r,s)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,r;return aa(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return(r=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:s,storage:n,storageKey:i,flowType:o,lock:a,debug:l},c,u){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new oa({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),c),storageKey:i,autoRefreshToken:e,persistSession:r,detectSessionInUrl:s,storage:n,flowType:o,lock:a,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new qi(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,s)=>{this._handleTokenChanged(r,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(e,r,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?this.changedAccessToken=s:e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const ca=(t,e,r)=>new la(t,e,r);function ua(){if(typeof window<"u"||typeof process>"u"||process.version===void 0||process.version===null)return!1;const t=process.version.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}ua()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");var ha=te('<div class="result"><p><strong> </strong> </p></div>'),da=te('<div class="c"></div>');function fa(t,e){var r=da();Hn(r,21,()=>e.results,({title:s,author:n,id:i})=>i,(s,n)=>{let i=()=>j(n).title,o=()=>j(n).author;var a=ha(),l=I(a),c=I(l),u=I(c,!0);O(c);var h=U(c);O(l),O(a),mt(()=>{Yt(u,i()),Yt(h,` by ${o()??""}`)}),F(s,a)}),O(r),F(t,r)}var pa=te('<p class="error"> </p>'),ga=te('<p class="no-results">No results found.</p>'),_a=te('<div id="search" class="c svelte-wbc5p4"><h2 class="svelte-wbc5p4">Database Search</h2> <form class="ui svelte-wbc5p4"><div class="input-group svelte-wbc5p4"><label for="search-input">Search</label> <input id="search-input" type="text" placeholder="Enter a search term..." class="svelte-wbc5p4"/></div> <div class="select-group svelte-wbc5p4"><label for="select-field">Field</label> <select id="select-field" class="svelte-wbc5p4"><option>Text</option><option>Title</option><option>Author</option></select></div> <button id="search-button" type="submit" class="svelte-wbc5p4">Search</button></form> <p class="advanced svelte-wbc5p4"><button class="link svelte-wbc5p4">advanced filters</button></p> <div class="results svelte-wbc5p4"><!></div></div>');function va(t,e){wr(e,!0);let r,s=Me(null),n=Me(null),i=Me(""),o=Me("text"),a=Me(!1);async function l(x){if(x.preventDefault(),console.time("search"),!j(i)||j(i).trim()===""){D(n,"Please enter a search term."),D(s,null);return}try{D(a,!0);const{data:W,error:ye}=await r.from("oldb").select("id,title,author").textSearch(j(o),j(i).trim(),{type:"websearch"}).order("title",{ascending:!0}).limit(100);ye?(console.error("Search error:",ye),D(n,"Search failed. Please try again."),D(s,null)):(D(s,W||[],!0),D(n,null))}catch(W){console.error("Unexpected error:",W),W="Something went wrong. Please try again.",D(s,null)}finally{D(i,""),D(a,!1)}console.timeEnd("search")}Bn(()=>{r=ca("https://dbmtysppmiwwjwaeneex.supabase.co","sb_publishable_4iMeGBcBrV3i_iAemu4tuw_5NDTN77K")});var c=_a(),u=U(I(c),2),h=I(u),d=U(I(h),2);Wn(d),O(h);var f=U(h,2),p=U(I(f),2),v=I(p);v.value=v.__value="text";var g=U(v);g.value=g.__value="title";var b=U(g);b.value=b.__value="author",O(p),O(f);var E=U(f,2);O(u);var _=U(u,4),y=I(_);{var k=x=>{var W=pa(),ye=I(W,!0);O(W),mt(()=>Yt(ye,j(n))),F(x,W)},C=(x,W)=>{{var ye=Lt=>{var Pr=$s(),bn=Ot(Pr);{var kn=me=>{fa(me,{get results(){return j(s)}})},xn=me=>{var Sn=ga();F(me,Sn)};Mt(bn,me=>{j(s).length>0?me(kn):me(xn,!1)})}F(Lt,Pr)};Mt(x,Lt=>{j(s)&&Lt(ye)},W)}};Mt(y,x=>{j(n)?x(k):x(C,!1)})}return O(_),O(c),mt(()=>{d.disabled=j(a),p.disabled=j(a),E.disabled=j(a)}),Fn("submit",u,l),Zn(d,()=>j(i),x=>D(i,x)),Kn(p,()=>j(o),x=>D(o,x)),F(t,c),yr({search:l})}var wa={value:()=>{}};function Js(){for(var t=0,e=arguments.length,r={},s;t<e;++t){if(!(s=arguments[t]+"")||s in r||/[\s.]/.test(s))throw new Error("illegal type: "+s);r[s]=[]}return new vt(r)}function vt(t){this._=t}function ya(t,e){return t.trim().split(/^|\s+/).map(function(r){var s="",n=r.indexOf(".");if(n>=0&&(s=r.slice(n+1),r=r.slice(0,n)),r&&!e.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:s}})}vt.prototype=Js.prototype={constructor:vt,on:function(t,e){var r=this._,s=ya(t+"",r),n,i=-1,o=s.length;if(arguments.length<2){for(;++i<o;)if((n=(t=s[i]).type)&&(n=ma(r[n],t.name)))return n;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++i<o;)if(n=(t=s[i]).type)r[n]=ds(r[n],t.name,e);else if(e==null)for(n in r)r[n]=ds(r[n],t.name,null);return this},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new vt(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var r=new Array(n),s=0,n,i;s<n;++s)r[s]=arguments[s+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=this._[t],s=0,n=i.length;s<n;++s)i[s].value.apply(e,r)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var s=this._[t],n=0,i=s.length;n<i;++n)s[n].value.apply(e,r)}};function ma(t,e){for(var r=0,s=t.length,n;r<s;++r)if((n=t[r]).name===e)return n.value}function ds(t,e,r){for(var s=0,n=t.length;s<n;++s)if(t[s].name===e){t[s]=wa,t=t.slice(0,s).concat(t.slice(s+1));break}return r!=null&&t.push({name:e,value:r}),t}var ur="http://www.w3.org/1999/xhtml";const fs={svg:"http://www.w3.org/2000/svg",xhtml:ur,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function jt(t){var e=t+="",r=e.indexOf(":");return r>=0&&(e=t.slice(0,r))!=="xmlns"&&(t=t.slice(r+1)),fs.hasOwnProperty(e)?{space:fs[e],local:t}:t}function ba(t){return function(){var e=this.ownerDocument,r=this.namespaceURI;return r===ur&&e.documentElement.namespaceURI===ur?e.createElement(t):e.createElementNS(r,t)}}function ka(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Xs(t){var e=jt(t);return(e.local?ka:ba)(e)}function xa(){}function Er(t){return t==null?xa:function(){return this.querySelector(t)}}function Sa(t){typeof t!="function"&&(t=Er(t));for(var e=this._groups,r=e.length,s=new Array(r),n=0;n<r;++n)for(var i=e[n],o=i.length,a=s[n]=new Array(o),l,c,u=0;u<o;++u)(l=i[u])&&(c=t.call(l,l.__data__,u,i))&&("__data__"in l&&(c.__data__=l.__data__),a[u]=c);return new H(s,this._parents)}function Ea(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function Ca(){return[]}function Zs(t){return t==null?Ca:function(){return this.querySelectorAll(t)}}function Ta(t){return function(){return Ea(t.apply(this,arguments))}}function Aa(t){typeof t=="function"?t=Ta(t):t=Zs(t);for(var e=this._groups,r=e.length,s=[],n=[],i=0;i<r;++i)for(var o=e[i],a=o.length,l,c=0;c<a;++c)(l=o[c])&&(s.push(t.call(l,l.__data__,c,o)),n.push(l));return new H(s,n)}function Ys(t){return function(){return this.matches(t)}}function Qs(t){return function(e){return e.matches(t)}}var $a=Array.prototype.find;function Oa(t){return function(){return $a.call(this.children,t)}}function Pa(){return this.firstElementChild}function ja(t){return this.select(t==null?Pa:Oa(typeof t=="function"?t:Qs(t)))}var Ra=Array.prototype.filter;function Ia(){return Array.from(this.children)}function La(t){return function(){return Ra.call(this.children,t)}}function Ua(t){return this.selectAll(t==null?Ia:La(typeof t=="function"?t:Qs(t)))}function Na(t){typeof t!="function"&&(t=Ys(t));for(var e=this._groups,r=e.length,s=new Array(r),n=0;n<r;++n)for(var i=e[n],o=i.length,a=s[n]=[],l,c=0;c<o;++c)(l=i[c])&&t.call(l,l.__data__,c,i)&&a.push(l);return new H(s,this._parents)}function en(t){return new Array(t.length)}function Da(){return new H(this._enter||this._groups.map(en),this._parents)}function St(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}St.prototype={constructor:St,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Ma(t){return function(){return t}}function qa(t,e,r,s,n,i){for(var o=0,a,l=e.length,c=i.length;o<c;++o)(a=e[o])?(a.__data__=i[o],s[o]=a):r[o]=new St(t,i[o]);for(;o<l;++o)(a=e[o])&&(n[o]=a)}function Ba(t,e,r,s,n,i,o){var a,l,c=new Map,u=e.length,h=i.length,d=new Array(u),f;for(a=0;a<u;++a)(l=e[a])&&(d[a]=f=o.call(l,l.__data__,a,e)+"",c.has(f)?n[a]=l:c.set(f,l));for(a=0;a<h;++a)f=o.call(t,i[a],a,i)+"",(l=c.get(f))?(s[a]=l,l.__data__=i[a],c.delete(f)):r[a]=new St(t,i[a]);for(a=0;a<u;++a)(l=e[a])&&c.get(d[a])===l&&(n[a]=l)}function Fa(t){return t.__data__}function Ha(t,e){if(!arguments.length)return Array.from(this,Fa);var r=e?Ba:qa,s=this._parents,n=this._groups;typeof t!="function"&&(t=Ma(t));for(var i=n.length,o=new Array(i),a=new Array(i),l=new Array(i),c=0;c<i;++c){var u=s[c],h=n[c],d=h.length,f=Ka(t.call(u,u&&u.__data__,c,s)),p=f.length,v=a[c]=new Array(p),g=o[c]=new Array(p),b=l[c]=new Array(d);r(u,h,v,g,b,f,e);for(var E=0,_=0,y,k;E<p;++E)if(y=v[E]){for(E>=_&&(_=E+1);!(k=g[_])&&++_<p;);y._next=k||null}}return o=new H(o,s),o._enter=a,o._exit=l,o}function Ka(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Wa(){return new H(this._exit||this._groups.map(en),this._parents)}function za(t,e,r){var s=this.enter(),n=this,i=this.exit();return typeof t=="function"?(s=t(s),s&&(s=s.selection())):s=s.append(t+""),e!=null&&(n=e(n),n&&(n=n.selection())),r==null?i.remove():r(i),s&&n?s.merge(n).order():n}function Ga(t){for(var e=t.selection?t.selection():t,r=this._groups,s=e._groups,n=r.length,i=s.length,o=Math.min(n,i),a=new Array(n),l=0;l<o;++l)for(var c=r[l],u=s[l],h=c.length,d=a[l]=new Array(h),f,p=0;p<h;++p)(f=c[p]||u[p])&&(d[p]=f);for(;l<n;++l)a[l]=r[l];return new H(a,this._parents)}function Va(){for(var t=this._groups,e=-1,r=t.length;++e<r;)for(var s=t[e],n=s.length-1,i=s[n],o;--n>=0;)(o=s[n])&&(i&&o.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(o,i),i=o);return this}function Ja(t){t||(t=Xa);function e(h,d){return h&&d?t(h.__data__,d.__data__):!h-!d}for(var r=this._groups,s=r.length,n=new Array(s),i=0;i<s;++i){for(var o=r[i],a=o.length,l=n[i]=new Array(a),c,u=0;u<a;++u)(c=o[u])&&(l[u]=c);l.sort(e)}return new H(n,this._parents).order()}function Xa(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Za(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Ya(){return Array.from(this)}function Qa(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var s=t[e],n=0,i=s.length;n<i;++n){var o=s[n];if(o)return o}return null}function el(){let t=0;for(const e of this)++t;return t}function tl(){return!this.node()}function rl(t){for(var e=this._groups,r=0,s=e.length;r<s;++r)for(var n=e[r],i=0,o=n.length,a;i<o;++i)(a=n[i])&&t.call(a,a.__data__,i,n);return this}function sl(t){return function(){this.removeAttribute(t)}}function nl(t){return function(){this.removeAttributeNS(t.space,t.local)}}function il(t,e){return function(){this.setAttribute(t,e)}}function ol(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function al(t,e){return function(){var r=e.apply(this,arguments);r==null?this.removeAttribute(t):this.setAttribute(t,r)}}function ll(t,e){return function(){var r=e.apply(this,arguments);r==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,r)}}function cl(t,e){var r=jt(t);if(arguments.length<2){var s=this.node();return r.local?s.getAttributeNS(r.space,r.local):s.getAttribute(r)}return this.each((e==null?r.local?nl:sl:typeof e=="function"?r.local?ll:al:r.local?ol:il)(r,e))}function tn(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function ul(t){return function(){this.style.removeProperty(t)}}function hl(t,e,r){return function(){this.style.setProperty(t,e,r)}}function dl(t,e,r){return function(){var s=e.apply(this,arguments);s==null?this.style.removeProperty(t):this.style.setProperty(t,s,r)}}function fl(t,e,r){return arguments.length>1?this.each((e==null?ul:typeof e=="function"?dl:hl)(t,e,r??"")):Ue(this.node(),t)}function Ue(t,e){return t.style.getPropertyValue(e)||tn(t).getComputedStyle(t,null).getPropertyValue(e)}function pl(t){return function(){delete this[t]}}function gl(t,e){return function(){this[t]=e}}function _l(t,e){return function(){var r=e.apply(this,arguments);r==null?delete this[t]:this[t]=r}}function vl(t,e){return arguments.length>1?this.each((e==null?pl:typeof e=="function"?_l:gl)(t,e)):this.node()[t]}function rn(t){return t.trim().split(/^|\s+/)}function Cr(t){return t.classList||new sn(t)}function sn(t){this._node=t,this._names=rn(t.getAttribute("class")||"")}sn.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function nn(t,e){for(var r=Cr(t),s=-1,n=e.length;++s<n;)r.add(e[s])}function on(t,e){for(var r=Cr(t),s=-1,n=e.length;++s<n;)r.remove(e[s])}function wl(t){return function(){nn(this,t)}}function yl(t){return function(){on(this,t)}}function ml(t,e){return function(){(e.apply(this,arguments)?nn:on)(this,t)}}function bl(t,e){var r=rn(t+"");if(arguments.length<2){for(var s=Cr(this.node()),n=-1,i=r.length;++n<i;)if(!s.contains(r[n]))return!1;return!0}return this.each((typeof e=="function"?ml:e?wl:yl)(r,e))}function kl(){this.textContent=""}function xl(t){return function(){this.textContent=t}}function Sl(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function El(t){return arguments.length?this.each(t==null?kl:(typeof t=="function"?Sl:xl)(t)):this.node().textContent}function Cl(){this.innerHTML=""}function Tl(t){return function(){this.innerHTML=t}}function Al(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function $l(t){return arguments.length?this.each(t==null?Cl:(typeof t=="function"?Al:Tl)(t)):this.node().innerHTML}function Ol(){this.nextSibling&&this.parentNode.appendChild(this)}function Pl(){return this.each(Ol)}function jl(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Rl(){return this.each(jl)}function Il(t){var e=typeof t=="function"?t:Xs(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Ll(){return null}function Ul(t,e){var r=typeof t=="function"?t:Xs(t),s=e==null?Ll:typeof e=="function"?e:Er(e);return this.select(function(){return this.insertBefore(r.apply(this,arguments),s.apply(this,arguments)||null)})}function Nl(){var t=this.parentNode;t&&t.removeChild(this)}function Dl(){return this.each(Nl)}function Ml(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function ql(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Bl(t){return this.select(t?ql:Ml)}function Fl(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Hl(t){return function(e){t.call(this,e,this.__data__)}}function Kl(t){return t.trim().split(/^|\s+/).map(function(e){var r="",s=e.indexOf(".");return s>=0&&(r=e.slice(s+1),e=e.slice(0,s)),{type:e,name:r}})}function Wl(t){return function(){var e=this.__on;if(e){for(var r=0,s=-1,n=e.length,i;r<n;++r)i=e[r],(!t.type||i.type===t.type)&&i.name===t.name?this.removeEventListener(i.type,i.listener,i.options):e[++s]=i;++s?e.length=s:delete this.__on}}}function zl(t,e,r){return function(){var s=this.__on,n,i=Hl(e);if(s){for(var o=0,a=s.length;o<a;++o)if((n=s[o]).type===t.type&&n.name===t.name){this.removeEventListener(n.type,n.listener,n.options),this.addEventListener(n.type,n.listener=i,n.options=r),n.value=e;return}}this.addEventListener(t.type,i,r),n={type:t.type,name:t.name,value:e,listener:i,options:r},s?s.push(n):this.__on=[n]}}function Gl(t,e,r){var s=Kl(t+""),n,i=s.length,o;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,c=a.length,u;l<c;++l)for(n=0,u=a[l];n<i;++n)if((o=s[n]).type===u.type&&o.name===u.name)return u.value}return}for(a=e?zl:Wl,n=0;n<i;++n)this.each(a(s[n],e,r));return this}function an(t,e,r){var s=tn(t),n=s.CustomEvent;typeof n=="function"?n=new n(e,r):(n=s.document.createEvent("Event"),r?(n.initEvent(e,r.bubbles,r.cancelable),n.detail=r.detail):n.initEvent(e,!1,!1)),t.dispatchEvent(n)}function Vl(t,e){return function(){return an(this,t,e)}}function Jl(t,e){return function(){return an(this,t,e.apply(this,arguments))}}function Xl(t,e){return this.each((typeof e=="function"?Jl:Vl)(t,e))}function*Zl(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var s=t[e],n=0,i=s.length,o;n<i;++n)(o=s[n])&&(yield o)}var Yl=[null];function H(t,e){this._groups=t,this._parents=e}function ot(){return new H([[document.documentElement]],Yl)}function Ql(){return this}H.prototype=ot.prototype={constructor:H,select:Sa,selectAll:Aa,selectChild:ja,selectChildren:Ua,filter:Na,data:Ha,enter:Da,exit:Wa,join:za,merge:Ga,selection:Ql,order:Va,sort:Ja,call:Za,nodes:Ya,node:Qa,size:el,empty:tl,each:rl,attr:cl,style:fl,property:vl,classed:bl,text:El,html:$l,raise:Pl,lower:Rl,append:Il,insert:Ul,remove:Dl,clone:Bl,datum:Fl,on:Gl,dispatch:Xl,[Symbol.iterator]:Zl};function Tr(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function ln(t,e){var r=Object.create(t.prototype);for(var s in e)r[s]=e[s];return r}function at(){}var Ze=.7,Et=1/Ze,Re="\\s*([+-]?\\d+)\\s*",Ye="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",V="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ec=/^#([0-9a-f]{3,8})$/,tc=new RegExp(`^rgb\\(${Re},${Re},${Re}\\)$`),rc=new RegExp(`^rgb\\(${V},${V},${V}\\)$`),sc=new RegExp(`^rgba\\(${Re},${Re},${Re},${Ye}\\)$`),nc=new RegExp(`^rgba\\(${V},${V},${V},${Ye}\\)$`),ic=new RegExp(`^hsl\\(${Ye},${V},${V}\\)$`),oc=new RegExp(`^hsla\\(${Ye},${V},${V},${Ye}\\)$`),ps={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Tr(at,Qe,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:gs,formatHex:gs,formatHex8:ac,formatHsl:lc,formatRgb:_s,toString:_s});function gs(){return this.rgb().formatHex()}function ac(){return this.rgb().formatHex8()}function lc(){return cn(this).formatHsl()}function _s(){return this.rgb().formatRgb()}function Qe(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=ec.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?vs(e):r===3?new N(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?pt(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?pt(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=tc.exec(t))?new N(e[1],e[2],e[3],1):(e=rc.exec(t))?new N(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=sc.exec(t))?pt(e[1],e[2],e[3],e[4]):(e=nc.exec(t))?pt(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=ic.exec(t))?ms(e[1],e[2]/100,e[3]/100,1):(e=oc.exec(t))?ms(e[1],e[2]/100,e[3]/100,e[4]):ps.hasOwnProperty(t)?vs(ps[t]):t==="transparent"?new N(NaN,NaN,NaN,0):null}function vs(t){return new N(t>>16&255,t>>8&255,t&255,1)}function pt(t,e,r,s){return s<=0&&(t=e=r=NaN),new N(t,e,r,s)}function cc(t){return t instanceof at||(t=Qe(t)),t?(t=t.rgb(),new N(t.r,t.g,t.b,t.opacity)):new N}function hr(t,e,r,s){return arguments.length===1?cc(t):new N(t,e,r,s??1)}function N(t,e,r,s){this.r=+t,this.g=+e,this.b=+r,this.opacity=+s}Tr(N,hr,ln(at,{brighter(t){return t=t==null?Et:Math.pow(Et,t),new N(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Ze:Math.pow(Ze,t),new N(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new N(_e(this.r),_e(this.g),_e(this.b),Ct(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ws,formatHex:ws,formatHex8:uc,formatRgb:ys,toString:ys}));function ws(){return`#${pe(this.r)}${pe(this.g)}${pe(this.b)}`}function uc(){return`#${pe(this.r)}${pe(this.g)}${pe(this.b)}${pe((isNaN(this.opacity)?1:this.opacity)*255)}`}function ys(){const t=Ct(this.opacity);return`${t===1?"rgb(":"rgba("}${_e(this.r)}, ${_e(this.g)}, ${_e(this.b)}${t===1?")":`, ${t})`}`}function Ct(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function _e(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function pe(t){return t=_e(t),(t<16?"0":"")+t.toString(16)}function ms(t,e,r,s){return s<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new B(t,e,r,s)}function cn(t){if(t instanceof B)return new B(t.h,t.s,t.l,t.opacity);if(t instanceof at||(t=Qe(t)),!t)return new B;if(t instanceof B)return t;t=t.rgb();var e=t.r/255,r=t.g/255,s=t.b/255,n=Math.min(e,r,s),i=Math.max(e,r,s),o=NaN,a=i-n,l=(i+n)/2;return a?(e===i?o=(r-s)/a+(r<s)*6:r===i?o=(s-e)/a+2:o=(e-r)/a+4,a/=l<.5?i+n:2-i-n,o*=60):a=l>0&&l<1?0:o,new B(o,a,l,t.opacity)}function hc(t,e,r,s){return arguments.length===1?cn(t):new B(t,e,r,s??1)}function B(t,e,r,s){this.h=+t,this.s=+e,this.l=+r,this.opacity=+s}Tr(B,hc,ln(at,{brighter(t){return t=t==null?Et:Math.pow(Et,t),new B(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Ze:Math.pow(Ze,t),new B(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,s=r+(r<.5?r:1-r)*e,n=2*r-s;return new N(Gt(t>=240?t-240:t+120,n,s),Gt(t,n,s),Gt(t<120?t+240:t-120,n,s),this.opacity)},clamp(){return new B(bs(this.h),gt(this.s),gt(this.l),Ct(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Ct(this.opacity);return`${t===1?"hsl(":"hsla("}${bs(this.h)}, ${gt(this.s)*100}%, ${gt(this.l)*100}%${t===1?")":`, ${t})`}`}}));function bs(t){return t=(t||0)%360,t<0?t+360:t}function gt(t){return Math.max(0,Math.min(1,t||0))}function Gt(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}const un=t=>()=>t;function dc(t,e){return function(r){return t+r*e}}function fc(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(s){return Math.pow(t+s*e,r)}}function pc(t){return(t=+t)==1?hn:function(e,r){return r-e?fc(e,r,t):un(isNaN(e)?r:e)}}function hn(t,e){var r=e-t;return r?dc(t,r):un(isNaN(t)?e:t)}const ks=function t(e){var r=pc(e);function s(n,i){var o=r((n=hr(n)).r,(i=hr(i)).r),a=r(n.g,i.g),l=r(n.b,i.b),c=hn(n.opacity,i.opacity);return function(u){return n.r=o(u),n.g=a(u),n.b=l(u),n.opacity=c(u),n+""}}return s.gamma=t,s}(1);function ne(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}var dr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Vt=new RegExp(dr.source,"g");function gc(t){return function(){return t}}function _c(t){return function(e){return t(e)+""}}function vc(t,e){var r=dr.lastIndex=Vt.lastIndex=0,s,n,i,o=-1,a=[],l=[];for(t=t+"",e=e+"";(s=dr.exec(t))&&(n=Vt.exec(e));)(i=n.index)>r&&(i=e.slice(r,i),a[o]?a[o]+=i:a[++o]=i),(s=s[0])===(n=n[0])?a[o]?a[o]+=n:a[++o]=n:(a[++o]=null,l.push({i:o,x:ne(s,n)})),r=Vt.lastIndex;return r<e.length&&(i=e.slice(r),a[o]?a[o]+=i:a[++o]=i),a.length<2?l[0]?_c(l[0].x):gc(e):(e=l.length,function(c){for(var u=0,h;u<e;++u)a[(h=l[u]).i]=h.x(c);return a.join("")})}var xs=180/Math.PI,fr={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function dn(t,e,r,s,n,i){var o,a,l;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(l=t*r+e*s)&&(r-=t*l,s-=e*l),(a=Math.sqrt(r*r+s*s))&&(r/=a,s/=a,l/=a),t*s<e*r&&(t=-t,e=-e,l=-l,o=-o),{translateX:n,translateY:i,rotate:Math.atan2(e,t)*xs,skewX:Math.atan(l)*xs,scaleX:o,scaleY:a}}var _t;function wc(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?fr:dn(e.a,e.b,e.c,e.d,e.e,e.f)}function yc(t){return t==null||(_t||(_t=document.createElementNS("http://www.w3.org/2000/svg","g")),_t.setAttribute("transform",t),!(t=_t.transform.baseVal.consolidate()))?fr:(t=t.matrix,dn(t.a,t.b,t.c,t.d,t.e,t.f))}function fn(t,e,r,s){function n(c){return c.length?c.pop()+" ":""}function i(c,u,h,d,f,p){if(c!==h||u!==d){var v=f.push("translate(",null,e,null,r);p.push({i:v-4,x:ne(c,h)},{i:v-2,x:ne(u,d)})}else(h||d)&&f.push("translate("+h+e+d+r)}function o(c,u,h,d){c!==u?(c-u>180?u+=360:u-c>180&&(c+=360),d.push({i:h.push(n(h)+"rotate(",null,s)-2,x:ne(c,u)})):u&&h.push(n(h)+"rotate("+u+s)}function a(c,u,h,d){c!==u?d.push({i:h.push(n(h)+"skewX(",null,s)-2,x:ne(c,u)}):u&&h.push(n(h)+"skewX("+u+s)}function l(c,u,h,d,f,p){if(c!==h||u!==d){var v=f.push(n(f)+"scale(",null,",",null,")");p.push({i:v-4,x:ne(c,h)},{i:v-2,x:ne(u,d)})}else(h!==1||d!==1)&&f.push(n(f)+"scale("+h+","+d+")")}return function(c,u){var h=[],d=[];return c=t(c),u=t(u),i(c.translateX,c.translateY,u.translateX,u.translateY,h,d),o(c.rotate,u.rotate,h,d),a(c.skewX,u.skewX,h,d),l(c.scaleX,c.scaleY,u.scaleX,u.scaleY,h,d),c=u=null,function(f){for(var p=-1,v=d.length,g;++p<v;)h[(g=d[p]).i]=g.x(f);return h.join("")}}}var mc=fn(wc,"px, ","px)","deg)"),bc=fn(yc,", ",")",")"),Ne=0,Ke=0,Fe=0,pn=1e3,Tt,We,At=0,ve=0,Rt=0,et=typeof performance=="object"&&performance.now?performance:Date,gn=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Ar(){return ve||(gn(kc),ve=et.now()+Rt)}function kc(){ve=0}function $t(){this._call=this._time=this._next=null}$t.prototype=_n.prototype={constructor:$t,restart:function(t,e,r){if(typeof t!="function")throw new TypeError("callback is not a function");r=(r==null?Ar():+r)+(e==null?0:+e),!this._next&&We!==this&&(We?We._next=this:Tt=this,We=this),this._call=t,this._time=r,pr()},stop:function(){this._call&&(this._call=null,this._time=1/0,pr())}};function _n(t,e,r){var s=new $t;return s.restart(t,e,r),s}function xc(){Ar(),++Ne;for(var t=Tt,e;t;)(e=ve-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Ne}function Ss(){ve=(At=et.now())+Rt,Ne=Ke=0;try{xc()}finally{Ne=0,Ec(),ve=0}}function Sc(){var t=et.now(),e=t-At;e>pn&&(Rt-=e,At=t)}function Ec(){for(var t,e=Tt,r,s=1/0;e;)e._call?(s>e._time&&(s=e._time),t=e,e=e._next):(r=e._next,e._next=null,e=t?t._next=r:Tt=r);We=t,pr(s)}function pr(t){if(!Ne){Ke&&(Ke=clearTimeout(Ke));var e=t-ve;e>24?(t<1/0&&(Ke=setTimeout(Ss,t-et.now()-Rt)),Fe&&(Fe=clearInterval(Fe))):(Fe||(At=et.now(),Fe=setInterval(Sc,pn)),Ne=1,gn(Ss))}}function Es(t,e,r){var s=new $t;return e=e==null?0:+e,s.restart(n=>{s.stop(),t(n+e)},e,r),s}var Cc=Js("start","end","cancel","interrupt"),Tc=[],vn=0,Cs=1,gr=2,wt=3,Ts=4,_r=5,yt=6;function It(t,e,r,s,n,i){var o=t.__transition;if(!o)t.__transition={};else if(r in o)return;Ac(t,r,{name:e,index:s,group:n,on:Cc,tween:Tc,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:vn})}function $r(t,e){var r=K(t,e);if(r.state>vn)throw new Error("too late; already scheduled");return r}function J(t,e){var r=K(t,e);if(r.state>wt)throw new Error("too late; already running");return r}function K(t,e){var r=t.__transition;if(!r||!(r=r[e]))throw new Error("transition not found");return r}function Ac(t,e,r){var s=t.__transition,n;s[e]=r,r.timer=_n(i,0,r.time);function i(c){r.state=Cs,r.timer.restart(o,r.delay,r.time),r.delay<=c&&o(c-r.delay)}function o(c){var u,h,d,f;if(r.state!==Cs)return l();for(u in s)if(f=s[u],f.name===r.name){if(f.state===wt)return Es(o);f.state===Ts?(f.state=yt,f.timer.stop(),f.on.call("interrupt",t,t.__data__,f.index,f.group),delete s[u]):+u<e&&(f.state=yt,f.timer.stop(),f.on.call("cancel",t,t.__data__,f.index,f.group),delete s[u])}if(Es(function(){r.state===wt&&(r.state=Ts,r.timer.restart(a,r.delay,r.time),a(c))}),r.state=gr,r.on.call("start",t,t.__data__,r.index,r.group),r.state===gr){for(r.state=wt,n=new Array(d=r.tween.length),u=0,h=-1;u<d;++u)(f=r.tween[u].value.call(t,t.__data__,r.index,r.group))&&(n[++h]=f);n.length=h+1}}function a(c){for(var u=c<r.duration?r.ease.call(null,c/r.duration):(r.timer.restart(l),r.state=_r,1),h=-1,d=n.length;++h<d;)n[h].call(t,u);r.state===_r&&(r.on.call("end",t,t.__data__,r.index,r.group),l())}function l(){r.state=yt,r.timer.stop(),delete s[e];for(var c in s)return;delete t.__transition}}function $c(t,e){var r=t.__transition,s,n,i=!0,o;if(r){e=e==null?null:e+"";for(o in r){if((s=r[o]).name!==e){i=!1;continue}n=s.state>gr&&s.state<_r,s.state=yt,s.timer.stop(),s.on.call(n?"interrupt":"cancel",t,t.__data__,s.index,s.group),delete r[o]}i&&delete t.__transition}}function Oc(t){return this.each(function(){$c(this,t)})}function Pc(t,e){var r,s;return function(){var n=J(this,t),i=n.tween;if(i!==r){s=r=i;for(var o=0,a=s.length;o<a;++o)if(s[o].name===e){s=s.slice(),s.splice(o,1);break}}n.tween=s}}function jc(t,e,r){var s,n;if(typeof r!="function")throw new Error;return function(){var i=J(this,t),o=i.tween;if(o!==s){n=(s=o).slice();for(var a={name:e,value:r},l=0,c=n.length;l<c;++l)if(n[l].name===e){n[l]=a;break}l===c&&n.push(a)}i.tween=n}}function Rc(t,e){var r=this._id;if(t+="",arguments.length<2){for(var s=K(this.node(),r).tween,n=0,i=s.length,o;n<i;++n)if((o=s[n]).name===t)return o.value;return null}return this.each((e==null?Pc:jc)(r,t,e))}function Or(t,e,r){var s=t._id;return t.each(function(){var n=J(this,s);(n.value||(n.value={}))[e]=r.apply(this,arguments)}),function(n){return K(n,s).value[e]}}function wn(t,e){var r;return(typeof e=="number"?ne:e instanceof Qe?ks:(r=Qe(e))?(e=r,ks):vc)(t,e)}function Ic(t){return function(){this.removeAttribute(t)}}function Lc(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Uc(t,e,r){var s,n=r+"",i;return function(){var o=this.getAttribute(t);return o===n?null:o===s?i:i=e(s=o,r)}}function Nc(t,e,r){var s,n=r+"",i;return function(){var o=this.getAttributeNS(t.space,t.local);return o===n?null:o===s?i:i=e(s=o,r)}}function Dc(t,e,r){var s,n,i;return function(){var o,a=r(this),l;return a==null?void this.removeAttribute(t):(o=this.getAttribute(t),l=a+"",o===l?null:o===s&&l===n?i:(n=l,i=e(s=o,a)))}}function Mc(t,e,r){var s,n,i;return function(){var o,a=r(this),l;return a==null?void this.removeAttributeNS(t.space,t.local):(o=this.getAttributeNS(t.space,t.local),l=a+"",o===l?null:o===s&&l===n?i:(n=l,i=e(s=o,a)))}}function qc(t,e){var r=jt(t),s=r==="transform"?bc:wn;return this.attrTween(t,typeof e=="function"?(r.local?Mc:Dc)(r,s,Or(this,"attr."+t,e)):e==null?(r.local?Lc:Ic)(r):(r.local?Nc:Uc)(r,s,e))}function Bc(t,e){return function(r){this.setAttribute(t,e.call(this,r))}}function Fc(t,e){return function(r){this.setAttributeNS(t.space,t.local,e.call(this,r))}}function Hc(t,e){var r,s;function n(){var i=e.apply(this,arguments);return i!==s&&(r=(s=i)&&Fc(t,i)),r}return n._value=e,n}function Kc(t,e){var r,s;function n(){var i=e.apply(this,arguments);return i!==s&&(r=(s=i)&&Bc(t,i)),r}return n._value=e,n}function Wc(t,e){var r="attr."+t;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;var s=jt(t);return this.tween(r,(s.local?Hc:Kc)(s,e))}function zc(t,e){return function(){$r(this,t).delay=+e.apply(this,arguments)}}function Gc(t,e){return e=+e,function(){$r(this,t).delay=e}}function Vc(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?zc:Gc)(e,t)):K(this.node(),e).delay}function Jc(t,e){return function(){J(this,t).duration=+e.apply(this,arguments)}}function Xc(t,e){return e=+e,function(){J(this,t).duration=e}}function Zc(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Jc:Xc)(e,t)):K(this.node(),e).duration}function Yc(t,e){if(typeof e!="function")throw new Error;return function(){J(this,t).ease=e}}function Qc(t){var e=this._id;return arguments.length?this.each(Yc(e,t)):K(this.node(),e).ease}function eu(t,e){return function(){var r=e.apply(this,arguments);if(typeof r!="function")throw new Error;J(this,t).ease=r}}function tu(t){if(typeof t!="function")throw new Error;return this.each(eu(this._id,t))}function ru(t){typeof t!="function"&&(t=Ys(t));for(var e=this._groups,r=e.length,s=new Array(r),n=0;n<r;++n)for(var i=e[n],o=i.length,a=s[n]=[],l,c=0;c<o;++c)(l=i[c])&&t.call(l,l.__data__,c,i)&&a.push(l);return new ee(s,this._parents,this._name,this._id)}function su(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,r=t._groups,s=e.length,n=r.length,i=Math.min(s,n),o=new Array(s),a=0;a<i;++a)for(var l=e[a],c=r[a],u=l.length,h=o[a]=new Array(u),d,f=0;f<u;++f)(d=l[f]||c[f])&&(h[f]=d);for(;a<s;++a)o[a]=e[a];return new ee(o,this._parents,this._name,this._id)}function nu(t){return(t+"").trim().split(/^|\s+/).every(function(e){var r=e.indexOf(".");return r>=0&&(e=e.slice(0,r)),!e||e==="start"})}function iu(t,e,r){var s,n,i=nu(e)?$r:J;return function(){var o=i(this,t),a=o.on;a!==s&&(n=(s=a).copy()).on(e,r),o.on=n}}function ou(t,e){var r=this._id;return arguments.length<2?K(this.node(),r).on.on(t):this.each(iu(r,t,e))}function au(t){return function(){var e=this.parentNode;for(var r in this.__transition)if(+r!==t)return;e&&e.removeChild(this)}}function lu(){return this.on("end.remove",au(this._id))}function cu(t){var e=this._name,r=this._id;typeof t!="function"&&(t=Er(t));for(var s=this._groups,n=s.length,i=new Array(n),o=0;o<n;++o)for(var a=s[o],l=a.length,c=i[o]=new Array(l),u,h,d=0;d<l;++d)(u=a[d])&&(h=t.call(u,u.__data__,d,a))&&("__data__"in u&&(h.__data__=u.__data__),c[d]=h,It(c[d],e,r,d,c,K(u,r)));return new ee(i,this._parents,e,r)}function uu(t){var e=this._name,r=this._id;typeof t!="function"&&(t=Zs(t));for(var s=this._groups,n=s.length,i=[],o=[],a=0;a<n;++a)for(var l=s[a],c=l.length,u,h=0;h<c;++h)if(u=l[h]){for(var d=t.call(u,u.__data__,h,l),f,p=K(u,r),v=0,g=d.length;v<g;++v)(f=d[v])&&It(f,e,r,v,d,p);i.push(d),o.push(u)}return new ee(i,o,e,r)}var hu=ot.prototype.constructor;function du(){return new hu(this._groups,this._parents)}function fu(t,e){var r,s,n;return function(){var i=Ue(this,t),o=(this.style.removeProperty(t),Ue(this,t));return i===o?null:i===r&&o===s?n:n=e(r=i,s=o)}}function yn(t){return function(){this.style.removeProperty(t)}}function pu(t,e,r){var s,n=r+"",i;return function(){var o=Ue(this,t);return o===n?null:o===s?i:i=e(s=o,r)}}function gu(t,e,r){var s,n,i;return function(){var o=Ue(this,t),a=r(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(t),Ue(this,t))),o===l?null:o===s&&l===n?i:(n=l,i=e(s=o,a))}}function _u(t,e){var r,s,n,i="style."+e,o="end."+i,a;return function(){var l=J(this,t),c=l.on,u=l.value[i]==null?a||(a=yn(e)):void 0;(c!==r||n!==u)&&(s=(r=c).copy()).on(o,n=u),l.on=s}}function vu(t,e,r){var s=(t+="")=="transform"?mc:wn;return e==null?this.styleTween(t,fu(t,s)).on("end.style."+t,yn(t)):typeof e=="function"?this.styleTween(t,gu(t,s,Or(this,"style."+t,e))).each(_u(this._id,t)):this.styleTween(t,pu(t,s,e),r).on("end.style."+t,null)}function wu(t,e,r){return function(s){this.style.setProperty(t,e.call(this,s),r)}}function yu(t,e,r){var s,n;function i(){var o=e.apply(this,arguments);return o!==n&&(s=(n=o)&&wu(t,o,r)),s}return i._value=e,i}function mu(t,e,r){var s="style."+(t+="");if(arguments.length<2)return(s=this.tween(s))&&s._value;if(e==null)return this.tween(s,null);if(typeof e!="function")throw new Error;return this.tween(s,yu(t,e,r??""))}function bu(t){return function(){this.textContent=t}}function ku(t){return function(){var e=t(this);this.textContent=e??""}}function xu(t){return this.tween("text",typeof t=="function"?ku(Or(this,"text",t)):bu(t==null?"":t+""))}function Su(t){return function(e){this.textContent=t.call(this,e)}}function Eu(t){var e,r;function s(){var n=t.apply(this,arguments);return n!==r&&(e=(r=n)&&Su(n)),e}return s._value=t,s}function Cu(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,Eu(t))}function Tu(){for(var t=this._name,e=this._id,r=mn(),s=this._groups,n=s.length,i=0;i<n;++i)for(var o=s[i],a=o.length,l,c=0;c<a;++c)if(l=o[c]){var u=K(l,e);It(l,t,r,c,o,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new ee(s,this._parents,t,r)}function Au(){var t,e,r=this,s=r._id,n=r.size();return new Promise(function(i,o){var a={value:o},l={value:function(){--n===0&&i()}};r.each(function(){var c=J(this,s),u=c.on;u!==t&&(e=(t=u).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),c.on=e}),n===0&&i()})}var $u=0;function ee(t,e,r,s){this._groups=t,this._parents=e,this._name=r,this._id=s}function mn(){return++$u}var X=ot.prototype;ee.prototype={constructor:ee,select:cu,selectAll:uu,selectChild:X.selectChild,selectChildren:X.selectChildren,filter:ru,merge:su,selection:du,transition:Tu,call:X.call,nodes:X.nodes,node:X.node,size:X.size,empty:X.empty,each:X.each,on:ou,attr:qc,attrTween:Wc,style:vu,styleTween:mu,text:xu,textTween:Cu,remove:lu,tween:Rc,delay:Vc,duration:Zc,ease:Qc,easeVarying:tu,end:Au,[Symbol.iterator]:X[Symbol.iterator]};function Ou(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var Pu={time:null,delay:0,duration:250,ease:Ou};function ju(t,e){for(var r;!(r=t.__transition)||!(r=r[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return r}function Ru(t){var e,r;t instanceof ee?(e=t._id,t=t._name):(e=mn(),(r=Pu).time=Ar(),t=t==null?null:t+"");for(var s=this._groups,n=s.length,i=0;i<n;++i)for(var o=s[i],a=o.length,l,c=0;c<a;++c)(l=o[c])&&It(l,t,e,c,o,r||ju(l,e));return new ee(s,this._parents,t,e)}ot.prototype.interrupt=Oc;ot.prototype.transition=Ru;function ze(t,e,r){this.k=t,this.x=e,this.y=r}ze.prototype={constructor:ze,scale:function(t){return t===1?this:new ze(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new ze(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};ze.prototype;var Iu=te("<!> <!> <!> <!>",1);function Lu(t){var e=Iu(),r=Ot(e);ni(r);var s=U(r,2);ai(s);var n=U(s,2);va(n,{});var i=U(n,2);ei(i,{onerror:o=>console.error(o)},o=>{}),F(t,e)}const Uu={title:"Title TK",description:"Description tk."},Nu=[{section:"intro",content:[{type:"h4",value:"An h4 element with no attributes"},{type:"text",value:"Some random text here, followed by an img tag."},{type:"img",value:{src:"../assets/demo/test.jpg",alt:"A cat"}},{type:"Test",value:{label:"I’m a custom component!",value:"50"}}]}],As={meta:Uu,body:Nu};function Du(){console.log("--- --- --- --- --- ---"),console.log("svelte-starter: 6.14.0"),console.log("build: 2025-07-31-12:20"),console.log("--- --- --- --- --- ---")}var Mu=te("<!> <!>",1);function th(t,e){wr(e,!0),Du();const r=["https://pudding.cool/assets/fonts/tiempos/TiemposTextWeb-Regular.woff2","https://pudding.cool/assets/fonts/tiempos/TiemposTextWeb-Bold.woff2","https://pudding.cool/assets/fonts/atlas/AtlasGrotesk-Regular-Web.woff2","https://pudding.cool/assets/fonts/atlas/AtlasGrotesk-Bold-Web.woff2"],{title:s,description:n,url:i,keywords:o}=As;Dr("copy",As),Dr("data",e.data);var a=Mu(),l=Ot(a);zn(l,{get title(){return s},get description(){return n},get url(){return i},get preloadFont(){return r},get keywords(){return o}});var c=U(l,2);Lu(c),F(t,a),yr()}export{th as component};

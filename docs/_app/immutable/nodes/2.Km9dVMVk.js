var kn=t=>{throw TypeError(t)};var mr=(t,e,r)=>e.has(t)||kn("Cannot "+r);var U=(t,e,r)=>(mr(t,e,"read from private field"),r?r.call(t):e.get(t)),ue=(t,e,r)=>e.has(t)?kn("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),H=(t,e,r,n)=>(mr(t,e,"write to private field"),n?n.call(t,r):e.set(t,r),r),br=(t,e,r)=>(mr(t,e,"access private method"),r);import"../chunks/BxLtU0B9.js";import{t as Et,C as St,R as Dr,aq as Lr,a_ as Ki,a2 as tr,am as Vi,aB as Gi,a$ as Ji,b0 as Yi,aE as xn,Y as Nr,b1 as Zi,al as Bt,Q as Xi,$ as kr,b2 as Sn,b3 as Ht,b4 as Tn,d as Cn,e as Qi,az as En,ae as eo,a0 as to,aZ as Us,X as ro,b5 as no,T as so,b6 as io,b7 as oo,p as fr,u as Is,f as we,a as se,b as gr,F as I,ag as Te,s as At,c as F,ac as z,J as K,r as M,a9 as Ms,aa as pr,ab as ao,a5 as lo,b8 as uo,x as An}from"../chunks/BHu7j-Xp.js";import{s as co,I as ho,e as fo,b as go,r as po,M as _o}from"../chunks/B9Zbhg-T.js";import{s as vo,r as yo}from"../chunks/eKsgyMk5.js";import{i as xr}from"../chunks/MbEMDntm.js";import{b as wo}from"../chunks/D9kKCNyA.js";import{_ as Lt}from"../chunks/Dp1pzeXC.js";function mo(t,e,r=!1,n=!1,s=!1){var i=t,o="";Et(()=>{var a=Lr;if(o===(o=e()??"")){St&&Dr();return}if(a.nodes_start!==null&&(Ki(a.nodes_start,a.nodes_end),a.nodes_start=a.nodes_end=null),o!==""){if(St){tr.data;for(var l=Dr(),u=l;l!==null&&(l.nodeType!==Vi||l.data!=="");)u=l,l=Gi(l);if(l===null)throw Ji(),Yi;xn(tr,u),i=Nr(l);return}var c=o+"";r?c=`<svg>${c}</svg>`:n&&(c=`<math>${c}</math>`);var h=Zi(c);if((r||n)&&(h=Bt(h)),xn(Bt(h),h.lastChild),r||n)for(;Bt(h);)i.before(Bt(h));else i.before(h)}})}var bo=so|io|oo;function ko(t,e,r){new xo(t,e,r)}var Ee,It,at,Mt,Ae,$e,ce,De,Dt,Fr;class xo{constructor(e,r,n){ue(this,Dt);ue(this,Ee);ue(this,It);ue(this,at);ue(this,Mt);ue(this,Ae);ue(this,$e,null);ue(this,ce,null);ue(this,De,!1);H(this,Ee,e),H(this,at,r),H(this,Mt,n),H(this,It,tr),H(this,Ae,Xi(()=>{Lr.b=this,St&&Dr();try{H(this,$e,kr(()=>n(U(this,Ee))))}catch(s){this.error(s)}},bo)),St&&H(this,Ee,tr)}error(e){var r=U(this,at).onerror;let n=U(this,at).failed;const s=()=>{U(this,ce)!==null&&to(U(this,ce),()=>{H(this,ce,null)}),H(this,$e,br(this,Dt,Fr).call(this,()=>(H(this,De,!1),kr(()=>U(this,Mt).call(this,U(this,Ee))))))};if(U(this,De)||!r&&!n)throw e;var i=Cn;try{Ht(null),r==null||r(e,s)}finally{Ht(i)}U(this,$e)&&(En(U(this,$e)),H(this,$e,null)),U(this,ce)&&(En(U(this,ce)),H(this,ce,null)),St&&(Nr(U(this,It)),Us(),Nr(ro())),n&&eo(()=>{H(this,ce,br(this,Dt,Fr).call(this,()=>{H(this,De,!0);try{return kr(()=>{n(U(this,Ee),()=>e,()=>s)})}catch(o){return no(o,U(this,Ae).parent),null}finally{H(this,De,!1)}}))})}}Ee=new WeakMap,It=new WeakMap,at=new WeakMap,Mt=new WeakMap,Ae=new WeakMap,$e=new WeakMap,ce=new WeakMap,De=new WeakMap,Dt=new WeakSet,Fr=function(e){var r=Lr,n=Cn,s=Qi;Sn(U(this,Ae)),Ht(U(this,Ae)),Tn(U(this,Ae).ctx);try{return e()}finally{Sn(r),Ht(n),Tn(s)}};var So={value:()=>{}};function Ds(){for(var t=0,e=arguments.length,r={},n;t<e;++t){if(!(n=arguments[t]+"")||n in r||/[\s.]/.test(n))throw new Error("illegal type: "+n);r[n]=[]}return new Xt(r)}function Xt(t){this._=t}function To(t,e){return t.trim().split(/^|\s+/).map(function(r){var n="",s=r.indexOf(".");if(s>=0&&(n=r.slice(s+1),r=r.slice(0,s)),r&&!e.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:n}})}Xt.prototype=Ds.prototype={constructor:Xt,on:function(t,e){var r=this._,n=To(t+"",r),s,i=-1,o=n.length;if(arguments.length<2){for(;++i<o;)if((s=(t=n[i]).type)&&(s=Co(r[s],t.name)))return s;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++i<o;)if(s=(t=n[i]).type)r[s]=$n(r[s],t.name,e);else if(e==null)for(s in r)r[s]=$n(r[s],t.name,null);return this},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new Xt(t)},call:function(t,e){if((s=arguments.length-2)>0)for(var r=new Array(s),n=0,s,i;n<s;++n)r[n]=arguments[n+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=this._[t],n=0,s=i.length;n<s;++n)i[n].value.apply(e,r)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],s=0,i=n.length;s<i;++s)n[s].value.apply(e,r)}};function Co(t,e){for(var r=0,n=t.length,s;r<n;++r)if((s=t[r]).name===e)return s.value}function $n(t,e,r){for(var n=0,s=t.length;n<s;++n)if(t[n].name===e){t[n]=So,t=t.slice(0,n).concat(t.slice(n+1));break}return r!=null&&t.push({name:e,value:r}),t}var qr="http://www.w3.org/1999/xhtml";const On={svg:"http://www.w3.org/2000/svg",xhtml:qr,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function _r(t){var e=t+="",r=e.indexOf(":");return r>=0&&(e=t.slice(0,r))!=="xmlns"&&(t=t.slice(r+1)),On.hasOwnProperty(e)?{space:On[e],local:t}:t}function Eo(t){return function(){var e=this.ownerDocument,r=this.namespaceURI;return r===qr&&e.documentElement.namespaceURI===qr?e.createElement(t):e.createElementNS(r,t)}}function Ao(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Ls(t){var e=_r(t);return(e.local?Ao:Eo)(e)}function $o(){}function on(t){return t==null?$o:function(){return this.querySelector(t)}}function Oo(t){typeof t!="function"&&(t=on(t));for(var e=this._groups,r=e.length,n=new Array(r),s=0;s<r;++s)for(var i=e[s],o=i.length,a=n[s]=new Array(o),l,u,c=0;c<o;++c)(l=i[c])&&(u=t.call(l,l.__data__,c,i))&&("__data__"in l&&(u.__data__=l.__data__),a[c]=u);return new ie(n,this._parents)}function Po(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function jo(){return[]}function Ns(t){return t==null?jo:function(){return this.querySelectorAll(t)}}function Ro(t){return function(){return Po(t.apply(this,arguments))}}function Uo(t){typeof t=="function"?t=Ro(t):t=Ns(t);for(var e=this._groups,r=e.length,n=[],s=[],i=0;i<r;++i)for(var o=e[i],a=o.length,l,u=0;u<a;++u)(l=o[u])&&(n.push(t.call(l,l.__data__,u,o)),s.push(l));return new ie(n,s)}function Fs(t){return function(){return this.matches(t)}}function qs(t){return function(e){return e.matches(t)}}var Io=Array.prototype.find;function Mo(t){return function(){return Io.call(this.children,t)}}function Do(){return this.firstElementChild}function Lo(t){return this.select(t==null?Do:Mo(typeof t=="function"?t:qs(t)))}var No=Array.prototype.filter;function Fo(){return Array.from(this.children)}function qo(t){return function(){return No.call(this.children,t)}}function Bo(t){return this.selectAll(t==null?Fo:qo(typeof t=="function"?t:qs(t)))}function Ho(t){typeof t!="function"&&(t=Fs(t));for(var e=this._groups,r=e.length,n=new Array(r),s=0;s<r;++s)for(var i=e[s],o=i.length,a=n[s]=[],l,u=0;u<o;++u)(l=i[u])&&t.call(l,l.__data__,u,i)&&a.push(l);return new ie(n,this._parents)}function Bs(t){return new Array(t.length)}function Wo(){return new ie(this._enter||this._groups.map(Bs),this._parents)}function rr(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}rr.prototype={constructor:rr,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function zo(t){return function(){return t}}function Ko(t,e,r,n,s,i){for(var o=0,a,l=e.length,u=i.length;o<u;++o)(a=e[o])?(a.__data__=i[o],n[o]=a):r[o]=new rr(t,i[o]);for(;o<l;++o)(a=e[o])&&(s[o]=a)}function Vo(t,e,r,n,s,i,o){var a,l,u=new Map,c=e.length,h=i.length,d=new Array(c),f;for(a=0;a<c;++a)(l=e[a])&&(d[a]=f=o.call(l,l.__data__,a,e)+"",u.has(f)?s[a]=l:u.set(f,l));for(a=0;a<h;++a)f=o.call(t,i[a],a,i)+"",(l=u.get(f))?(n[a]=l,l.__data__=i[a],u.delete(f)):r[a]=new rr(t,i[a]);for(a=0;a<c;++a)(l=e[a])&&u.get(d[a])===l&&(s[a]=l)}function Go(t){return t.__data__}function Jo(t,e){if(!arguments.length)return Array.from(this,Go);var r=e?Vo:Ko,n=this._parents,s=this._groups;typeof t!="function"&&(t=zo(t));for(var i=s.length,o=new Array(i),a=new Array(i),l=new Array(i),u=0;u<i;++u){var c=n[u],h=s[u],d=h.length,f=Yo(t.call(c,c&&c.__data__,u,n)),g=f.length,y=a[u]=new Array(g),v=o[u]=new Array(g),x=l[u]=new Array(d);r(c,h,y,v,x,f,e);for(var P=0,_=0,m,k;P<g;++P)if(m=y[P]){for(P>=_&&(_=P+1);!(k=v[_])&&++_<g;);m._next=k||null}}return o=new ie(o,n),o._enter=a,o._exit=l,o}function Yo(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Zo(){return new ie(this._exit||this._groups.map(Bs),this._parents)}function Xo(t,e,r){var n=this.enter(),s=this,i=this.exit();return typeof t=="function"?(n=t(n),n&&(n=n.selection())):n=n.append(t+""),e!=null&&(s=e(s),s&&(s=s.selection())),r==null?i.remove():r(i),n&&s?n.merge(s).order():s}function Qo(t){for(var e=t.selection?t.selection():t,r=this._groups,n=e._groups,s=r.length,i=n.length,o=Math.min(s,i),a=new Array(s),l=0;l<o;++l)for(var u=r[l],c=n[l],h=u.length,d=a[l]=new Array(h),f,g=0;g<h;++g)(f=u[g]||c[g])&&(d[g]=f);for(;l<s;++l)a[l]=r[l];return new ie(a,this._parents)}function ea(){for(var t=this._groups,e=-1,r=t.length;++e<r;)for(var n=t[e],s=n.length-1,i=n[s],o;--s>=0;)(o=n[s])&&(i&&o.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(o,i),i=o);return this}function ta(t){t||(t=ra);function e(h,d){return h&&d?t(h.__data__,d.__data__):!h-!d}for(var r=this._groups,n=r.length,s=new Array(n),i=0;i<n;++i){for(var o=r[i],a=o.length,l=s[i]=new Array(a),u,c=0;c<a;++c)(u=o[c])&&(l[c]=u);l.sort(e)}return new ie(s,this._parents).order()}function ra(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function na(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function sa(){return Array.from(this)}function ia(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var n=t[e],s=0,i=n.length;s<i;++s){var o=n[s];if(o)return o}return null}function oa(){let t=0;for(const e of this)++t;return t}function aa(){return!this.node()}function la(t){for(var e=this._groups,r=0,n=e.length;r<n;++r)for(var s=e[r],i=0,o=s.length,a;i<o;++i)(a=s[i])&&t.call(a,a.__data__,i,s);return this}function ua(t){return function(){this.removeAttribute(t)}}function ca(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ha(t,e){return function(){this.setAttribute(t,e)}}function da(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function fa(t,e){return function(){var r=e.apply(this,arguments);r==null?this.removeAttribute(t):this.setAttribute(t,r)}}function ga(t,e){return function(){var r=e.apply(this,arguments);r==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,r)}}function pa(t,e){var r=_r(t);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((e==null?r.local?ca:ua:typeof e=="function"?r.local?ga:fa:r.local?da:ha)(r,e))}function Hs(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function _a(t){return function(){this.style.removeProperty(t)}}function va(t,e,r){return function(){this.style.setProperty(t,e,r)}}function ya(t,e,r){return function(){var n=e.apply(this,arguments);n==null?this.style.removeProperty(t):this.style.setProperty(t,n,r)}}function wa(t,e,r){return arguments.length>1?this.each((e==null?_a:typeof e=="function"?ya:va)(t,e,r??"")):lt(this.node(),t)}function lt(t,e){return t.style.getPropertyValue(e)||Hs(t).getComputedStyle(t,null).getPropertyValue(e)}function ma(t){return function(){delete this[t]}}function ba(t,e){return function(){this[t]=e}}function ka(t,e){return function(){var r=e.apply(this,arguments);r==null?delete this[t]:this[t]=r}}function xa(t,e){return arguments.length>1?this.each((e==null?ma:typeof e=="function"?ka:ba)(t,e)):this.node()[t]}function Ws(t){return t.trim().split(/^|\s+/)}function an(t){return t.classList||new zs(t)}function zs(t){this._node=t,this._names=Ws(t.getAttribute("class")||"")}zs.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Ks(t,e){for(var r=an(t),n=-1,s=e.length;++n<s;)r.add(e[n])}function Vs(t,e){for(var r=an(t),n=-1,s=e.length;++n<s;)r.remove(e[n])}function Sa(t){return function(){Ks(this,t)}}function Ta(t){return function(){Vs(this,t)}}function Ca(t,e){return function(){(e.apply(this,arguments)?Ks:Vs)(this,t)}}function Ea(t,e){var r=Ws(t+"");if(arguments.length<2){for(var n=an(this.node()),s=-1,i=r.length;++s<i;)if(!n.contains(r[s]))return!1;return!0}return this.each((typeof e=="function"?Ca:e?Sa:Ta)(r,e))}function Aa(){this.textContent=""}function $a(t){return function(){this.textContent=t}}function Oa(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function Pa(t){return arguments.length?this.each(t==null?Aa:(typeof t=="function"?Oa:$a)(t)):this.node().textContent}function ja(){this.innerHTML=""}function Ra(t){return function(){this.innerHTML=t}}function Ua(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function Ia(t){return arguments.length?this.each(t==null?ja:(typeof t=="function"?Ua:Ra)(t)):this.node().innerHTML}function Ma(){this.nextSibling&&this.parentNode.appendChild(this)}function Da(){return this.each(Ma)}function La(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Na(){return this.each(La)}function Fa(t){var e=typeof t=="function"?t:Ls(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function qa(){return null}function Ba(t,e){var r=typeof t=="function"?t:Ls(t),n=e==null?qa:typeof e=="function"?e:on(e);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})}function Ha(){var t=this.parentNode;t&&t.removeChild(this)}function Wa(){return this.each(Ha)}function za(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Ka(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Va(t){return this.select(t?Ka:za)}function Ga(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Ja(t){return function(e){t.call(this,e,this.__data__)}}function Ya(t){return t.trim().split(/^|\s+/).map(function(e){var r="",n=e.indexOf(".");return n>=0&&(r=e.slice(n+1),e=e.slice(0,n)),{type:e,name:r}})}function Za(t){return function(){var e=this.__on;if(e){for(var r=0,n=-1,s=e.length,i;r<s;++r)i=e[r],(!t.type||i.type===t.type)&&i.name===t.name?this.removeEventListener(i.type,i.listener,i.options):e[++n]=i;++n?e.length=n:delete this.__on}}}function Xa(t,e,r){return function(){var n=this.__on,s,i=Ja(e);if(n){for(var o=0,a=n.length;o<a;++o)if((s=n[o]).type===t.type&&s.name===t.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=i,s.options=r),s.value=e;return}}this.addEventListener(t.type,i,r),s={type:t.type,name:t.name,value:e,listener:i,options:r},n?n.push(s):this.__on=[s]}}function Qa(t,e,r){var n=Ya(t+""),s,i=n.length,o;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,u=a.length,c;l<u;++l)for(s=0,c=a[l];s<i;++s)if((o=n[s]).type===c.type&&o.name===c.name)return c.value}return}for(a=e?Xa:Za,s=0;s<i;++s)this.each(a(n[s],e,r));return this}function Gs(t,e,r){var n=Hs(t),s=n.CustomEvent;typeof s=="function"?s=new s(e,r):(s=n.document.createEvent("Event"),r?(s.initEvent(e,r.bubbles,r.cancelable),s.detail=r.detail):s.initEvent(e,!1,!1)),t.dispatchEvent(s)}function el(t,e){return function(){return Gs(this,t,e)}}function tl(t,e){return function(){return Gs(this,t,e.apply(this,arguments))}}function rl(t,e){return this.each((typeof e=="function"?tl:el)(t,e))}function*nl(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var n=t[e],s=0,i=n.length,o;s<i;++s)(o=n[s])&&(yield o)}var sl=[null];function ie(t,e){this._groups=t,this._parents=e}function Nt(){return new ie([[document.documentElement]],sl)}function il(){return this}ie.prototype=Nt.prototype={constructor:ie,select:Oo,selectAll:Uo,selectChild:Lo,selectChildren:Bo,filter:Ho,data:Jo,enter:Wo,exit:Zo,join:Xo,merge:Qo,selection:il,order:ea,sort:ta,call:na,nodes:sa,node:ia,size:oa,empty:aa,each:la,attr:pa,style:wa,property:xa,classed:Ea,text:Pa,html:Ia,raise:Da,lower:Na,append:Fa,insert:Ba,remove:Wa,clone:Va,datum:Ga,on:Qa,dispatch:rl,[Symbol.iterator]:nl};function ln(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function Js(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function Ft(){}var $t=.7,nr=1/$t,ot="\\s*([+-]?\\d+)\\s*",Ot="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",he="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ol=/^#([0-9a-f]{3,8})$/,al=new RegExp(`^rgb\\(${ot},${ot},${ot}\\)$`),ll=new RegExp(`^rgb\\(${he},${he},${he}\\)$`),ul=new RegExp(`^rgba\\(${ot},${ot},${ot},${Ot}\\)$`),cl=new RegExp(`^rgba\\(${he},${he},${he},${Ot}\\)$`),hl=new RegExp(`^hsl\\(${Ot},${he},${he}\\)$`),dl=new RegExp(`^hsla\\(${Ot},${he},${he},${Ot}\\)$`),Pn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ln(Ft,Pt,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:jn,formatHex:jn,formatHex8:fl,formatHsl:gl,formatRgb:Rn,toString:Rn});function jn(){return this.rgb().formatHex()}function fl(){return this.rgb().formatHex8()}function gl(){return Ys(this).formatHsl()}function Rn(){return this.rgb().formatRgb()}function Pt(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=ol.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?Un(e):r===3?new J(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?Wt(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?Wt(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=al.exec(t))?new J(e[1],e[2],e[3],1):(e=ll.exec(t))?new J(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=ul.exec(t))?Wt(e[1],e[2],e[3],e[4]):(e=cl.exec(t))?Wt(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=hl.exec(t))?Dn(e[1],e[2]/100,e[3]/100,1):(e=dl.exec(t))?Dn(e[1],e[2]/100,e[3]/100,e[4]):Pn.hasOwnProperty(t)?Un(Pn[t]):t==="transparent"?new J(NaN,NaN,NaN,0):null}function Un(t){return new J(t>>16&255,t>>8&255,t&255,1)}function Wt(t,e,r,n){return n<=0&&(t=e=r=NaN),new J(t,e,r,n)}function pl(t){return t instanceof Ft||(t=Pt(t)),t?(t=t.rgb(),new J(t.r,t.g,t.b,t.opacity)):new J}function Br(t,e,r,n){return arguments.length===1?pl(t):new J(t,e,r,n??1)}function J(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}ln(J,Br,Js(Ft,{brighter(t){return t=t==null?nr:Math.pow(nr,t),new J(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?$t:Math.pow($t,t),new J(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new J(Le(this.r),Le(this.g),Le(this.b),sr(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:In,formatHex:In,formatHex8:_l,formatRgb:Mn,toString:Mn}));function In(){return`#${Me(this.r)}${Me(this.g)}${Me(this.b)}`}function _l(){return`#${Me(this.r)}${Me(this.g)}${Me(this.b)}${Me((isNaN(this.opacity)?1:this.opacity)*255)}`}function Mn(){const t=sr(this.opacity);return`${t===1?"rgb(":"rgba("}${Le(this.r)}, ${Le(this.g)}, ${Le(this.b)}${t===1?")":`, ${t})`}`}function sr(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Le(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Me(t){return t=Le(t),(t<16?"0":"")+t.toString(16)}function Dn(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new ne(t,e,r,n)}function Ys(t){if(t instanceof ne)return new ne(t.h,t.s,t.l,t.opacity);if(t instanceof Ft||(t=Pt(t)),!t)return new ne;if(t instanceof ne)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,s=Math.min(e,r,n),i=Math.max(e,r,n),o=NaN,a=i-s,l=(i+s)/2;return a?(e===i?o=(r-n)/a+(r<n)*6:r===i?o=(n-e)/a+2:o=(e-r)/a+4,a/=l<.5?i+s:2-i-s,o*=60):a=l>0&&l<1?0:o,new ne(o,a,l,t.opacity)}function vl(t,e,r,n){return arguments.length===1?Ys(t):new ne(t,e,r,n??1)}function ne(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}ln(ne,vl,Js(Ft,{brighter(t){return t=t==null?nr:Math.pow(nr,t),new ne(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?$t:Math.pow($t,t),new ne(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,s=2*r-n;return new J(Sr(t>=240?t-240:t+120,s,n),Sr(t,s,n),Sr(t<120?t+240:t-120,s,n),this.opacity)},clamp(){return new ne(Ln(this.h),zt(this.s),zt(this.l),sr(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=sr(this.opacity);return`${t===1?"hsl(":"hsla("}${Ln(this.h)}, ${zt(this.s)*100}%, ${zt(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Ln(t){return t=(t||0)%360,t<0?t+360:t}function zt(t){return Math.max(0,Math.min(1,t||0))}function Sr(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}const Zs=t=>()=>t;function yl(t,e){return function(r){return t+r*e}}function wl(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function ml(t){return(t=+t)==1?Xs:function(e,r){return r-e?wl(e,r,t):Zs(isNaN(e)?r:e)}}function Xs(t,e){var r=e-t;return r?yl(t,r):Zs(isNaN(t)?e:t)}const Nn=function t(e){var r=ml(e);function n(s,i){var o=r((s=Br(s)).r,(i=Br(i)).r),a=r(s.g,i.g),l=r(s.b,i.b),u=Xs(s.opacity,i.opacity);return function(c){return s.r=o(c),s.g=a(c),s.b=l(c),s.opacity=u(c),s+""}}return n.gamma=t,n}(1);function Se(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}var Hr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Tr=new RegExp(Hr.source,"g");function bl(t){return function(){return t}}function kl(t){return function(e){return t(e)+""}}function xl(t,e){var r=Hr.lastIndex=Tr.lastIndex=0,n,s,i,o=-1,a=[],l=[];for(t=t+"",e=e+"";(n=Hr.exec(t))&&(s=Tr.exec(e));)(i=s.index)>r&&(i=e.slice(r,i),a[o]?a[o]+=i:a[++o]=i),(n=n[0])===(s=s[0])?a[o]?a[o]+=s:a[++o]=s:(a[++o]=null,l.push({i:o,x:Se(n,s)})),r=Tr.lastIndex;return r<e.length&&(i=e.slice(r),a[o]?a[o]+=i:a[++o]=i),a.length<2?l[0]?kl(l[0].x):bl(e):(e=l.length,function(u){for(var c=0,h;c<e;++c)a[(h=l[c]).i]=h.x(u);return a.join("")})}var Fn=180/Math.PI,Wr={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Qs(t,e,r,n,s,i){var o,a,l;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(l=t*r+e*n)&&(r-=t*l,n-=e*l),(a=Math.sqrt(r*r+n*n))&&(r/=a,n/=a,l/=a),t*n<e*r&&(t=-t,e=-e,l=-l,o=-o),{translateX:s,translateY:i,rotate:Math.atan2(e,t)*Fn,skewX:Math.atan(l)*Fn,scaleX:o,scaleY:a}}var Kt;function Sl(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Wr:Qs(e.a,e.b,e.c,e.d,e.e,e.f)}function Tl(t){return t==null||(Kt||(Kt=document.createElementNS("http://www.w3.org/2000/svg","g")),Kt.setAttribute("transform",t),!(t=Kt.transform.baseVal.consolidate()))?Wr:(t=t.matrix,Qs(t.a,t.b,t.c,t.d,t.e,t.f))}function ei(t,e,r,n){function s(u){return u.length?u.pop()+" ":""}function i(u,c,h,d,f,g){if(u!==h||c!==d){var y=f.push("translate(",null,e,null,r);g.push({i:y-4,x:Se(u,h)},{i:y-2,x:Se(c,d)})}else(h||d)&&f.push("translate("+h+e+d+r)}function o(u,c,h,d){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),d.push({i:h.push(s(h)+"rotate(",null,n)-2,x:Se(u,c)})):c&&h.push(s(h)+"rotate("+c+n)}function a(u,c,h,d){u!==c?d.push({i:h.push(s(h)+"skewX(",null,n)-2,x:Se(u,c)}):c&&h.push(s(h)+"skewX("+c+n)}function l(u,c,h,d,f,g){if(u!==h||c!==d){var y=f.push(s(f)+"scale(",null,",",null,")");g.push({i:y-4,x:Se(u,h)},{i:y-2,x:Se(c,d)})}else(h!==1||d!==1)&&f.push(s(f)+"scale("+h+","+d+")")}return function(u,c){var h=[],d=[];return u=t(u),c=t(c),i(u.translateX,u.translateY,c.translateX,c.translateY,h,d),o(u.rotate,c.rotate,h,d),a(u.skewX,c.skewX,h,d),l(u.scaleX,u.scaleY,c.scaleX,c.scaleY,h,d),u=c=null,function(f){for(var g=-1,y=d.length,v;++g<y;)h[(v=d[g]).i]=v.x(f);return h.join("")}}}var Cl=ei(Sl,"px, ","px)","deg)"),El=ei(Tl,", ",")",")"),ut=0,mt=0,gt=0,ti=1e3,ir,bt,or=0,Ne=0,vr=0,jt=typeof performance=="object"&&performance.now?performance:Date,ri=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function un(){return Ne||(ri(Al),Ne=jt.now()+vr)}function Al(){Ne=0}function ar(){this._call=this._time=this._next=null}ar.prototype=ni.prototype={constructor:ar,restart:function(t,e,r){if(typeof t!="function")throw new TypeError("callback is not a function");r=(r==null?un():+r)+(e==null?0:+e),!this._next&&bt!==this&&(bt?bt._next=this:ir=this,bt=this),this._call=t,this._time=r,zr()},stop:function(){this._call&&(this._call=null,this._time=1/0,zr())}};function ni(t,e,r){var n=new ar;return n.restart(t,e,r),n}function $l(){un(),++ut;for(var t=ir,e;t;)(e=Ne-t._time)>=0&&t._call.call(void 0,e),t=t._next;--ut}function qn(){Ne=(or=jt.now())+vr,ut=mt=0;try{$l()}finally{ut=0,Pl(),Ne=0}}function Ol(){var t=jt.now(),e=t-or;e>ti&&(vr-=e,or=t)}function Pl(){for(var t,e=ir,r,n=1/0;e;)e._call?(n>e._time&&(n=e._time),t=e,e=e._next):(r=e._next,e._next=null,e=t?t._next=r:ir=r);bt=t,zr(n)}function zr(t){if(!ut){mt&&(mt=clearTimeout(mt));var e=t-Ne;e>24?(t<1/0&&(mt=setTimeout(qn,t-jt.now()-vr)),gt&&(gt=clearInterval(gt))):(gt||(or=jt.now(),gt=setInterval(Ol,ti)),ut=1,ri(qn))}}function Bn(t,e,r){var n=new ar;return e=e==null?0:+e,n.restart(s=>{n.stop(),t(s+e)},e,r),n}var jl=Ds("start","end","cancel","interrupt"),Rl=[],si=0,Hn=1,Kr=2,Qt=3,Wn=4,Vr=5,er=6;function yr(t,e,r,n,s,i){var o=t.__transition;if(!o)t.__transition={};else if(r in o)return;Ul(t,r,{name:e,index:n,group:s,on:jl,tween:Rl,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:si})}function cn(t,e){var r=oe(t,e);if(r.state>si)throw new Error("too late; already scheduled");return r}function de(t,e){var r=oe(t,e);if(r.state>Qt)throw new Error("too late; already running");return r}function oe(t,e){var r=t.__transition;if(!r||!(r=r[e]))throw new Error("transition not found");return r}function Ul(t,e,r){var n=t.__transition,s;n[e]=r,r.timer=ni(i,0,r.time);function i(u){r.state=Hn,r.timer.restart(o,r.delay,r.time),r.delay<=u&&o(u-r.delay)}function o(u){var c,h,d,f;if(r.state!==Hn)return l();for(c in n)if(f=n[c],f.name===r.name){if(f.state===Qt)return Bn(o);f.state===Wn?(f.state=er,f.timer.stop(),f.on.call("interrupt",t,t.__data__,f.index,f.group),delete n[c]):+c<e&&(f.state=er,f.timer.stop(),f.on.call("cancel",t,t.__data__,f.index,f.group),delete n[c])}if(Bn(function(){r.state===Qt&&(r.state=Wn,r.timer.restart(a,r.delay,r.time),a(u))}),r.state=Kr,r.on.call("start",t,t.__data__,r.index,r.group),r.state===Kr){for(r.state=Qt,s=new Array(d=r.tween.length),c=0,h=-1;c<d;++c)(f=r.tween[c].value.call(t,t.__data__,r.index,r.group))&&(s[++h]=f);s.length=h+1}}function a(u){for(var c=u<r.duration?r.ease.call(null,u/r.duration):(r.timer.restart(l),r.state=Vr,1),h=-1,d=s.length;++h<d;)s[h].call(t,c);r.state===Vr&&(r.on.call("end",t,t.__data__,r.index,r.group),l())}function l(){r.state=er,r.timer.stop(),delete n[e];for(var u in n)return;delete t.__transition}}function Il(t,e){var r=t.__transition,n,s,i=!0,o;if(r){e=e==null?null:e+"";for(o in r){if((n=r[o]).name!==e){i=!1;continue}s=n.state>Kr&&n.state<Vr,n.state=er,n.timer.stop(),n.on.call(s?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete r[o]}i&&delete t.__transition}}function Ml(t){return this.each(function(){Il(this,t)})}function Dl(t,e){var r,n;return function(){var s=de(this,t),i=s.tween;if(i!==r){n=r=i;for(var o=0,a=n.length;o<a;++o)if(n[o].name===e){n=n.slice(),n.splice(o,1);break}}s.tween=n}}function Ll(t,e,r){var n,s;if(typeof r!="function")throw new Error;return function(){var i=de(this,t),o=i.tween;if(o!==n){s=(n=o).slice();for(var a={name:e,value:r},l=0,u=s.length;l<u;++l)if(s[l].name===e){s[l]=a;break}l===u&&s.push(a)}i.tween=s}}function Nl(t,e){var r=this._id;if(t+="",arguments.length<2){for(var n=oe(this.node(),r).tween,s=0,i=n.length,o;s<i;++s)if((o=n[s]).name===t)return o.value;return null}return this.each((e==null?Dl:Ll)(r,t,e))}function hn(t,e,r){var n=t._id;return t.each(function(){var s=de(this,n);(s.value||(s.value={}))[e]=r.apply(this,arguments)}),function(s){return oe(s,n).value[e]}}function ii(t,e){var r;return(typeof e=="number"?Se:e instanceof Pt?Nn:(r=Pt(e))?(e=r,Nn):xl)(t,e)}function Fl(t){return function(){this.removeAttribute(t)}}function ql(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Bl(t,e,r){var n,s=r+"",i;return function(){var o=this.getAttribute(t);return o===s?null:o===n?i:i=e(n=o,r)}}function Hl(t,e,r){var n,s=r+"",i;return function(){var o=this.getAttributeNS(t.space,t.local);return o===s?null:o===n?i:i=e(n=o,r)}}function Wl(t,e,r){var n,s,i;return function(){var o,a=r(this),l;return a==null?void this.removeAttribute(t):(o=this.getAttribute(t),l=a+"",o===l?null:o===n&&l===s?i:(s=l,i=e(n=o,a)))}}function zl(t,e,r){var n,s,i;return function(){var o,a=r(this),l;return a==null?void this.removeAttributeNS(t.space,t.local):(o=this.getAttributeNS(t.space,t.local),l=a+"",o===l?null:o===n&&l===s?i:(s=l,i=e(n=o,a)))}}function Kl(t,e){var r=_r(t),n=r==="transform"?El:ii;return this.attrTween(t,typeof e=="function"?(r.local?zl:Wl)(r,n,hn(this,"attr."+t,e)):e==null?(r.local?ql:Fl)(r):(r.local?Hl:Bl)(r,n,e))}function Vl(t,e){return function(r){this.setAttribute(t,e.call(this,r))}}function Gl(t,e){return function(r){this.setAttributeNS(t.space,t.local,e.call(this,r))}}function Jl(t,e){var r,n;function s(){var i=e.apply(this,arguments);return i!==n&&(r=(n=i)&&Gl(t,i)),r}return s._value=e,s}function Yl(t,e){var r,n;function s(){var i=e.apply(this,arguments);return i!==n&&(r=(n=i)&&Vl(t,i)),r}return s._value=e,s}function Zl(t,e){var r="attr."+t;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;var n=_r(t);return this.tween(r,(n.local?Jl:Yl)(n,e))}function Xl(t,e){return function(){cn(this,t).delay=+e.apply(this,arguments)}}function Ql(t,e){return e=+e,function(){cn(this,t).delay=e}}function eu(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Xl:Ql)(e,t)):oe(this.node(),e).delay}function tu(t,e){return function(){de(this,t).duration=+e.apply(this,arguments)}}function ru(t,e){return e=+e,function(){de(this,t).duration=e}}function nu(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?tu:ru)(e,t)):oe(this.node(),e).duration}function su(t,e){if(typeof e!="function")throw new Error;return function(){de(this,t).ease=e}}function iu(t){var e=this._id;return arguments.length?this.each(su(e,t)):oe(this.node(),e).ease}function ou(t,e){return function(){var r=e.apply(this,arguments);if(typeof r!="function")throw new Error;de(this,t).ease=r}}function au(t){if(typeof t!="function")throw new Error;return this.each(ou(this._id,t))}function lu(t){typeof t!="function"&&(t=Fs(t));for(var e=this._groups,r=e.length,n=new Array(r),s=0;s<r;++s)for(var i=e[s],o=i.length,a=n[s]=[],l,u=0;u<o;++u)(l=i[u])&&t.call(l,l.__data__,u,i)&&a.push(l);return new ye(n,this._parents,this._name,this._id)}function uu(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,r=t._groups,n=e.length,s=r.length,i=Math.min(n,s),o=new Array(n),a=0;a<i;++a)for(var l=e[a],u=r[a],c=l.length,h=o[a]=new Array(c),d,f=0;f<c;++f)(d=l[f]||u[f])&&(h[f]=d);for(;a<n;++a)o[a]=e[a];return new ye(o,this._parents,this._name,this._id)}function cu(t){return(t+"").trim().split(/^|\s+/).every(function(e){var r=e.indexOf(".");return r>=0&&(e=e.slice(0,r)),!e||e==="start"})}function hu(t,e,r){var n,s,i=cu(e)?cn:de;return function(){var o=i(this,t),a=o.on;a!==n&&(s=(n=a).copy()).on(e,r),o.on=s}}function du(t,e){var r=this._id;return arguments.length<2?oe(this.node(),r).on.on(t):this.each(hu(r,t,e))}function fu(t){return function(){var e=this.parentNode;for(var r in this.__transition)if(+r!==t)return;e&&e.removeChild(this)}}function gu(){return this.on("end.remove",fu(this._id))}function pu(t){var e=this._name,r=this._id;typeof t!="function"&&(t=on(t));for(var n=this._groups,s=n.length,i=new Array(s),o=0;o<s;++o)for(var a=n[o],l=a.length,u=i[o]=new Array(l),c,h,d=0;d<l;++d)(c=a[d])&&(h=t.call(c,c.__data__,d,a))&&("__data__"in c&&(h.__data__=c.__data__),u[d]=h,yr(u[d],e,r,d,u,oe(c,r)));return new ye(i,this._parents,e,r)}function _u(t){var e=this._name,r=this._id;typeof t!="function"&&(t=Ns(t));for(var n=this._groups,s=n.length,i=[],o=[],a=0;a<s;++a)for(var l=n[a],u=l.length,c,h=0;h<u;++h)if(c=l[h]){for(var d=t.call(c,c.__data__,h,l),f,g=oe(c,r),y=0,v=d.length;y<v;++y)(f=d[y])&&yr(f,e,r,y,d,g);i.push(d),o.push(c)}return new ye(i,o,e,r)}var vu=Nt.prototype.constructor;function yu(){return new vu(this._groups,this._parents)}function wu(t,e){var r,n,s;return function(){var i=lt(this,t),o=(this.style.removeProperty(t),lt(this,t));return i===o?null:i===r&&o===n?s:s=e(r=i,n=o)}}function oi(t){return function(){this.style.removeProperty(t)}}function mu(t,e,r){var n,s=r+"",i;return function(){var o=lt(this,t);return o===s?null:o===n?i:i=e(n=o,r)}}function bu(t,e,r){var n,s,i;return function(){var o=lt(this,t),a=r(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(t),lt(this,t))),o===l?null:o===n&&l===s?i:(s=l,i=e(n=o,a))}}function ku(t,e){var r,n,s,i="style."+e,o="end."+i,a;return function(){var l=de(this,t),u=l.on,c=l.value[i]==null?a||(a=oi(e)):void 0;(u!==r||s!==c)&&(n=(r=u).copy()).on(o,s=c),l.on=n}}function xu(t,e,r){var n=(t+="")=="transform"?Cl:ii;return e==null?this.styleTween(t,wu(t,n)).on("end.style."+t,oi(t)):typeof e=="function"?this.styleTween(t,bu(t,n,hn(this,"style."+t,e))).each(ku(this._id,t)):this.styleTween(t,mu(t,n,e),r).on("end.style."+t,null)}function Su(t,e,r){return function(n){this.style.setProperty(t,e.call(this,n),r)}}function Tu(t,e,r){var n,s;function i(){var o=e.apply(this,arguments);return o!==s&&(n=(s=o)&&Su(t,o,r)),n}return i._value=e,i}function Cu(t,e,r){var n="style."+(t+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;return this.tween(n,Tu(t,e,r??""))}function Eu(t){return function(){this.textContent=t}}function Au(t){return function(){var e=t(this);this.textContent=e??""}}function $u(t){return this.tween("text",typeof t=="function"?Au(hn(this,"text",t)):Eu(t==null?"":t+""))}function Ou(t){return function(e){this.textContent=t.call(this,e)}}function Pu(t){var e,r;function n(){var s=t.apply(this,arguments);return s!==r&&(e=(r=s)&&Ou(s)),e}return n._value=t,n}function ju(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,Pu(t))}function Ru(){for(var t=this._name,e=this._id,r=ai(),n=this._groups,s=n.length,i=0;i<s;++i)for(var o=n[i],a=o.length,l,u=0;u<a;++u)if(l=o[u]){var c=oe(l,e);yr(l,t,r,u,o,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new ye(n,this._parents,t,r)}function Uu(){var t,e,r=this,n=r._id,s=r.size();return new Promise(function(i,o){var a={value:o},l={value:function(){--s===0&&i()}};r.each(function(){var u=de(this,n),c=u.on;c!==t&&(e=(t=c).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),u.on=e}),s===0&&i()})}var Iu=0;function ye(t,e,r,n){this._groups=t,this._parents=e,this._name=r,this._id=n}function ai(){return++Iu}var ge=Nt.prototype;ye.prototype={constructor:ye,select:pu,selectAll:_u,selectChild:ge.selectChild,selectChildren:ge.selectChildren,filter:lu,merge:uu,selection:yu,transition:Ru,call:ge.call,nodes:ge.nodes,node:ge.node,size:ge.size,empty:ge.empty,each:ge.each,on:du,attr:Kl,attrTween:Zl,style:xu,styleTween:Cu,text:$u,textTween:ju,remove:gu,tween:Nl,delay:eu,duration:nu,ease:iu,easeVarying:au,end:Uu,[Symbol.iterator]:ge[Symbol.iterator]};function Mu(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var Du={time:null,delay:0,duration:250,ease:Mu};function Lu(t,e){for(var r;!(r=t.__transition)||!(r=r[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return r}function Nu(t){var e,r;t instanceof ye?(e=t._id,t=t._name):(e=ai(),(r=Du).time=un(),t=t==null?null:t+"");for(var n=this._groups,s=n.length,i=0;i<s;++i)for(var o=n[i],a=o.length,l,u=0;u<a;++u)(l=o[u])&&yr(l,t,e,u,o,r||Lu(l,e));return new ye(n,this._parents,t,e)}Nt.prototype.interrupt=Ml;Nt.prototype.transition=Nu;function Fu(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function lr(t,e){if((r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var r,n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function qu(t){return t=lr(Math.abs(t)),t?t[1]:NaN}function Bu(t,e){return function(r,n){for(var s=r.length,i=[],o=0,a=t[0],l=0;s>0&&a>0&&(l+a+1>n&&(a=Math.max(1,n-l)),i.push(r.substring(s-=a,s+a)),!((l+=a+1)>n));)a=t[o=(o+1)%t.length];return i.reverse().join(e)}}function Hu(t){return function(e){return e.replace(/[0-9]/g,function(r){return t[+r]})}}var Wu=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Gr(t){if(!(e=Wu.exec(t)))throw new Error("invalid format: "+t);var e;return new dn({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}Gr.prototype=dn.prototype;function dn(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}dn.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function zu(t){e:for(var e=t.length,r=1,n=-1,s;r<e;++r)switch(t[r]){case".":n=s=r;break;case"0":n===0&&(n=r),s=r;break;default:if(!+t[r])break e;n>0&&(n=0);break}return n>0?t.slice(0,n)+t.slice(s+1):t}var li;function Ku(t,e){var r=lr(t,e);if(!r)return t+"";var n=r[0],s=r[1],i=s-(li=Math.max(-8,Math.min(8,Math.floor(s/3)))*3)+1,o=n.length;return i===o?n:i>o?n+new Array(i-o+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+lr(t,Math.max(0,e+i-1))[0]}function zn(t,e){var r=lr(t,e);if(!r)return t+"";var n=r[0],s=r[1];return s<0?"0."+new Array(-s).join("0")+n:n.length>s+1?n.slice(0,s+1)+"."+n.slice(s+1):n+new Array(s-n.length+2).join("0")}const Kn={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Fu,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>zn(t*100,e),r:zn,s:Ku,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Vn(t){return t}var Gn=Array.prototype.map,Jn=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Vu(t){var e=t.grouping===void 0||t.thousands===void 0?Vn:Bu(Gn.call(t.grouping,Number),t.thousands+""),r=t.currency===void 0?"":t.currency[0]+"",n=t.currency===void 0?"":t.currency[1]+"",s=t.decimal===void 0?".":t.decimal+"",i=t.numerals===void 0?Vn:Hu(Gn.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",a=t.minus===void 0?"−":t.minus+"",l=t.nan===void 0?"NaN":t.nan+"";function u(h){h=Gr(h);var d=h.fill,f=h.align,g=h.sign,y=h.symbol,v=h.zero,x=h.width,P=h.comma,_=h.precision,m=h.trim,k=h.type;k==="n"?(P=!0,k="g"):Kn[k]||(_===void 0&&(_=12),m=!0,k="g"),(v||d==="0"&&f==="=")&&(v=!0,d="0",f="=");var E=y==="$"?r:y==="#"&&/[boxX]/.test(k)?"0"+k.toLowerCase():"",O=y==="$"?n:/[%p]/.test(k)?o:"",D=Kn[k],ae=/[defgprs%]/.test(k);_=_===void 0?6:/[gprs]/.test(k)?Math.max(1,Math.min(21,_)):Math.max(0,Math.min(20,_));function me(S){var X=E,B=O,le,Q,be;if(k==="c")B=D(S)+B,S="";else{S=+S;var ze=S<0||1/S<0;if(S=isNaN(S)?l:D(Math.abs(S),_),m&&(S=zu(S)),ze&&+S==0&&g!=="+"&&(ze=!1),X=(ze?g==="("?g:a:g==="-"||g==="("?"":g)+X,B=(k==="s"?Jn[8+li/3]:"")+B+(ze&&g==="("?")":""),ae){for(le=-1,Q=S.length;++le<Q;)if(be=S.charCodeAt(le),48>be||be>57){B=(be===46?s+S.slice(le+1):S.slice(le))+B,S=S.slice(0,le);break}}}P&&!v&&(S=e(S,1/0));var Ke=X.length+S.length+B.length,ee=Ke<x?new Array(x-Ke+1).join(d):"";switch(P&&v&&(S=e(ee+S,ee.length?x-B.length:1/0),ee=""),f){case"<":S=X+S+B+ee;break;case"=":S=X+ee+S+B;break;case"^":S=ee.slice(0,Ke=ee.length>>1)+X+S+B+ee.slice(Ke);break;default:S=ee+X+S+B;break}return i(S)}return me.toString=function(){return h+""},me}function c(h,d){var f=u((h=Gr(h),h.type="f",h)),g=Math.max(-8,Math.min(8,Math.floor(qu(d)/3)))*3,y=Math.pow(10,-g),v=Jn[8+g/3];return function(x){return f(y*x)+v}}return{format:u,formatPrefix:c}}var Vt,ui;Gu({thousands:",",grouping:[3],currency:["$",""]});function Gu(t){return Vt=Vu(t),ui=Vt.format,Vt.formatPrefix,Vt}const Cr=new Date,Er=new Date;function fe(t,e,r,n){function s(i){return t(i=arguments.length===0?new Date:new Date(+i)),i}return s.floor=i=>(t(i=new Date(+i)),i),s.ceil=i=>(t(i=new Date(i-1)),e(i,1),t(i),i),s.round=i=>{const o=s(i),a=s.ceil(i);return i-o<a-i?o:a},s.offset=(i,o)=>(e(i=new Date(+i),o==null?1:Math.floor(o)),i),s.range=(i,o,a)=>{const l=[];if(i=s.ceil(i),a=a==null?1:Math.floor(a),!(i<o)||!(a>0))return l;let u;do l.push(u=new Date(+i)),e(i,a),t(i);while(u<i&&i<o);return l},s.filter=i=>fe(o=>{if(o>=o)for(;t(o),!i(o);)o.setTime(o-1)},(o,a)=>{if(o>=o)if(a<0)for(;++a<=0;)for(;e(o,-1),!i(o););else for(;--a>=0;)for(;e(o,1),!i(o););}),r&&(s.count=(i,o)=>(Cr.setTime(+i),Er.setTime(+o),t(Cr),t(Er),Math.floor(r(Cr,Er))),s.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?s.filter(n?o=>n(o)%i===0:o=>s.count(0,o)%i===0):s)),s}const Ju=1e3,fn=Ju*60,Yu=fn*60,Rt=Yu*24,ci=Rt*7,gn=fe(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*fn)/Rt,t=>t.getDate()-1);gn.range;const pn=fe(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Rt,t=>t.getUTCDate()-1);pn.range;const Zu=fe(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Rt,t=>Math.floor(t/Rt));Zu.range;function Be(t){return fe(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,r)=>{e.setDate(e.getDate()+r*7)},(e,r)=>(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*fn)/ci)}const hi=Be(0),ur=Be(1),Xu=Be(2),Qu=Be(3),ct=Be(4),ec=Be(5),tc=Be(6);hi.range;ur.range;Xu.range;Qu.range;ct.range;ec.range;tc.range;function He(t){return fe(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCDate(e.getUTCDate()+r*7)},(e,r)=>(r-e)/ci)}const di=He(0),cr=He(1),rc=He(2),nc=He(3),ht=He(4),sc=He(5),ic=He(6);di.range;cr.range;rc.range;nc.range;ht.range;sc.range;ic.range;const Fe=fe(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());Fe.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:fe(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,r)=>{e.setFullYear(e.getFullYear()+r*t)});Fe.range;const qe=fe(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());qe.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:fe(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCFullYear(e.getUTCFullYear()+r*t)});qe.range;function Ar(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function $r(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function pt(t,e,r){return{y:t,m:e,d:r,H:0,M:0,S:0,L:0}}function oc(t){var e=t.dateTime,r=t.date,n=t.time,s=t.periods,i=t.days,o=t.shortDays,a=t.months,l=t.shortMonths,u=_t(s),c=vt(s),h=_t(i),d=vt(i),f=_t(o),g=vt(o),y=_t(a),v=vt(a),x=_t(l),P=vt(l),_={a:ze,A:Ke,b:ee,B:Di,c:null,d:ts,e:ts,f:$c,g:Nc,G:qc,H:Cc,I:Ec,j:Ac,L:fi,m:Oc,M:Pc,p:Li,q:Ni,Q:ss,s:is,S:jc,u:Rc,U:Uc,V:Ic,w:Mc,W:Dc,x:null,X:null,y:Lc,Y:Fc,Z:Bc,"%":ns},m={a:Fi,A:qi,b:Bi,B:Hi,c:null,d:rs,e:rs,f:Kc,g:rh,G:sh,H:Hc,I:Wc,j:zc,L:pi,m:Vc,M:Gc,p:Wi,q:zi,Q:ss,s:is,S:Jc,u:Yc,U:Zc,V:Xc,w:Qc,W:eh,x:null,X:null,y:th,Y:nh,Z:ih,"%":ns},k={a:me,A:S,b:X,B,c:le,d:Qn,e:Qn,f:kc,g:Xn,G:Zn,H:es,I:es,j:yc,L:bc,m:vc,M:wc,p:ae,q:_c,Q:Sc,s:Tc,S:mc,u:hc,U:dc,V:fc,w:cc,W:gc,x:Q,X:be,y:Xn,Y:Zn,Z:pc,"%":xc};_.x=E(r,_),_.X=E(n,_),_.c=E(e,_),m.x=E(r,m),m.X=E(n,m),m.c=E(e,m);function E(w,C){return function(A){var p=[],V=-1,j=0,Y=w.length,Z,Pe,bn;for(A instanceof Date||(A=new Date(+A));++V<Y;)w.charCodeAt(V)===37&&(p.push(w.slice(j,V)),(Pe=Yn[Z=w.charAt(++V)])!=null?Z=w.charAt(++V):Pe=Z==="e"?" ":"0",(bn=C[Z])&&(Z=bn(A,Pe)),p.push(Z),j=V+1);return p.push(w.slice(j,V)),p.join("")}}function O(w,C){return function(A){var p=pt(1900,void 0,1),V=D(p,w,A+="",0),j,Y;if(V!=A.length)return null;if("Q"in p)return new Date(p.Q);if("s"in p)return new Date(p.s*1e3+("L"in p?p.L:0));if(C&&!("Z"in p)&&(p.Z=0),"p"in p&&(p.H=p.H%12+p.p*12),p.m===void 0&&(p.m="q"in p?p.q:0),"V"in p){if(p.V<1||p.V>53)return null;"w"in p||(p.w=1),"Z"in p?(j=$r(pt(p.y,0,1)),Y=j.getUTCDay(),j=Y>4||Y===0?cr.ceil(j):cr(j),j=pn.offset(j,(p.V-1)*7),p.y=j.getUTCFullYear(),p.m=j.getUTCMonth(),p.d=j.getUTCDate()+(p.w+6)%7):(j=Ar(pt(p.y,0,1)),Y=j.getDay(),j=Y>4||Y===0?ur.ceil(j):ur(j),j=gn.offset(j,(p.V-1)*7),p.y=j.getFullYear(),p.m=j.getMonth(),p.d=j.getDate()+(p.w+6)%7)}else("W"in p||"U"in p)&&("w"in p||(p.w="u"in p?p.u%7:"W"in p?1:0),Y="Z"in p?$r(pt(p.y,0,1)).getUTCDay():Ar(pt(p.y,0,1)).getDay(),p.m=0,p.d="W"in p?(p.w+6)%7+p.W*7-(Y+5)%7:p.w+p.U*7-(Y+6)%7);return"Z"in p?(p.H+=p.Z/100|0,p.M+=p.Z%100,$r(p)):Ar(p)}}function D(w,C,A,p){for(var V=0,j=C.length,Y=A.length,Z,Pe;V<j;){if(p>=Y)return-1;if(Z=C.charCodeAt(V++),Z===37){if(Z=C.charAt(V++),Pe=k[Z in Yn?C.charAt(V++):Z],!Pe||(p=Pe(w,A,p))<0)return-1}else if(Z!=A.charCodeAt(p++))return-1}return p}function ae(w,C,A){var p=u.exec(C.slice(A));return p?(w.p=c.get(p[0].toLowerCase()),A+p[0].length):-1}function me(w,C,A){var p=f.exec(C.slice(A));return p?(w.w=g.get(p[0].toLowerCase()),A+p[0].length):-1}function S(w,C,A){var p=h.exec(C.slice(A));return p?(w.w=d.get(p[0].toLowerCase()),A+p[0].length):-1}function X(w,C,A){var p=x.exec(C.slice(A));return p?(w.m=P.get(p[0].toLowerCase()),A+p[0].length):-1}function B(w,C,A){var p=y.exec(C.slice(A));return p?(w.m=v.get(p[0].toLowerCase()),A+p[0].length):-1}function le(w,C,A){return D(w,e,C,A)}function Q(w,C,A){return D(w,r,C,A)}function be(w,C,A){return D(w,n,C,A)}function ze(w){return o[w.getDay()]}function Ke(w){return i[w.getDay()]}function ee(w){return l[w.getMonth()]}function Di(w){return a[w.getMonth()]}function Li(w){return s[+(w.getHours()>=12)]}function Ni(w){return 1+~~(w.getMonth()/3)}function Fi(w){return o[w.getUTCDay()]}function qi(w){return i[w.getUTCDay()]}function Bi(w){return l[w.getUTCMonth()]}function Hi(w){return a[w.getUTCMonth()]}function Wi(w){return s[+(w.getUTCHours()>=12)]}function zi(w){return 1+~~(w.getUTCMonth()/3)}return{format:function(w){var C=E(w+="",_);return C.toString=function(){return w},C},parse:function(w){var C=O(w+="",!1);return C.toString=function(){return w},C},utcFormat:function(w){var C=E(w+="",m);return C.toString=function(){return w},C},utcParse:function(w){var C=O(w+="",!0);return C.toString=function(){return w},C}}}var Yn={"-":"",_:" ",0:"0"},q=/^\s*\d+/,ac=/^%/,lc=/[\\^$*+?|[\]().{}]/g;function $(t,e,r){var n=t<0?"-":"",s=(n?-t:t)+"",i=s.length;return n+(i<r?new Array(r-i+1).join(e)+s:s)}function uc(t){return t.replace(lc,"\\$&")}function _t(t){return new RegExp("^(?:"+t.map(uc).join("|")+")","i")}function vt(t){return new Map(t.map((e,r)=>[e.toLowerCase(),r]))}function cc(t,e,r){var n=q.exec(e.slice(r,r+1));return n?(t.w=+n[0],r+n[0].length):-1}function hc(t,e,r){var n=q.exec(e.slice(r,r+1));return n?(t.u=+n[0],r+n[0].length):-1}function dc(t,e,r){var n=q.exec(e.slice(r,r+2));return n?(t.U=+n[0],r+n[0].length):-1}function fc(t,e,r){var n=q.exec(e.slice(r,r+2));return n?(t.V=+n[0],r+n[0].length):-1}function gc(t,e,r){var n=q.exec(e.slice(r,r+2));return n?(t.W=+n[0],r+n[0].length):-1}function Zn(t,e,r){var n=q.exec(e.slice(r,r+4));return n?(t.y=+n[0],r+n[0].length):-1}function Xn(t,e,r){var n=q.exec(e.slice(r,r+2));return n?(t.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function pc(t,e,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(r,r+6));return n?(t.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function _c(t,e,r){var n=q.exec(e.slice(r,r+1));return n?(t.q=n[0]*3-3,r+n[0].length):-1}function vc(t,e,r){var n=q.exec(e.slice(r,r+2));return n?(t.m=n[0]-1,r+n[0].length):-1}function Qn(t,e,r){var n=q.exec(e.slice(r,r+2));return n?(t.d=+n[0],r+n[0].length):-1}function yc(t,e,r){var n=q.exec(e.slice(r,r+3));return n?(t.m=0,t.d=+n[0],r+n[0].length):-1}function es(t,e,r){var n=q.exec(e.slice(r,r+2));return n?(t.H=+n[0],r+n[0].length):-1}function wc(t,e,r){var n=q.exec(e.slice(r,r+2));return n?(t.M=+n[0],r+n[0].length):-1}function mc(t,e,r){var n=q.exec(e.slice(r,r+2));return n?(t.S=+n[0],r+n[0].length):-1}function bc(t,e,r){var n=q.exec(e.slice(r,r+3));return n?(t.L=+n[0],r+n[0].length):-1}function kc(t,e,r){var n=q.exec(e.slice(r,r+6));return n?(t.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function xc(t,e,r){var n=ac.exec(e.slice(r,r+1));return n?r+n[0].length:-1}function Sc(t,e,r){var n=q.exec(e.slice(r));return n?(t.Q=+n[0],r+n[0].length):-1}function Tc(t,e,r){var n=q.exec(e.slice(r));return n?(t.s=+n[0],r+n[0].length):-1}function ts(t,e){return $(t.getDate(),e,2)}function Cc(t,e){return $(t.getHours(),e,2)}function Ec(t,e){return $(t.getHours()%12||12,e,2)}function Ac(t,e){return $(1+gn.count(Fe(t),t),e,3)}function fi(t,e){return $(t.getMilliseconds(),e,3)}function $c(t,e){return fi(t,e)+"000"}function Oc(t,e){return $(t.getMonth()+1,e,2)}function Pc(t,e){return $(t.getMinutes(),e,2)}function jc(t,e){return $(t.getSeconds(),e,2)}function Rc(t){var e=t.getDay();return e===0?7:e}function Uc(t,e){return $(hi.count(Fe(t)-1,t),e,2)}function gi(t){var e=t.getDay();return e>=4||e===0?ct(t):ct.ceil(t)}function Ic(t,e){return t=gi(t),$(ct.count(Fe(t),t)+(Fe(t).getDay()===4),e,2)}function Mc(t){return t.getDay()}function Dc(t,e){return $(ur.count(Fe(t)-1,t),e,2)}function Lc(t,e){return $(t.getFullYear()%100,e,2)}function Nc(t,e){return t=gi(t),$(t.getFullYear()%100,e,2)}function Fc(t,e){return $(t.getFullYear()%1e4,e,4)}function qc(t,e){var r=t.getDay();return t=r>=4||r===0?ct(t):ct.ceil(t),$(t.getFullYear()%1e4,e,4)}function Bc(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+$(e/60|0,"0",2)+$(e%60,"0",2)}function rs(t,e){return $(t.getUTCDate(),e,2)}function Hc(t,e){return $(t.getUTCHours(),e,2)}function Wc(t,e){return $(t.getUTCHours()%12||12,e,2)}function zc(t,e){return $(1+pn.count(qe(t),t),e,3)}function pi(t,e){return $(t.getUTCMilliseconds(),e,3)}function Kc(t,e){return pi(t,e)+"000"}function Vc(t,e){return $(t.getUTCMonth()+1,e,2)}function Gc(t,e){return $(t.getUTCMinutes(),e,2)}function Jc(t,e){return $(t.getUTCSeconds(),e,2)}function Yc(t){var e=t.getUTCDay();return e===0?7:e}function Zc(t,e){return $(di.count(qe(t)-1,t),e,2)}function _i(t){var e=t.getUTCDay();return e>=4||e===0?ht(t):ht.ceil(t)}function Xc(t,e){return t=_i(t),$(ht.count(qe(t),t)+(qe(t).getUTCDay()===4),e,2)}function Qc(t){return t.getUTCDay()}function eh(t,e){return $(cr.count(qe(t)-1,t),e,2)}function th(t,e){return $(t.getUTCFullYear()%100,e,2)}function rh(t,e){return t=_i(t),$(t.getUTCFullYear()%100,e,2)}function nh(t,e){return $(t.getUTCFullYear()%1e4,e,4)}function sh(t,e){var r=t.getUTCDay();return t=r>=4||r===0?ht(t):ht.ceil(t),$(t.getUTCFullYear()%1e4,e,4)}function ih(){return"+0000"}function ns(){return"%"}function ss(t){return+t}function is(t){return Math.floor(+t/1e3)}var Ve,vi;oh({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function oh(t){return Ve=oc(t),vi=Ve.format,Ve.parse,Ve.utcFormat,Ve.utcParse,Ve}function kt(t,e,r){this.k=t,this.x=e,this.y=r}kt.prototype={constructor:kt,scale:function(t){return t===1?this:new kt(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new kt(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};kt.prototype;const ah=`<svg width="111" height="147" viewBox="0 0 111 147" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M93.4955 101.5C94.9955 89 107.104 92.5174 105.995 100.548C103.495 118.653 103.495 118.653 100.495 142" stroke="black" stroke-width="8" stroke-linecap="round"/>
<path d="M93.4955 101.5C94.9955 89 107.104 92.5174 105.995 100.548C103.495 118.653 103.495 118.653 100.495 142" stroke="#B3774D" stroke-width="4" stroke-linecap="round"/>
<path d="M47.4385 47.2939C51.2935 59.3736 52.1658 67.2028 46.0258 67.9447C36.7817 77.368 36.6603 70.2979 28.7891 56.7132C20.2989 40.0275 23.4288 30.8565 29.4877 28.9229C35.5467 26.9893 43.5836 35.2143 47.4385 47.2939Z" fill="#B3E6DD"/>
<path d="M50.7396 66.5201C49.9572 58.0234 46.1976 39.2432 37.4186 32.0955C26.4448 23.161 22.9231 36.3505 22.9661 38.8501C23.0875 45.9201 25.9488 51.0871 27.5496 54.5422C29.5325 58.8221 35.793 67.8376 38.2716 73.5235" stroke="black" stroke-width="2"/>
<path d="M46.736 66.7989C44.7955 59.5008 39.8606 43.6639 35.6453 38.7009" stroke="black" stroke-linecap="round"/>
<path d="M28.1882 44.6328C37.1299 53.6229 41.4783 60.1917 36.3532 63.6534C32.4269 76.2563 29.093 70.0205 15.8907 61.5235C0.722637 50.5495 -0.676574 40.9607 3.83277 36.4757C8.3421 31.9906 19.2464 35.6427 28.1882 44.6328Z" fill="#B3E6DD"/>
<path d="M39.8978 60.2349C35.3249 53.0312 23.4107 38.035 12.3375 35.6803C-1.50393 32.7368 1.38017 46.0802 2.55885 48.2849C5.89267 54.5207 10.7963 57.8131 13.7972 60.1572C17.5145 63.0609 27.1987 68.2269 31.9985 72.1555" stroke="black" stroke-width="2"/>
<path d="M36.1822 63.1835C31.1256 57.5748 19.5085 45.7339 13.4931 43.241" stroke="black" stroke-linecap="round"/>
<path d="M94.9362 88.187C93.9085 85.1964 91.2111 82.2213 87.8706 77.852L89.7169 72.0347C94.062 76.8948 98.8157 87.96 98.8157 87.96C98.8157 87.96 104.54 88.6428 102.273 92.2397C100.006 95.8366 95.5221 89.8919 94.9362 88.187Z" fill="black" stroke="black" stroke-width="2"/>
<mask id="path-10-outside-1_59_36" maskUnits="userSpaceOnUse" x="14.9955" y="110.5" width="20" height="20" fill="black">
<rect fill="white" x="14.9955" y="110.5" width="20" height="20"/>
<path d="M16.9955 128C21.4955 123 22.4955 121 23.9955 114.5L31.9955 122C31.2915 122.657 25.9955 127.5 16.9955 128Z"/>
</mask>
<path d="M16.9955 128C21.4955 123 22.4955 121 23.9955 114.5L31.9955 122C31.2915 122.657 25.9955 127.5 16.9955 128Z" fill="black"/>
<path d="M23.9955 114.5L25.3634 113.041L22.8282 110.664L22.0467 114.05L23.9955 114.5ZM16.9955 128L15.5089 126.662C14.9671 127.264 14.8419 128.134 15.1918 128.864C15.5417 129.595 16.2977 130.042 17.1065 129.997L16.9955 128ZM31.9955 122L33.3601 123.462L34.9232 122.003L33.3634 120.541L31.9955 122ZM23.9955 114.5L22.0467 114.05C21.3031 117.273 20.7222 119.192 19.8433 120.895C18.9656 122.596 17.7338 124.19 15.5089 126.662L16.9955 128L18.4821 129.338C20.7573 126.81 22.2754 124.904 23.3978 122.73C24.5188 120.558 25.1879 118.227 25.9443 114.95L23.9955 114.5ZM16.9955 128L17.1065 129.997C26.7916 129.459 32.5167 124.249 33.3601 123.462L31.9955 122L30.6309 120.538C30.0663 121.065 25.1995 125.541 16.8846 126.003L16.9955 128ZM31.9955 122L33.3634 120.541L25.3634 113.041L23.9955 114.5L22.6276 115.959L30.6276 123.459L31.9955 122Z" fill="black" mask="url(#path-10-outside-1_59_36)"/>
<path d="M41.0105 142C42.0105 139 46.5109 131 46.5109 125.5L52.0109 125C52.0109 131 49.5105 137.5 49.5105 137.5C49.5105 137.5 58.0109 138.5 57.0105 144C56.3117 147.842 40.4404 143.71 41.0105 142Z" fill="black" stroke="black" stroke-width="2"/>
<path d="M59.2179 134.941C59.8207 131.836 63.2464 123.321 62.5337 117.867L67.9225 116.658C68.7001 122.608 67.063 129.377 67.063 129.377C67.063 129.377 75.6214 129.267 75.3421 134.85C75.1471 138.75 58.8742 136.71 59.2179 134.941Z" fill="black" stroke="black" stroke-width="2"/>
<path d="M80.4713 56.8718C86.9758 62.1833 90.1081 70.4771 89.8197 79.6912C89.5311 88.9068 85.8145 98.985 78.693 107.706C71.5716 116.428 62.44 122.084 53.4682 124.21C44.4978 126.335 35.7452 124.924 29.2405 119.613C22.7357 114.301 19.6028 106.007 19.8913 96.7927C20.1799 87.5771 23.8965 77.4989 31.0179 68.7775C38.1394 60.056 47.271 54.3994 56.2428 52.2741C65.2134 50.1492 73.9665 51.5604 80.4713 56.8718Z" fill="#F5C73D" stroke="black" stroke-width="2"/>
<mask id="mask0_59_36" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="18" y="50" width="73" height="77">
<path d="M80.4713 56.8718C86.9758 62.1833 90.1081 70.4771 89.8197 79.6912C89.5311 88.9068 85.8145 98.985 78.693 107.706C71.5716 116.428 62.44 122.084 53.4682 124.21C44.4978 126.335 35.7452 124.924 29.2405 119.613C22.7357 114.301 19.6028 106.007 19.8913 96.7927C20.1799 87.5771 23.8965 77.4989 31.0179 68.7775C38.1394 60.056 47.271 54.3994 56.2428 52.2741C65.2134 50.1492 73.9665 51.5604 80.4713 56.8718Z" fill="#F5C73D" stroke="black" stroke-width="2"/>
</mask>
<g mask="url(#mask0_59_36)">
<path d="M78.9955 114.787C48.7975 117.49 24.6391 93.839 17.9955 81" stroke="black" stroke-width="9"/>
<path d="M87.9955 92.8119C58.2925 95.1968 34.5302 74.3285 27.9955 63" stroke="black" stroke-width="9"/>
<path d="M90.9955 71.8863C66.1723 73.2282 51.9566 58.3739 46.4955 52" stroke="black" stroke-width="9"/>
</g>
<rect x="54.1974" y="74.5697" width="18.1563" height="23.7027" transform="rotate(25.1377 54.1974 74.5697)" fill="#40BFAA"/>
<path d="M70 81.5L73.9955 81.5L62.9955 103L59.4955 103.5L70 81.5Z" fill="#40BFAA"/>
<path d="M54.3596 74.2242L69.9955 81.5L74.9955 80L55.6892 71.3907L54.3596 74.2242Z" fill="white"/>
<path d="M75.4955 80C75.9955 80 55.4955 70.5 55.4955 70.5L52.9955 73.5C56.4955 75 68.9955 81 69.9955 81.5C70.9955 82 74.9955 80 75.4955 80Z" stroke="black" stroke-width="2"/>
<path d="M75.4955 80L63.9955 103C63.4955 103.5 61.4954 104 59.9955 103.886C59.3294 103.835 48.9955 98.1739 43.9955 95.5584L45.4955 92.5" stroke="black" stroke-width="2" stroke-linecap="round"/>
<path d="M69.4955 82L58.9955 104" stroke="black"/>
<circle cx="75.9955" cy="47" r="23" fill="#F5C73D" stroke="black" stroke-width="2"/>
<ellipse cx="75.4955" cy="45.5" rx="2.5" ry="3.5" fill="black"/>
<ellipse cx="93.4955" cy="44.5" rx="2.5" ry="3.5" fill="black"/>
<path d="M74.9955 36C79.3635 36 82.9955 39.7539 82.9955 44.5C82.9955 49.2461 79.3635 53 74.9955 53C70.6275 53 66.9955 49.2461 66.9955 44.5C66.9955 39.7539 70.6275 36 74.9955 36Z" stroke="black" stroke-width="2"/>
<path d="M95.4955 35C99.536 35 102.996 38.6981 102.996 43.5C102.996 48.3019 99.536 52 95.4955 52C91.4551 52 87.9955 48.3019 87.9955 43.5C87.9955 38.6981 91.4551 35 95.4955 35Z" stroke="black" stroke-width="2"/>
<path d="M83.4955 44C85.1349 43.2375 86.104 43.1334 87.9955 44" stroke="black" stroke-width="2"/>
<line x1="66.8299" y1="43.4908" x2="57.8299" y2="42.4908" stroke="black" stroke-width="3"/>
<path d="M78.9955 56.5C82.4955 60 87.9955 61 91.4955 55.5" stroke="black" stroke-width="2"/>
<path d="M59.4955 1C66.4729 1 71.9955 6.2198 71.9955 12.5C71.9955 18.7802 66.4729 24 59.4955 24C52.5181 24 46.9955 18.7802 46.9955 12.5C46.9955 6.2198 52.5181 1 59.4955 1Z" fill="#F0E9DB" stroke="black" stroke-width="2"/>
<path d="M61.4955 18C61.9955 14.5 61.4955 10 57.4955 8" stroke="black" stroke-linecap="round"/>
<path d="M66.4955 17C67.9955 14 67.9955 9.5 63.9955 7.5M57.4955 19.5C56.1622 18.6667 53.2955 16.2 52.4955 13" stroke="black" stroke-linecap="round"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M62.9955 35.5C61.4955 38 60.707 39 58.6245 41.7551C57.3056 43.5 55.4955 45 52.4955 48C49.9955 48 43.0115 37.5405 52.4955 24.5C56.4955 19 65.4955 16 72.9955 17.5C76.4535 18.1916 77.8059 19.2911 78.9392 20.2126C79.5808 20.7342 80.1521 21.1988 80.9955 21.5C91.9955 19.5 96.9955 22.5 95.9955 34.5C94.4955 34.5 89.4955 33 86.9955 31.5C84.4955 30 80.968 25.8128 80.4955 26.5C74.9955 34.5 63.5955 34.5 62.9955 35.5Z" fill="#F0E9DB" stroke="black" stroke-width="2"/>
<path d="M75.9955 26C74.1622 28 68.7955 31.6 61.9955 30" stroke="black" stroke-linecap="round"/>
<path d="M59.8362 98.5997C57.3837 96.5147 48.8751 93.6018 43.6783 91.8008C40.123 87.4647 45.1612 81.4074 45.8252 77.9343C47.1505 74.8098 51.604 65.5639 54.4955 64.5C57.387 63.4361 59.4133 65.6107 59.8362 67.5C58.0708 69.1182 52.671 77.0136 51.3462 79.3738C50.0213 81.7339 49.4019 85.3752 48.4655 86.972C54.7982 88.5491 63.1225 95.7619 63.1225 95.7619C63.1225 95.7619 68.4992 92.5212 68.3751 97.4006C68.2511 102.28 61.2343 99.7883 59.8362 98.5997Z" fill="black" stroke="black" stroke-width="2"/>
</svg>
`;var lh=we('<div class="c svelte-1p46tck"><div class="logo svelte-1p46tck"><!></div> <h1 class="svelte-1p46tck">Opening Line Database</h1> <p class="tagline svelte-1p46tck">A searchable database of opening lines from fiction</p> <p><strong> </strong> </p></div>');function uh(t,e){fr(e,!0);let r=Te("over 10,000"),n=Te("since August 1, 2025"),s=Te(!1);Is(async()=>{const f=await fetch(`https://pudding.cool/projects/oldb-data/latest.json?version=${Date.now()}`);if(f.ok){const g=await f.json();K(r,ui(",")(g.count),!0),K(n,`as of ${vi("%B %d, %Y")(new Date(g.updated))}`)}else console.error("Failed to fetch the latest data");K(s,!0)});var i=lh(),o=F(i),a=F(o);mo(a,()=>ah),M(o);var l=z(o,6);let u;var c=F(l),h=F(c,!0);M(c);var d=z(c);M(l),M(i),Et(f=>{u=co(l,1,"meta svelte-1p46tck",null,u,f),At(h,I(r)),At(d,` books ${I(n)??""}`)},[()=>({ready:I(s)})]),se(t,i),gr()}function ch(t,e){fr(e,!0);/**
 * @license @lucide/svelte v0.525.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */let r=yo(e,["$$slots","$$events","$$legacy"]);const n=[["circle",{cx:"6",cy:"15",r:"4"}],["circle",{cx:"18",cy:"15",r:"4"}],["path",{d:"M14 15a2 2 0 0 0-2-2 2 2 0 0 0-2 2"}],["path",{d:"M2.5 13 5 7c.7-1.3 1.4-2 3-2"}],["path",{d:"M21.5 13 19 7c-.7-1.3-1.5-2-3-2"}]];ho(t,vo({name:"glasses"},()=>r,{get iconNode(){return n},children:(s,i)=>{var o=Ms(),a=pr(o);ao(a,()=>e.children??lo),se(s,o)},$$slots:{default:!0}})),gr()}var hh=we('<div id="lotd" class="c svelte-1uekz17"><p class="overline svelte-1uekz17"><span>Line of the Day from <strong>1984 by George Orwell</strong></span> <button><span><!></span></button></p> <blockquote class="svelte-1uekz17">It was a bright cold day in April, and the clocks were striking thirteen.</blockquote> <p><a href="#">see more details</a></p></div>');function dh(t){var e=hh(),r=F(e),n=z(F(r),2),s=F(n),i=F(s);ch(i,{}),M(s),M(n),M(r),Us(4),M(e),se(t,e)}const fh=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>Lt(async()=>{const{default:n}=await Promise.resolve().then(()=>ft);return{default:n}},void 0,import.meta.url).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)};class _n extends Error{constructor(e,r="FunctionsError",n){super(e),this.name=r,this.context=n}}class gh extends _n{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class os extends _n{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class as extends _n{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Jr;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Jr||(Jr={}));var ph=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?i(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};class _h{constructor(e,{headers:r={},customFetch:n,region:s=Jr.Any}={}){this.url=e,this.headers=r,this.region=s,this.fetch=fh(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,r={}){var n;return ph(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:o}=r;let a={},{region:l}=r;l||(l=this.region);const u=new URL(`${this.url}/${e}`);l&&l!=="any"&&(a["x-region"]=l,u.searchParams.set("forceFunctionRegion",l));let c;o&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",c=o):typeof o=="string"?(a["Content-Type"]="text/plain",c=o):typeof FormData<"u"&&o instanceof FormData?c=o:(a["Content-Type"]="application/json",c=JSON.stringify(o)));const h=yield this.fetch(u.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),s),body:c}).catch(y=>{throw new gh(y)}),d=h.headers.get("x-relay-error");if(d&&d==="true")throw new os(h);if(!h.ok)throw new as(h);let f=((n=h.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),g;return f==="application/json"?g=yield h.json():f==="application/octet-stream"?g=yield h.blob():f==="text/event-stream"?g=h:f==="multipart/form-data"?g=yield h.formData():g=yield h.text(),{data:g,error:null,response:h}}catch(s){return{data:null,error:s,response:s instanceof as||s instanceof os?s.context:void 0}}})}}function vh(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function yh(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var r=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var s=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return t[n]}})}),r}var L={},Ge={},Je={},Ye={},Ze={},Xe={},wh=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},dt=wh();const mh=dt.fetch,yi=dt.fetch.bind(dt),wi=dt.Headers,bh=dt.Request,kh=dt.Response,ft=Object.freeze(Object.defineProperty({__proto__:null,Headers:wi,Request:bh,Response:kh,default:yi,fetch:mh},Symbol.toStringTag,{value:"Module"})),xh=yh(ft);var Gt={},ls;function mi(){if(ls)return Gt;ls=1,Object.defineProperty(Gt,"__esModule",{value:!0});class t extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return Gt.default=t,Gt}var us;function bi(){if(us)return Xe;us=1;var t=Xe&&Xe.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Xe,"__esModule",{value:!0});const e=t(xh),r=t(mi());class n{constructor(i){this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=i.headers,this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=i.shouldThrowOnError,this.signal=i.signal,this.isMaybeSingle=i.isMaybeSingle,i.fetch?this.fetch=i.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,o){return this.headers=Object.assign({},this.headers),this.headers[i]=o,this}then(i,o){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const a=this.fetch;let l=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async u=>{var c,h,d;let f=null,g=null,y=null,v=u.status,x=u.statusText;if(u.ok){if(this.method!=="HEAD"){const k=await u.text();k===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?g=k:g=JSON.parse(k))}const _=(c=this.headers.Prefer)===null||c===void 0?void 0:c.match(/count=(exact|planned|estimated)/),m=(h=u.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");_&&m&&m.length>1&&(y=parseInt(m[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(g)&&(g.length>1?(f={code:"PGRST116",details:`Results contain ${g.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},g=null,y=null,v=406,x="Not Acceptable"):g.length===1?g=g[0]:g=null)}else{const _=await u.text();try{f=JSON.parse(_),Array.isArray(f)&&u.status===404&&(g=[],f=null,v=200,x="OK")}catch{u.status===404&&_===""?(v=204,x="No Content"):f={message:_}}if(f&&this.isMaybeSingle&&(!((d=f==null?void 0:f.details)===null||d===void 0)&&d.includes("0 rows"))&&(f=null,v=200,x="OK"),f&&this.shouldThrowOnError)throw new r.default(f)}return{error:f,data:g,count:y,status:v,statusText:x}});return this.shouldThrowOnError||(l=l.catch(u=>{var c,h,d;return{error:{message:`${(c=u==null?void 0:u.name)!==null&&c!==void 0?c:"FetchError"}: ${u==null?void 0:u.message}`,details:`${(h=u==null?void 0:u.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(d=u==null?void 0:u.code)!==null&&d!==void 0?d:""}`},data:null,count:null,status:0,statusText:""}})),l.then(i,o)}returns(){return this}overrideTypes(){return this}}return Xe.default=n,Xe}var cs;function ki(){if(cs)return Ze;cs=1;var t=Ze&&Ze.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ze,"__esModule",{value:!0});const e=t(bi());class r extends e.default{select(s){let i=!1;const o=(s??"*").split("").map(a=>/\s/.test(a)&&!i?"":(a==='"'&&(i=!i),a)).join("");return this.url.searchParams.set("select",o),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(s,{ascending:i=!0,nullsFirst:o,foreignTable:a,referencedTable:l=a}={}){const u=l?`${l}.order`:"order",c=this.url.searchParams.get(u);return this.url.searchParams.set(u,`${c?`${c},`:""}${s}.${i?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:i,referencedTable:o=i}={}){const a=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(a,`${s}`),this}range(s,i,{foreignTable:o,referencedTable:a=o}={}){const l=typeof a>"u"?"offset":`${a}.offset`,u=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(l,`${s}`),this.url.searchParams.set(u,`${i-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:s=!1,verbose:i=!1,settings:o=!1,buffers:a=!1,wal:l=!1,format:u="text"}={}){var c;const h=[s?"analyze":null,i?"verbose":null,o?"settings":null,a?"buffers":null,l?"wal":null].filter(Boolean).join("|"),d=(c=this.headers.Accept)!==null&&c!==void 0?c:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${u}; for="${d}"; options=${h};`,u==="json"?this:this}rollback(){var s;return((s=this.headers.Prefer)!==null&&s!==void 0?s:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return Ze.default=r,Ze}var hs;function vn(){if(hs)return Ye;hs=1;var t=Ye&&Ye.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ye,"__esModule",{value:!0});const e=t(ki());class r extends e.default{eq(s,i){return this.url.searchParams.append(s,`eq.${i}`),this}neq(s,i){return this.url.searchParams.append(s,`neq.${i}`),this}gt(s,i){return this.url.searchParams.append(s,`gt.${i}`),this}gte(s,i){return this.url.searchParams.append(s,`gte.${i}`),this}lt(s,i){return this.url.searchParams.append(s,`lt.${i}`),this}lte(s,i){return this.url.searchParams.append(s,`lte.${i}`),this}like(s,i){return this.url.searchParams.append(s,`like.${i}`),this}likeAllOf(s,i){return this.url.searchParams.append(s,`like(all).{${i.join(",")}}`),this}likeAnyOf(s,i){return this.url.searchParams.append(s,`like(any).{${i.join(",")}}`),this}ilike(s,i){return this.url.searchParams.append(s,`ilike.${i}`),this}ilikeAllOf(s,i){return this.url.searchParams.append(s,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(s,i){return this.url.searchParams.append(s,`ilike(any).{${i.join(",")}}`),this}is(s,i){return this.url.searchParams.append(s,`is.${i}`),this}in(s,i){const o=Array.from(new Set(i)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(s,`in.(${o})`),this}contains(s,i){return typeof i=="string"?this.url.searchParams.append(s,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(s,`cs.{${i.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(i)}`),this}containedBy(s,i){return typeof i=="string"?this.url.searchParams.append(s,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(s,`cd.{${i.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(i)}`),this}rangeGt(s,i){return this.url.searchParams.append(s,`sr.${i}`),this}rangeGte(s,i){return this.url.searchParams.append(s,`nxl.${i}`),this}rangeLt(s,i){return this.url.searchParams.append(s,`sl.${i}`),this}rangeLte(s,i){return this.url.searchParams.append(s,`nxr.${i}`),this}rangeAdjacent(s,i){return this.url.searchParams.append(s,`adj.${i}`),this}overlaps(s,i){return typeof i=="string"?this.url.searchParams.append(s,`ov.${i}`):this.url.searchParams.append(s,`ov.{${i.join(",")}}`),this}textSearch(s,i,{config:o,type:a}={}){let l="";a==="plain"?l="pl":a==="phrase"?l="ph":a==="websearch"&&(l="w");const u=o===void 0?"":`(${o})`;return this.url.searchParams.append(s,`${l}fts${u}.${i}`),this}match(s){return Object.entries(s).forEach(([i,o])=>{this.url.searchParams.append(i,`eq.${o}`)}),this}not(s,i,o){return this.url.searchParams.append(s,`not.${i}.${o}`),this}or(s,{foreignTable:i,referencedTable:o=i}={}){const a=o?`${o}.or`:"or";return this.url.searchParams.append(a,`(${s})`),this}filter(s,i,o){return this.url.searchParams.append(s,`${i}.${o}`),this}}return Ye.default=r,Ye}var ds;function xi(){if(ds)return Je;ds=1;var t=Je&&Je.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Je,"__esModule",{value:!0});const e=t(vn());class r{constructor(s,{headers:i={},schema:o,fetch:a}){this.url=s,this.headers=i,this.schema=o,this.fetch=a}select(s,{head:i=!1,count:o}={}){const a=i?"HEAD":"GET";let l=!1;const u=(s??"*").split("").map(c=>/\s/.test(c)&&!l?"":(c==='"'&&(l=!l),c)).join("");return this.url.searchParams.set("select",u),o&&(this.headers.Prefer=`count=${o}`),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(s,{count:i,defaultToNull:o=!0}={}){const a="POST",l=[];if(this.headers.Prefer&&l.push(this.headers.Prefer),i&&l.push(`count=${i}`),o||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(s)){const u=s.reduce((c,h)=>c.concat(Object.keys(h)),[]);if(u.length>0){const c=[...new Set(u)].map(h=>`"${h}"`);this.url.searchParams.set("columns",c.join(","))}}return new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:this.fetch,allowEmpty:!1})}upsert(s,{onConflict:i,ignoreDuplicates:o=!1,count:a,defaultToNull:l=!0}={}){const u="POST",c=[`resolution=${o?"ignore":"merge"}-duplicates`];if(i!==void 0&&this.url.searchParams.set("on_conflict",i),this.headers.Prefer&&c.push(this.headers.Prefer),a&&c.push(`count=${a}`),l||c.push("missing=default"),this.headers.Prefer=c.join(","),Array.isArray(s)){const h=s.reduce((d,f)=>d.concat(Object.keys(f)),[]);if(h.length>0){const d=[...new Set(h)].map(f=>`"${f}"`);this.url.searchParams.set("columns",d.join(","))}}return new e.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:this.fetch,allowEmpty:!1})}update(s,{count:i}={}){const o="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),i&&a.push(`count=${i}`),this.headers.Prefer=a.join(","),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:this.fetch,allowEmpty:!1})}delete({count:s}={}){const i="DELETE",o=[];return s&&o.push(`count=${s}`),this.headers.Prefer&&o.unshift(this.headers.Prefer),this.headers.Prefer=o.join(","),new e.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return Je.default=r,Je}var yt={},wt={},fs;function Sh(){return fs||(fs=1,Object.defineProperty(wt,"__esModule",{value:!0}),wt.version=void 0,wt.version="0.0.0-automated"),wt}var gs;function Th(){if(gs)return yt;gs=1,Object.defineProperty(yt,"__esModule",{value:!0}),yt.DEFAULT_HEADERS=void 0;const t=Sh();return yt.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${t.version}`},yt}var ps;function Ch(){if(ps)return Ge;ps=1;var t=Ge&&Ge.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Ge,"__esModule",{value:!0});const e=t(xi()),r=t(vn()),n=Th();class s{constructor(o,{headers:a={},schema:l,fetch:u}={}){this.url=o,this.headers=Object.assign(Object.assign({},n.DEFAULT_HEADERS),a),this.schemaName=l,this.fetch=u}from(o){const a=new URL(`${this.url}/${o}`);return new e.default(a,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(o){return new s(this.url,{headers:this.headers,schema:o,fetch:this.fetch})}rpc(o,a={},{head:l=!1,get:u=!1,count:c}={}){let h;const d=new URL(`${this.url}/rpc/${o}`);let f;l||u?(h=l?"HEAD":"GET",Object.entries(a).filter(([y,v])=>v!==void 0).map(([y,v])=>[y,Array.isArray(v)?`{${v.join(",")}}`:`${v}`]).forEach(([y,v])=>{d.searchParams.append(y,v)})):(h="POST",f=a);const g=Object.assign({},this.headers);return c&&(g.Prefer=`count=${c}`),new r.default({method:h,url:d,headers:g,schema:this.schemaName,body:f,fetch:this.fetch,allowEmpty:!1})}}return Ge.default=s,Ge}var _s;function Eh(){if(_s)return L;_s=1;var t=L&&L.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(L,"__esModule",{value:!0}),L.PostgrestError=L.PostgrestBuilder=L.PostgrestTransformBuilder=L.PostgrestFilterBuilder=L.PostgrestQueryBuilder=L.PostgrestClient=void 0;const e=t(Ch());L.PostgrestClient=e.default;const r=t(xi());L.PostgrestQueryBuilder=r.default;const n=t(vn());L.PostgrestFilterBuilder=n.default;const s=t(ki());L.PostgrestTransformBuilder=s.default;const i=t(bi());L.PostgrestBuilder=i.default;const o=t(mi());return L.PostgrestError=o.default,L.default={PostgrestClient:e.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:s.default,PostgrestBuilder:i.default,PostgrestError:o.default},L}var Ah=Eh();const $h=vh(Ah),{PostgrestClient:Oh,PostgrestQueryBuilder:Df,PostgrestFilterBuilder:Lf,PostgrestTransformBuilder:Nf,PostgrestBuilder:Ff,PostgrestError:qf}=$h;function Ph(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const jh=Ph(),Rh="2.11.15",Uh=`realtime-js/${Rh}`,Ih="1.0.0",Si=1e4,Mh=1e3;var Tt;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Tt||(Tt={}));var W;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(W||(W={}));var re;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(re||(re={}));var Yr;(function(t){t.websocket="websocket"})(Yr||(Yr={}));var Ie;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Ie||(Ie={}));class Dh{constructor(){this.HEADER_LENGTH=1}decode(e,r){return e.constructor===ArrayBuffer?r(this._binaryDecode(e)):r(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const r=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,r,n)}_decodeBroadcast(e,r,n){const s=r.getUint8(1),i=r.getUint8(2);let o=this.HEADER_LENGTH+2;const a=n.decode(e.slice(o,o+s));o=o+s;const l=n.decode(e.slice(o,o+i));o=o+i;const u=JSON.parse(n.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:l,payload:u}}}class Ti{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var R;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(R||(R={}));const vs=(t,e,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(e).reduce((i,o)=>(i[o]=Lh(o,t,e,s),i),{})},Lh=(t,e,r,n)=>{const s=e.find(a=>a.name===t),i=s==null?void 0:s.type,o=r[t];return i&&!n.includes(i)?Ci(i,o):Zr(o)},Ci=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return Bh(e,r)}switch(t){case R.bool:return Nh(e);case R.float4:case R.float8:case R.int2:case R.int4:case R.int8:case R.numeric:case R.oid:return Fh(e);case R.json:case R.jsonb:return qh(e);case R.timestamp:return Hh(e);case R.abstime:case R.date:case R.daterange:case R.int4range:case R.int8range:case R.money:case R.reltime:case R.text:case R.time:case R.timestamptz:case R.timetz:case R.tsrange:case R.tstzrange:return Zr(e);default:return Zr(e)}},Zr=t=>t,Nh=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},Fh=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},qh=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},Bh=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,n=t[r];if(t[0]==="{"&&n==="}"){let i;const o=t.slice(1,r);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(a=>Ci(e,a))}return t},Hh=t=>typeof t=="string"?t.replace(" ","T"):t,Ei=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class Or{constructor(e,r,n={},s=Si){this.channel=e,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var n;return this._hasReceived(e)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var ys;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(ys||(ys={}));class Ct{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ct.syncState(this.state,s,i,o),this.pendingDiffs.forEach(l=>{this.state=Ct.syncDiff(this.state,l,i,o)}),this.pendingDiffs=[],a()}),this.channel._on(n.diff,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Ct.syncDiff(this.state,s,i,o),a())}),this.onJoin((s,i,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:o})}),this.onLeave((s,i,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,n,s){const i=this.cloneDeep(e),o=this.transformState(r),a={},l={};return this.map(i,(u,c)=>{o[u]||(l[u]=c)}),this.map(o,(u,c)=>{const h=i[u];if(h){const d=c.map(v=>v.presence_ref),f=h.map(v=>v.presence_ref),g=c.filter(v=>f.indexOf(v.presence_ref)<0),y=h.filter(v=>d.indexOf(v.presence_ref)<0);g.length>0&&(a[u]=g),y.length>0&&(l[u]=y)}else a[u]=c}),this.syncDiff(i,{joins:a,leaves:l},n,s)}static syncDiff(e,r,n,s){const{joins:i,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(i,(a,l)=>{var u;const c=(u=e[a])!==null&&u!==void 0?u:[];if(e[a]=this.cloneDeep(l),c.length>0){const h=e[a].map(f=>f.presence_ref),d=c.filter(f=>h.indexOf(f.presence_ref)<0);e[a].unshift(...d)}n(a,c,l)}),this.map(o,(a,l)=>{let u=e[a];if(!u)return;const c=l.map(h=>h.presence_ref);u=u.filter(h=>c.indexOf(h.presence_ref)<0),e[a]=u,s(a,u,l),u.length===0&&delete e[a]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(n=>r(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,n)=>{const s=e[n];return"metas"in s?r[n]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=s,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var ws;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(ws||(ws={}));var ms;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(ms||(ms={}));var _e;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(_e||(_e={}));class yn{constructor(e,r={config:{}},n){this.topic=e,this.params=r,this.socket=n,this.bindings={},this.state=W.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Or(this,re.join,this.params,this.timeout),this.rejoinTimer=new Ti(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=W.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=W.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=W.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=W.errored,this.rejoinTimer.scheduleTimeout())}),this._on(re.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new Ct(this),this.broadcastEndpointURL=Ei(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,r=this.timeout){var n,s;if(this.socket.isConnected()||this.socket.connect(),this.state==W.closed){const{config:{broadcast:i,presence:o,private:a}}=this.params;this._onError(c=>e==null?void 0:e(_e.CHANNEL_ERROR,c)),this._onClose(()=>e==null?void 0:e(_e.CLOSED));const l={},u={broadcast:i,presence:o,postgres_changes:(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(c=>c.filter))!==null&&s!==void 0?s:[],private:a};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:u},l)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:c})=>{var h;if(this.socket.setAuth(),c===void 0){e==null||e(_e.SUBSCRIBED);return}else{const d=this.bindings.postgres_changes,f=(h=d==null?void 0:d.length)!==null&&h!==void 0?h:0,g=[];for(let y=0;y<f;y++){const v=d[y],{filter:{event:x,schema:P,table:_,filter:m}}=v,k=c&&c[y];if(k&&k.event===x&&k.schema===P&&k.table===_&&k.filter===m)g.push(Object.assign(Object.assign({},v),{id:k.id}));else{this.unsubscribe(),this.state=W.errored,e==null||e(_e.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,e&&e(_e.SUBSCRIBED);return}}).receive("error",c=>{this.state=W.errored,e==null||e(_e.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(c).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(_e.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,n){return this._on(e,r,n)}async send(e,r={}){var n,s;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=u.body)===null||s===void 0?void 0:s.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,a,l;const u=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=W.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(re.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new Or(this,re.leave,{},e),n.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,r,n){const s=new AbortController,i=setTimeout(()=>s.abort(),n),o=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(i),o}_push(e,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Or(this,e,r,n);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(e,r,n){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,n){var s,i;const o=e.toLocaleLowerCase(),{close:a,error:l,leave:u,join:c}=re;if(n&&[a,l,u,c].indexOf(o)>=0&&n!==this._joinRef())return;let d=this._onMessage(o,r,n);if(r&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(f=>{var g,y,v;return((g=f.filter)===null||g===void 0?void 0:g.event)==="*"||((v=(y=f.filter)===null||y===void 0?void 0:y.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===o}).map(f=>f.callback(d,n)):(i=this.bindings[o])===null||i===void 0||i.filter(f=>{var g,y,v,x,P,_;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){const m=f.id,k=(g=f.filter)===null||g===void 0?void 0:g.event;return m&&((y=r.ids)===null||y===void 0?void 0:y.includes(m))&&(k==="*"||(k==null?void 0:k.toLocaleLowerCase())===((v=r.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{const m=(P=(x=f==null?void 0:f.filter)===null||x===void 0?void 0:x.event)===null||P===void 0?void 0:P.toLocaleLowerCase();return m==="*"||m===((_=r==null?void 0:r.event)===null||_===void 0?void 0:_.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof d=="object"&&"ids"in d){const g=d.data,{schema:y,table:v,commit_timestamp:x,type:P,errors:_}=g;d=Object.assign(Object.assign({},{schema:y,table:v,commit_timestamp:x,eventType:P,new:{},old:{},errors:_}),this._getPayloadRecords(g))}f.callback(d,n)})}_isClosed(){return this.state===W.closed}_isJoined(){return this.state===W.joined}_isJoining(){return this.state===W.joining}_isLeaving(){return this.state===W.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,n){const s=e.toLocaleLowerCase(),i={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(e,r){const n=e.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&yn.isEqual(s.filter,r))}),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const n in e)if(e[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(re.close,{},e)}_onError(e){this._on(re.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=W.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=vs(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=vs(e.columns,e.old_record)),r}}const bs=()=>{},Wh=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class zh{constructor(e,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Si,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=bs,this.ref=0,this.logger=bs,this.conn=null,this.sendBuffer=[],this.serializer=new Dh,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...a)=>Lt(async()=>{const{default:l}=await Promise.resolve().then(()=>ft);return{default:l}},void 0,import.meta.url).then(({default:l})=>l(...a)):o=fetch,(...a)=>o(...a)},this.endPoint=`${e}/${Yr.websocket}`,this.httpEndpoint=Ei(e),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),(r!=null&&r.logLevel||r!=null&&r.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const s=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.apikey;if(s&&(this.accessTokenValue=s,this.apiKey=s),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(i,o)=>o(JSON.stringify(i)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Ti(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=jh),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Ih}))}disconnect(e,r){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(n=>n.teardown()))}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,n){this.logger(e,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Tt.connecting:return Ie.Connecting;case Tt.open:return Ie.Open;case Tt.closing:return Ie.Closing;default:return Ie.Closed}}isConnected(){return this.connectionState()===Ie.Open}channel(e,r={config:{}}){const n=`realtime:${e}`,s=this.getChannels().find(i=>i.topic===n);if(s)return s;{const i=new yn(`realtime:${e}`,r,this);return this.channels.push(i),i}}push(e){const{topic:r,event:n,payload:s,ref:i}=e,o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${r} ${n} (${i})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){let r=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const s={access_token:r,version:Uh};r&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push(re.access_token,{access_token:r})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(Mh,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,r=>{let{topic:n,event:s,payload:i,ref:o}=r;n==="phoenix"&&s==="phx_reply"&&this.heartbeatCallback(r.payload.status=="ok"?"ok":"error"),o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${n} ${s} ${o&&"("+o+")"||""}`,i),Array.from(this.channels).filter(a=>a._isMember(n)).forEach(a=>a._trigger(s,i,o)),this.stateChangeCallbacks.message.forEach(a=>a(r))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(re.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const n=e.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${e}${n}${s}`}_workerObjectUrl(e){let r;if(e)r=e;else{const n=new Blob([Wh],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class wn extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function N(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class Kh extends wn{constructor(e,r,n){super(e),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Xr extends wn{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}var Vh=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?i(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};const Ai=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>Lt(async()=>{const{default:n}=await Promise.resolve().then(()=>ft);return{default:n}},void 0,import.meta.url).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},Gh=()=>Vh(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Lt(()=>Promise.resolve().then(()=>ft),void 0,import.meta.url)).Response:Response}),Qr=t=>{if(Array.isArray(t))return t.map(r=>Qr(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[s]=Qr(n)}),e},Jh=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var We=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?i(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};const Pr=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Yh=(t,e,r)=>We(void 0,void 0,void 0,function*(){const n=yield Gh();t instanceof n&&!(r!=null&&r.noResolveJson)?t.json().then(s=>{const i=t.status||500,o=(s==null?void 0:s.statusCode)||i+"";e(new Kh(Pr(s),i,o))}).catch(s=>{e(new Xr(Pr(s),s))}):e(new Xr(Pr(t),t))}),Zh=(t,e,r,n)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!n?s:(Jh(n)?(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(n)):s.body=n,Object.assign(Object.assign({},s),r))};function qt(t,e,r,n,s,i){return We(this,void 0,void 0,function*(){return new Promise((o,a)=>{t(r,Zh(e,n,s,i)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>Yh(l,a,n))})})}function hr(t,e,r,n){return We(this,void 0,void 0,function*(){return qt(t,"GET",e,r,n)})}function ve(t,e,r,n,s){return We(this,void 0,void 0,function*(){return qt(t,"POST",e,n,s,r)})}function en(t,e,r,n,s){return We(this,void 0,void 0,function*(){return qt(t,"PUT",e,n,s,r)})}function Xh(t,e,r,n){return We(this,void 0,void 0,function*(){return qt(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function $i(t,e,r,n,s){return We(this,void 0,void 0,function*(){return qt(t,"DELETE",e,n,s,r)})}var G=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?i(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};const Qh={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ks={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class ed{constructor(e,r={},n,s){this.url=e,this.headers=r,this.bucketId=n,this.fetch=Ai(s)}uploadOrUpdate(e,r,n,s){return G(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},ks),s);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=n,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),s!=null&&s.headers&&(a=Object.assign(Object.assign({},a),s.headers));const u=this._removeEmptyFolders(r),c=this._getFinalPath(u),h=yield(e=="PUT"?en:ve)(this.fetch,`${this.url}/object/${c}`,i,Object.assign({headers:a},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:u,id:h.Id,fullPath:h.Key},error:null}}catch(i){if(N(i))return{data:null,error:i};throw i}})}upload(e,r,n){return G(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,n)})}uploadToSignedUrl(e,r,n,s){return G(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",r);try{let l;const u=Object.assign({upsert:ks.upsert},s),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",u.cacheControl)):(l=n,c["cache-control"]=`max-age=${u.cacheControl}`,c["content-type"]=u.contentType);const h=yield en(this.fetch,a.toString(),l,{headers:c});return{data:{path:i,fullPath:h.Key},error:null}}catch(l){if(N(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,r){return G(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const s=Object.assign({},this.headers);r!=null&&r.upsert&&(s["x-upsert"]="true");const i=yield ve(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),o=new URL(this.url+i.url),a=o.searchParams.get("token");if(!a)throw new wn("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:a},error:null}}catch(n){if(N(n))return{data:null,error:n};throw n}})}update(e,r,n){return G(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,n)})}move(e,r,n){return G(this,void 0,void 0,function*(){try{return{data:yield ve(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(N(s))return{data:null,error:s};throw s}})}copy(e,r,n){return G(this,void 0,void 0,function*(){try{return{data:{path:(yield ve(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(N(s))return{data:null,error:s};throw s}})}createSignedUrl(e,r,n){return G(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),i=yield ve(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(s){if(N(s))return{data:null,error:s};throw s}})}createSignedUrls(e,r,n){return G(this,void 0,void 0,function*(){try{const s=yield ve(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(s){if(N(s))return{data:null,error:s};throw s}})}download(e,r){return G(this,void 0,void 0,function*(){const s=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),o=i?`?${i}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield hr(this.fetch,`${this.url}/${s}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(N(a))return{data:null,error:a};throw a}})}info(e){return G(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const n=yield hr(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Qr(n),error:null}}catch(n){if(N(n))return{data:null,error:n};throw n}})}exists(e){return G(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield Xh(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(N(n)&&n instanceof Xr){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,r){const n=this._getFinalPath(e),s=[],i=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&s.push(i);const a=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});l!==""&&s.push(l);let u=s.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${n}${u}`)}}}remove(e){return G(this,void 0,void 0,function*(){try{return{data:yield $i(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(N(r))return{data:null,error:r};throw r}})}list(e,r,n){return G(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},Qh),r),{prefix:e||""});return{data:yield ve(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(N(s))return{data:null,error:s};throw s}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const td="2.10.4",rd={"X-Client-Info":`storage-js/${td}`};var Qe=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?i(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};class nd{constructor(e,r={},n,s){const i=new URL(e);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href,this.headers=Object.assign(Object.assign({},rd),r),this.fetch=Ai(n)}listBuckets(){return Qe(this,void 0,void 0,function*(){try{return{data:yield hr(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(N(e))return{data:null,error:e};throw e}})}getBucket(e){return Qe(this,void 0,void 0,function*(){try{return{data:yield hr(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(N(r))return{data:null,error:r};throw r}})}createBucket(e,r={public:!1}){return Qe(this,void 0,void 0,function*(){try{return{data:yield ve(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(N(n))return{data:null,error:n};throw n}})}updateBucket(e,r){return Qe(this,void 0,void 0,function*(){try{return{data:yield en(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(N(n))return{data:null,error:n};throw n}})}emptyBucket(e){return Qe(this,void 0,void 0,function*(){try{return{data:yield ve(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(N(r))return{data:null,error:r};throw r}})}deleteBucket(e){return Qe(this,void 0,void 0,function*(){try{return{data:yield $i(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(N(r))return{data:null,error:r};throw r}})}}class sd extends nd{constructor(e,r={},n,s){super(e,r,n,s)}from(e){return new ed(this.url,this.headers,e,this.fetch)}}const id="2.53.0";let xt="";typeof Deno<"u"?xt="deno":typeof document<"u"?xt="web":typeof navigator<"u"&&navigator.product==="ReactNative"?xt="react-native":xt="node";const od={"X-Client-Info":`supabase-js-${xt}/${id}`},ad={headers:od},ld={schema:"public"},ud={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},cd={};var hd=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?i(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};const dd=t=>{let e;return t?e=t:typeof fetch>"u"?e=yi:e=fetch,(...r)=>e(...r)},fd=()=>typeof Headers>"u"?wi:Headers,gd=(t,e,r)=>{const n=dd(r),s=fd();return(i,o)=>hd(void 0,void 0,void 0,function*(){var a;const l=(a=yield e())!==null&&a!==void 0?a:t;let u=new s(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",t),u.has("Authorization")||u.set("Authorization",`Bearer ${l}`),n(i,Object.assign(Object.assign({},o),{headers:u}))})};var pd=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?i(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};function _d(t){return t.endsWith("/")?t:t+"/"}function vd(t,e){var r,n;const{db:s,auth:i,realtime:o,global:a}=t,{db:l,auth:u,realtime:c,global:h}=e,d={db:Object.assign(Object.assign({},l),s),auth:Object.assign(Object.assign({},u),i),realtime:Object.assign(Object.assign({},c),o),storage:{},global:Object.assign(Object.assign(Object.assign({},h),a),{headers:Object.assign(Object.assign({},(r=h==null?void 0:h.headers)!==null&&r!==void 0?r:{}),(n=a==null?void 0:a.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>pd(this,void 0,void 0,function*(){return""})};return t.accessToken?d.accessToken=t.accessToken:delete d.accessToken,d}const Oi="2.71.1",st=30*1e3,tn=3,jr=tn*st,yd="http://localhost:9999",wd="supabase.auth.token",md={"X-Client-Info":`gotrue-js/${Oi}`},rn="X-Supabase-Api-Version",Pi={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},bd=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,kd=600*1e3;class mn extends Error{constructor(e,r,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function b(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class xd extends mn{constructor(e,r,n){super(e,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function Sd(t){return b(t)&&t.name==="AuthApiError"}class ji extends mn{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class Oe extends mn{constructor(e,r,n,s){super(e,n,s),this.name=r,this.status=n}}class xe extends Oe{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Td(t){return b(t)&&t.name==="AuthSessionMissingError"}class Jt extends Oe{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Yt extends Oe{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Zt extends Oe{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Cd(t){return b(t)&&t.name==="AuthImplicitGrantRedirectError"}class xs extends Oe{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class nn extends Oe{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function Rr(t){return b(t)&&t.name==="AuthRetryableFetchError"}class Ss extends Oe{constructor(e,r,n){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class sn extends Oe{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const dr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Ts=` 	
\r=`.split(""),Ed=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<Ts.length;e+=1)t[Ts[e].charCodeAt(0)]=-2;for(let e=0;e<dr.length;e+=1)t[dr[e].charCodeAt(0)]=e;return t})();function Cs(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(dr[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(dr[n]),e.queuedBits-=6}}function Ri(t,e,r){const n=Ed[t];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function Es(t){const e=[],r=o=>{e.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=o=>{Od(o,n,r)};for(let o=0;o<t.length;o+=1)Ri(t.charCodeAt(o),s,i);return e.join("")}function Ad(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function $d(t,e){for(let r=0;r<t.length;r+=1){let n=t.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(t.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}Ad(n,e)}}function Od(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let n=1;n<6;n+=1)if((t>>7-n&1)===0){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function Pd(t){const e=[],r={queue:0,queuedBits:0},n=s=>{e.push(s)};for(let s=0;s<t.length;s+=1)Ri(t.charCodeAt(s),r,n);return new Uint8Array(e)}function jd(t){const e=[];return $d(t,r=>e.push(r)),new Uint8Array(e)}function Rd(t){const e=[],r={queue:0,queuedBits:0},n=s=>{e.push(s)};return t.forEach(s=>Cs(s,r,n)),Cs(null,r,n),e.join("")}function Ud(t){return Math.round(Date.now()/1e3)+t}function Id(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const te=()=>typeof window<"u"&&typeof document<"u",je={tested:!1,writable:!1},Ui=()=>{if(!te())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(je.tested)return je.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),je.tested=!0,je.writable=!0}catch{je.tested=!0,je.writable=!1}return je.writable};function Md(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,i)=>{e[i]=s})}catch{}return r.searchParams.forEach((n,s)=>{e[s]=n}),e}const Ii=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>Lt(async()=>{const{default:n}=await Promise.resolve().then(()=>ft);return{default:n}},void 0,import.meta.url).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},Dd=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",it=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},Re=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},ke=async(t,e)=>{await t.removeItem(e)};class wr{constructor(){this.promise=new wr.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}wr.promiseConstructor=Promise;function Ur(t){const e=t.split(".");if(e.length!==3)throw new sn("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!bd.test(e[n]))throw new sn("JWT not in base64url format");return{header:JSON.parse(Es(e[0])),payload:JSON.parse(Es(e[1])),signature:Pd(e[2]),raw:{header:e[0],payload:e[1]}}}async function Ld(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function Nd(t,e){return new Promise((n,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await t(i);if(!e(i,null,o)){n(o);return}}catch(o){if(!e(i,o)){s(o);return}}})()})}function Fd(t){return("0"+t.toString(16)).substr(-2)}function qd(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let i=0;i<56;i++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(e),Array.from(e,Fd).join("")}async function Bd(t){const r=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function Hd(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await Bd(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function et(t,e,r=!1){const n=qd();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await it(t,`${e}-code-verifier`,s);const i=await Hd(n);return[i,n===i?"plain":"s256"]}const Wd=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function zd(t){const e=t.headers.get(rn);if(!e||!e.match(Wd))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Kd(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function Vd(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Gd=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function tt(t){if(!Gd.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Ir(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function As(t){return JSON.parse(JSON.stringify(t))}var Jd=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};const Ue=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Yd=[502,503,504];async function $s(t){var e;if(!Dd(t))throw new nn(Ue(t),0);if(Yd.includes(t.status))throw new nn(Ue(t),t.status);let r;try{r=await t.json()}catch(i){throw new ji(Ue(i),i)}let n;const s=zd(t);if(s&&s.getTime()>=Pi["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Ss(Ue(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new xe}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new Ss(Ue(r),t.status,r.weak_password.reasons);throw new xd(Ue(r),t.status||500,n)}const Zd=(t,e,r,n)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function T(t,e,r,n){var s;const i=Object.assign({},n==null?void 0:n.headers);i[rn]||(i[rn]=Pi["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const o=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(o.redirect_to=n.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await Xd(t,e,r+a,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function Xd(t,e,r,n,s,i){const o=Zd(e,n,s,i);let a;try{a=await t(r,Object.assign({},o))}catch(l){throw console.error(l),new nn(Ue(l),0)}if(a.ok||await $s(a),n!=null&&n.noResolveJson)return a;try{return await a.json()}catch(l){await $s(l)}}function pe(t){var e;let r=null;rf(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=Ud(t.expires_in)));const n=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:n},error:null}}function Os(t){const e=pe(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Ce(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function Qd(t){return{data:t,error:null}}function ef(t){const{action_link:e,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i}=t,o=Jd(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function tf(t){return t}function rf(t){return t.access_token&&t.refresh_token&&t.expires_in}const Mr=["global","local","others"];var nf=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};class sf{constructor({url:e="",headers:r={},fetch:n}){this.url=e,this.headers=r,this.fetch=Ii(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,r=Mr[0]){if(Mr.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Mr.join(", ")}`);try{return await T(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(b(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,r={}){try{return await T(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Ce})}catch(n){if(b(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:r}=e,n=nf(e,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await T(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:ef,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(b(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await T(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Ce})}catch(r){if(b(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,n,s,i,o,a,l;try{const u={nextPage:null,lastPage:0,total:0},c=await T(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:tf});if(c.error)throw c.error;const h=await c.json(),d=(o=c.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(l=(a=c.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(g=>{const y=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(g.split(";")[1].split("=")[1]);u[`${v}Page`]=y}),u.total=parseInt(d)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(b(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){tt(e);try{return await T(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Ce})}catch(r){if(b(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){tt(e);try{return await T(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:Ce})}catch(n){if(b(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,r=!1){tt(e);try{return await T(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:Ce})}catch(n){if(b(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){tt(e.userId);try{const{data:r,error:n}=await T(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(b(r))return{data:null,error:r};throw r}}async _deleteFactor(e){tt(e.userId),tt(e.id);try{return{data:await T(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(b(r))return{data:null,error:r};throw r}}}function Ps(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}function of(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const rt={debug:!!(globalThis&&Ui()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Mi extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class af extends Mi{}async function lf(t,e,r){rt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),rt.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){rt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,s.name);try{return await r()}finally{rt.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,s.name)}}else{if(e===0)throw rt.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new af(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(rt.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}of();const uf={url:yd,storageKey:wd,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:md,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function js(t,e,r){return await r()}const nt={};class Ut{constructor(e){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Ut.nextInstanceID,Ut.nextInstanceID+=1,this.instanceID>0&&te()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},uf),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new sf({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=Ii(s.fetch),this.lock=s.lock||js,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:te()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=lf:this.lock=js,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:Ui()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Ps(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=Ps(this.memoryStorage)),te()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var e,r;return(r=(e=nt[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){nt[this.storageKey]=Object.assign(Object.assign({},nt[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=nt[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){nt[this.storageKey]=Object.assign(Object.assign({},nt[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Oi}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const r=Md(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),te()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),Cd(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:a}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",a),await this._saveSession(o),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return b(r)?{error:r}:{error:new ji("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,n,s;try{const i=await T(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:pe}),{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(i){if(b(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var r,n,s;try{let i;if("email"in e){const{email:c,password:h,options:d}=e;let f=null,g=null;this.flowType==="pkce"&&([f,g]=await et(this.storage,this.storageKey)),i=await T(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d==null?void 0:d.emailRedirectTo,body:{email:c,password:h,data:(r=d==null?void 0:d.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:f,code_challenge_method:g},xform:pe})}else if("phone"in e){const{phone:c,password:h,options:d}=e;i=await T(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:h,data:(n=d==null?void 0:d.data)!==null&&n!==void 0?n:{},channel:(s=d==null?void 0:d.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:pe})}else throw new Yt("You must provide either an email or phone number and a password");const{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(i){if(b(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let r;if("email"in e){const{email:i,password:o,options:a}=e;r=await T(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:Os})}else if("phone"in e){const{phone:i,password:o,options:a}=e;r=await T(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:Os})}else throw new Yt("You must provide either an email or phone number and a password");const{data:n,error:s}=r;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Jt}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(b(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(e){var r,n,s,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;if(r==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(e){var r,n,s,i,o,a,l,u,c,h,d,f;let g,y;if("message"in e)g=e.message,y=e.signature;else{const{chain:v,wallet:x,statement:P,options:_}=e;let m;if(te())if(typeof x=="object")m=x;else{const E=window;if("solana"in E&&typeof E.solana=="object"&&("signIn"in E.solana&&typeof E.solana.signIn=="function"||"signMessage"in E.solana&&typeof E.solana.signMessage=="function"))m=E.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(_!=null&&_.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");m=x}const k=new URL((r=_==null?void 0:_.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in m&&m.signIn){const E=await m.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},_==null?void 0:_.signInWithSolana),{version:"1",domain:k.host,uri:k.href}),P?{statement:P}:null));let O;if(Array.isArray(E)&&E[0]&&typeof E[0]=="object")O=E[0];else if(E&&typeof E=="object"&&"signedMessage"in E&&"signature"in E)O=E;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in O&&"signature"in O&&(typeof O.signedMessage=="string"||O.signedMessage instanceof Uint8Array)&&O.signature instanceof Uint8Array)g=typeof O.signedMessage=="string"?O.signedMessage:new TextDecoder().decode(O.signedMessage),y=O.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in m)||typeof m.signMessage!="function"||!("publicKey"in m)||typeof m!="object"||!m.publicKey||!("toBase58"in m.publicKey)||typeof m.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${k.host} wants you to sign in with your Solana account:`,m.publicKey.toBase58(),...P?["",P,""]:[""],"Version: 1",`URI: ${k.href}`,`Issued At: ${(s=(n=_==null?void 0:_.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((i=_==null?void 0:_.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${_.signInWithSolana.notBefore}`]:[],...!((o=_==null?void 0:_.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${_.signInWithSolana.expirationTime}`]:[],...!((a=_==null?void 0:_.signInWithSolana)===null||a===void 0)&&a.chainId?[`Chain ID: ${_.signInWithSolana.chainId}`]:[],...!((l=_==null?void 0:_.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${_.signInWithSolana.nonce}`]:[],...!((u=_==null?void 0:_.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${_.signInWithSolana.requestId}`]:[],...!((h=(c=_==null?void 0:_.signInWithSolana)===null||c===void 0?void 0:c.resources)===null||h===void 0)&&h.length?["Resources",..._.signInWithSolana.resources.map(O=>`- ${O}`)]:[]].join(`
`);const E=await m.signMessage(new TextEncoder().encode(g),"utf8");if(!E||!(E instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");y=E}}try{const{data:v,error:x}=await T(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:Rd(y)},!((d=e.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:pe});if(x)throw x;return!v||!v.session||!v.user?{data:{user:null,session:null},error:new Jt}:(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),{data:Object.assign({},v),error:x})}catch(v){if(b(v))return{data:{user:null,session:null},error:v};throw v}}async _exchangeCodeForSession(e){const r=await Re(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{const{data:i,error:o}=await T(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:pe});if(await ke(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Jt}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:o})}catch(i){if(b(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:r,provider:n,token:s,access_token:i,nonce:o}=e,a=await T(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:pe}),{data:l,error:u}=a;return u?{data:{user:null,session:null},error:u}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Jt}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:u})}catch(r){if(b(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(e){var r,n,s,i,o;try{if("email"in e){const{email:a,options:l}=e;let u=null,c=null;this.flowType==="pkce"&&([u,c]=await et(this.storage,this.storageKey));const{error:h}=await T(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:u,code_challenge_method:c},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:a,options:l}=e,{data:u,error:c}=await T(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(s=l==null?void 0:l.data)!==null&&s!==void 0?s:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(o=l==null?void 0:l.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:c}}throw new Yt("You must provide either an email or phone number.")}catch(a){if(b(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var r,n;try{let s,i;"options"in e&&(s=(r=e.options)===null||r===void 0?void 0:r.redirectTo,i=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:a}=await T(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:pe});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,u=o.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(s){if(b(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var r,n,s;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await et(this.storage,this.storageKey)),await T(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:Qd})}catch(i){if(b(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:n}=e;if(n)throw n;if(!r)throw new xe;const{error:s}=await T(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(b(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:n,type:s,options:i}=e,{error:o}=await T(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:n,type:s,options:i}=e,{data:o,error:a}=await T(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:a}}throw new Yt("You must provide either an email or phone number and a type")}catch(r){if(b(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await Re(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<jr:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const o=await Re(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=Ir()}if(this.storage.isServer&&e.user){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,u,c)=>(!o&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,u,c))})}return{data:{session:e},error:null}}const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await T(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Ce}):await this._useSession(async r=>{var n,s,i;const{data:o,error:a}=r;if(a)throw a;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new xe}:await T(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:Ce})})}catch(r){if(b(r))return Td(r)&&(await this._removeSession(),await ke(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async n=>{const{data:s,error:i}=n;if(i)throw i;if(!s.session)throw new xe;const o=s.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await et(this.storage,this.storageKey));const{data:u,error:c}=await T(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:o.access_token,xform:Ce});if(c)throw c;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(n){if(b(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new xe;const r=Date.now()/1e3;let n=r,s=!0,i=null;const{payload:o}=Ur(e.access_token);if(o.exp&&(n=o.exp,s=n<=r),s){const{session:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!a)return{data:{user:null,session:null},error:null};i=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(b(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var n;if(!e){const{data:o,error:a}=r;if(a)throw a;e=(n=o.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new xe;const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(b(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(e,r){try{if(!te())throw new Zt("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Zt(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new xs("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Zt("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new xs("No code detected.");const{data:P,error:_}=await this._exchangeCodeForSession(e.code);if(_)throw _;const m=new URL(window.location.href);return m.searchParams.delete("code"),window.history.replaceState(window.history.state,"",m.toString()),{data:{session:P.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:i,refresh_token:o,expires_in:a,expires_at:l,token_type:u}=e;if(!i||!a||!o||!u)throw new Zt("No session defined in URL");const c=Math.round(Date.now()/1e3),h=parseInt(a);let d=c+h;l&&(d=parseInt(l));const f=d-c;f*1e3<=st&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${h}s`);const g=d-h;c-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,d,c):c-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,d,c);const{data:y,error:v}=await this._getUser(i);if(v)throw v;const x={provider_token:n,provider_refresh_token:s,access_token:i,expires_in:h,expires_at:d,refresh_token:o,token_type:u,user:y.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:x,redirectType:e.type},error:null}}catch(n){if(b(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await Re(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return{error:i};const o=(n=s.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(Sd(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await ke(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const r=Id(),n={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async r=>{var n,s;try{const{data:{session:i},error:o}=r;if(o)throw o;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await et(this.storage,this.storageKey,!0));try{return await T(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(b(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(r){if(b(r))return{data:null,error:r};throw r}}async linkIdentity(e){var r;try{const{data:n,error:s}=await this._useSession(async i=>{var o,a,l,u,c;const{data:h,error:d}=i;if(d)throw d;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await T(this.fetch,"GET",f,{headers:this.headers,jwt:(c=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&c!==void 0?c:void 0})});if(s)throw s;return te()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:e.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(b(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession(async r=>{var n,s;const{data:i,error:o}=r;if(o)throw o;return await T(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(b(r))return{data:null,error:r};throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await Nd(async s=>(s>0&&await Ld(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await T(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:pe})),(s,i)=>{const o=200*Math.pow(2,s);return i&&Rr(i)&&Date.now()+o-n<st})}catch(n){if(this._debug(r,"error",n),b(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",n),te()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await Re(this.storage,this.storageKey);if(s&&this.userStorage){let o=await Re(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:s.user},await it(this.userStorage,this.storageKey+"-user",o)),s.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:Ir()}else if(s&&!s.user&&!s.user){const o=await Re(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(s.user=o.user,await ke(this.storage,this.storageKey+"-user"),await it(this.storage,this.storageKey,s)):s.user=Ir()}if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const i=((r=s.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<jr;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${jr}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),Rr(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:a}=await this._getUser(s.access_token);!a&&(o!=null&&o.user)?(s.user=o.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var r,n;if(!e)throw new xe;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new wr;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new xe;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const a={session:i.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(i){if(this._debug(s,"error",i),b(i)){const o={session:null,error:i};return Rr(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,r,n=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:r});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,r)}catch(l){i.push(l)}});if(await Promise.all(o),i.length>0){for(let a=0;a<i.length;a+=1)console.error(i[a]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await it(this.userStorage,this.storageKey+"-user",{user:r.user});const s=Object.assign({},r);delete s.user;const i=As(s);await it(this.storage,this.storageKey,i)}else{const s=As(r);await it(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await ke(this.storage,this.storageKey),await ke(this.storage,this.storageKey+"-code-verifier"),await ke(this.storage,this.storageKey+"-user"),this.userStorage&&await ke(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&te()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),st);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-e)/st);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${st}ms, refresh threshold is ${tn} ticks`),s<=tn&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Mi)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!te()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,o]=await et(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(a.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);s.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?{data:null,error:i}:await T(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(b(r))return{data:null,error:r};throw r}}async _enroll(e){try{return await this._useSession(async r=>{var n,s;const{data:i,error:o}=r;if(o)return{data:null,error:o};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:u}=await T(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((s=l==null?void 0:l.totp)===null||s===void 0)&&s.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(b(r))return{data:null,error:r};throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return{data:null,error:i};const{data:o,error:a}=await T(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:a})})}catch(r){if(b(r))return{data:null,error:r};throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?{data:null,error:i}:await T(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(b(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(e){const{data:r,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){const{data:{user:e},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(e==null?void 0:e.factors)||[],s=n.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=n.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:n,totp:s,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var r,n;const{data:{session:s},error:i}=e;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Ur(s.access_token);let a=null;o.aal&&(a=o.aal);let l=a;((n=(r=s.user.factors)===null||r===void 0?void 0:r.filter(h=>h.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const c=o.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:c},error:null}}))}async fetchJwk(e,r={keys:[]}){let n=r.keys.find(a=>a.kid===e);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(a=>a.kid===e),n&&this.jwks_cached_at+kd>s)return n;const{data:i,error:o}=await T(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=s,n=i.keys.find(a=>a.kid===e),!n)?null:n}async getClaims(e,r={}){try{let n=e;if(!n){const{data:f,error:g}=await this.getSession();if(g||!f.session)return{data:null,error:g};n=f.session.access_token}const{header:s,payload:i,signature:o,raw:{header:a,payload:l}}=Ur(n);r!=null&&r.allowExpired||Kd(i.exp);const u=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:f}=await this.getUser(n);if(f)throw f;return{data:{claims:i,header:s,signature:o},error:null}}const c=Vd(s.alg),h=await crypto.subtle.importKey("jwk",u,c,!0,["verify"]);if(!await crypto.subtle.verify(c,h,o,jd(`${a}.${l}`)))throw new sn("Invalid JWT signature");return{data:{claims:i,header:s,signature:o},error:null}}catch(n){if(b(n))return{data:null,error:n};throw n}}}Ut.nextInstanceID=0;const cf=Ut;class hf extends cf{constructor(e){super(e)}}var df=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?i(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};class ff{constructor(e,r,n){var s,i,o;if(this.supabaseUrl=e,this.supabaseKey=r,!e)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const a=_d(e),l=new URL(a);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const u=`sb-${l.hostname.split(".")[0]}-auth-token`,c={db:ld,realtime:cd,auth:Object.assign(Object.assign({},ud),{storageKey:u}),global:ad},h=vd(n??{},c);this.storageKey=(s=h.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=h.global.headers)!==null&&i!==void 0?i:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(d,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=gd(r,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new Oh(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new sd(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new _h(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},n={}){return this.rest.rpc(e,r,n)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,r;return df(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:s,storageKey:i,flowType:o,lock:a,debug:l},u,c){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new hf({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),u),storageKey:i,autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:s,flowType:o,lock:a,debug:l,fetch:c,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new zh(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(e,r,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const gf=(t,e,r)=>new ff(t,e,r);function pf(){if(typeof window<"u"||typeof process>"u"||process.version===void 0||process.version===null)return!1;const t=process.version.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}pf()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");var _f=we('<div class="result"><p><strong> </strong> </p></div>'),vf=we('<div class="c"></div>');function yf(t,e){var r=vf();fo(r,21,()=>e.results,({title:n,author:s,id:i})=>i,(n,s)=>{let i=()=>I(s).title,o=()=>I(s).author;var a=_f(),l=F(a),u=F(l),c=F(u,!0);M(u);var h=z(u);M(l),M(a),Et(()=>{At(c,i()),At(h,` by ${o()??""}`)}),se(n,a)}),M(r),se(t,r)}var wf=we('<p class="error"> </p>'),mf=we('<p class="no-results">No results found.</p>'),bf=we('<div id="search" class="c svelte-wbc5p4"><h2 class="svelte-wbc5p4">Database Search</h2> <form class="ui svelte-wbc5p4"><div class="input-group svelte-wbc5p4"><label for="search-input">Search</label> <input id="search-input" type="text" placeholder="Enter a search term..." class="svelte-wbc5p4"/></div> <div class="select-group svelte-wbc5p4"><label for="select-field">Field</label> <select id="select-field" class="svelte-wbc5p4"><option>Text</option><option>Title</option><option>Author</option></select></div> <button id="search-button" type="submit" class="svelte-wbc5p4">Search</button></form> <p class="advanced svelte-wbc5p4"><button class="link svelte-wbc5p4">advanced filters</button></p> <div class="results svelte-wbc5p4"><!></div></div>');function kf(t,e){fr(e,!0);let r,n=Te(null),s=Te(null),i=Te(""),o=Te("text"),a=Te(!1);async function l(O){if(O.preventDefault(),console.time("search"),!I(i)||I(i).trim()===""){K(s,"Please enter a search term."),K(n,null);return}try{K(a,!0);const{data:D,error:ae}=await r.from("oldb").select("id,title,author").textSearch(I(o),I(i).trim(),{type:"websearch"}).order("title",{ascending:!0}).limit(100);ae?(console.error("Search error:",ae),K(s,"Search failed. Please try again."),K(n,null)):(K(n,D||[],!0),K(s,null))}catch(D){console.error("Unexpected error:",D),D="Something went wrong. Please try again.",K(n,null)}finally{K(i,""),K(a,!1)}console.timeEnd("search")}Is(()=>{r=gf("https://dbmtysppmiwwjwaeneex.supabase.co","sb_publishable_4iMeGBcBrV3i_iAemu4tuw_5NDTN77K")});var u=bf(),c=z(F(u),2),h=F(c),d=z(F(h),2);po(d),M(h);var f=z(h,2),g=z(F(f),2),y=F(g);y.value=y.__value="text";var v=z(y);v.value=v.__value="title";var x=z(v);x.value=x.__value="author",M(g),M(f);var P=z(f,2);M(c);var _=z(c,4),m=F(_);{var k=O=>{var D=wf(),ae=F(D,!0);M(D),Et(()=>At(ae,I(s))),se(O,D)},E=(O,D)=>{{var ae=me=>{var S=Ms(),X=pr(S);{var B=Q=>{yf(Q,{get results(){return I(n)}})},le=Q=>{var be=mf();se(Q,be)};xr(X,Q=>{I(n).length>0?Q(B):Q(le,!1)})}se(me,S)};xr(O,me=>{I(n)&&me(ae)},D)}};xr(m,O=>{I(s)?O(k):O(E,!1)})}return M(_),M(u),Et(()=>{d.disabled=I(a),g.disabled=I(a),P.disabled=I(a)}),uo("submit",c,l),wo(d,()=>I(i),O=>K(i,O)),go(g,()=>I(o),O=>K(o,O)),se(t,u),gr({search:l})}var xf=we("<!> <!> <!> <!>",1);function Sf(t){var e=xf(),r=pr(e);uh(r,{});var n=z(r,2);dh(n);var s=z(n,2);kf(s,{});var i=z(s,2);ko(i,{onerror:o=>console.error(o)},o=>{}),se(t,e)}const Tf={title:"Title TK",description:"Description tk."},Cf=[{section:"intro",content:[{type:"h4",value:"An h4 element with no attributes"},{type:"text",value:"Some random text here, followed by an img tag."},{type:"img",value:{src:"../assets/demo/test.jpg",alt:"A cat"}},{type:"Test",value:{label:"I’m a custom component!",value:"50"}}]}],Rs={meta:Tf,body:Cf};function Ef(){console.log("--- --- --- --- --- ---"),console.log("svelte-starter: 6.14.0"),console.log("build: 2025-07-31-15:54"),console.log("--- --- --- --- --- ---")}var Af=we("<!> <!>",1);function Bf(t,e){fr(e,!0),Ef();const r=["https://pudding.cool/assets/fonts/tiempos/TiemposTextWeb-Regular.woff2","https://pudding.cool/assets/fonts/tiempos/TiemposTextWeb-Bold.woff2","https://pudding.cool/assets/fonts/atlas/AtlasGrotesk-Regular-Web.woff2","https://pudding.cool/assets/fonts/atlas/AtlasGrotesk-Bold-Web.woff2"],{title:n,description:s,url:i,keywords:o}=Rs;An("copy",Rs),An("data",e.data);var a=Af(),l=pr(a);_o(l,{get title(){return n},get description(){return s},get url(){return i},get preloadFont(){return r},get keywords(){return o}});var u=z(l,2);Sf(u),se(t,a),gr()}export{Bf as component};
